{"version":3,"sources":["webpack:///../node_modules/react-tinacms-editor/dist/react-tinacms-editor.esm.js"],"names":["_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","Constructor","protoProps","staticProps","prototype","_extends","assign","arguments","source","hasOwnProperty","call","apply","this","_inheritsLoose","subClass","superClass","create","constructor","__proto__","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","_taggedTemplateLiteralLoose","strings","raw","slice","_double","boundary","RegExp","single","STRONG","EM","S","EM_UNDERSCORE","CODE","buildInputRules","schema","type","nodeType","mark","rules","nodes","blockquote","push","ordered_list","match","order","node","childCount","attrs","orderedListRule","bullet_list","bulletListRule","code_block","language","params","codeBlockRule","heading","maxLevel","level","headingRule","horizontal_rule","state","_match","start","end","tr","replaceRangeWith","horizontalRuleRule","marks","strong","markInputRule","markType","strongUnderRule","s","strikethroughRule","em","singleMarkInputRule","emStarRule","emUnderRule","code","codeRule","regexp","getAttrs","Function","textStart","textEnd","addMark","removeStoredMark","command","dispatch","offset","deleteStart","deleteEnd","doc","textBetween","e","getNextChar","singleMarkCommand","inputRules","mac","navigator","test","platform","buildKeymap","plugins","bind","cmd","filter","__type","plugin","findPlugins","forEach","skip","unlessMac","ifMark","ifNode","ifNodes","some","n","onCondition","name","commonPluginKey","commonPlugin","init","editorFocused","prev","getMeta","handleScrollToSelection","handleDOMEvents","focus","view","setMeta","blur","findElementOffsetTop","element","parent","offsetTop","offsetParent","findElementOffsetLeft","offsetLeft","isMarkPresent","getMarkPresent","selection","anchor","head","empty","isInSet","resolve","markPresent","undefined","HTTP_LINK_REGEX","linkPluginKey","IMG_REGEX","linkify","fragment","linkified","child","isText","text","pos","link","img","matches","exec","index","_ref","cut","urlText","src","title","alt","href","addToSet","copy","content","fromArray","buildColumnSelection","tableMap","table","width","colStart","map","findIndex","c","buildRowSelection","height","rowStart","buildTableSelection","buildExtendedColumnHeaders","tableNode","colSelection","decorations","cellMap","_loop","div","document","createElement","classList","add","ranges","r","$from","widget","buildExtendedRowHeaders","rowSelection","_loop2","buildExtendedTableHeaders","tablePluginKey","tablePlugin","deco","_3","newState","get","isColSelection","isRowSelection","concat","buildExtendedHeaders","selectedTable","getState","handleClickOn","_1","_2","nodePos","event","direct","targetClasses","tablePluginState","cellSelection","classes","includes","buildCellSelection","value","setSelection","imagePluginKey","imagePlugin","selectedImage","nodeAt","handleKeyDown","image","getNodes","getMarks","_ALIGN_STYLES","Translator","MarkdownSerializer","serialize","options","MarkdownSerializerState","renderContent","out","delim","closed","inTightList","tightLists","_proto2","flushClose","size","atBlank","delimMin","trim","wrapBlock","firstDelim","f","old","write","closeBlock","ensureNewLine","_text","escape","escFn","lines","split","startOfLine","escapedString","esc","render","Error","_this","_","renderInline","_this2","active","trailing","progress","indexOfCode","p","leading","_i","_a","info","expelEnclosingWhitespace","_Array$from","Array","from","lead","_inner","trail","withText","inner","noEsc","len","outer","mixable","j","other","eq","keep","Math","min","markString","pop","renderList","_this3","isTight","prevTight","str","replace","quote","wrap","repeat","open","close","getEnclosingWhitespace","ALIGN_STYLES","ALIGN_DASHES","left","center","right","TOKENS","block","paragraph","list_item","tok","attrGet","tag","fence","hr","children","table_row","table_cell","style","align","table_header","hardbreak","code_inline","NODES","textContent","markup","bullet","maxW","String","space","nStr","_parent","_index","hard_break","inHead","row","nextRowIsInBody","dash","MARKS","_state","endsWith","openedWith","closeWith","CommonMarkSerializer","buildNodesFromSchema","parseNextNumber","max","result","ok","charCodeAt","Number","parseLinkDestination","md","isSpace","utils","unescapeAll","posMax","image_with_size","silent","label","ref","res","token","tokens","oldPos","labelStart","labelEnd","helpers","parseLinkLabel","validateLink","parseLinkTitle","resultW","resultH","parseImageSize","env","references","normalizeReference","inline","State","tokenize","imsize","ruler","before","parseReference","_link","MarkdownParseState","tokenHandlers","stack","topNodeType","none","_proto","top","elt","addText","merged","last","a","b","sameSet","maybeMerge","openMark","closeMark","removeFromSet","parseTokens","toks","handler","addNode","createAndFill","openNode","closeNode","spec","noOpenClose","withoutTrailingNewline","noOp","MarkdownParser","tokenizer","handlers","_nodeType","ignore","RangeError","JSON","stringify","softbreak","parse","markdownit","CommonMarkParser","parser","html","use","thead","th","tbody","td","buildTokensForSchema","MarkdownTranslator","_Translator","serializer","fromSchema","commonMarkFromSchema","translator","nodeFromString","stringFromNode","DOMSerializer","_DOMSerializer2","nodesFromSchema","gatherToDOM","marksFromSchema","obj","toDocument","toDOM","DOMTranslator","al","window","createRange","createContextualFragment","DOMParser","parseFromString","el","appendChild","serializeFragment","innerHTML","ssr","mac$1","CodeMirror","CodeBlockView","getPos","updating","onCursorActivity","forwardSelection","cm","hasFocus","asProseMirrorSelection","onChange","valueChanged","setupCodeMirror","dom","getWrapperElement","setTimeout","refresh","on","change","computeChange","getValue","codeBlockStart","replaceWith","to","indexFromPos","getCursor","posFromIndex","lineNumbers","extraKeys","codeMirrorKeymap","mode","theme","_CodeMirror$normalize","mod","normalizeKeyMap","Up","maybeEscape","Left","Down","Right","Backspace","shouldRemove","line","ch","near","Pass","somethingSelected","firstLine","$anchor","parentOffset","_pos","_state$selection","$head","sameParent","above","after","indexAfter","defaultContentType","canReplaceWith","scrollIntoView","exitCodeUp","lastLine","_pos2","exitCodeHard","unit","dir","getLine","targetPos","nodeSize","update","replaceRange","selectNode","stopEvent","oldVal","newVal","oldEnd","newEnd","Identity","ImageView","previewUrl","outline","deselectNode","remove","destroy","_node$attrs","_node$attrs2","nodeViews","useProsemirror","input","format","useProsemirrorSchema","useProsemirrorTranslator","_React$useState","setEl","elRef","nextEl","createState","showLinkForm","show_link_toolbar","transformPasted","shiftKey","openStart","openEnd","_x","color","createEditorState","_React$useState2","editorView","setEditorView","dispatchTransaction","nextState","updateState","docChanged","code$1","parseDOM","link$2","inclusive","getAttribute","doc$1","blockquote$1","group","defining","bullet_list$1","tight","hasAttribute","code_block$1","preserveWhitespace","hard_break$1","selectable","domAttrs","docAttrs","getAttrsWith","attributes","attribute","startsWith","heading$1","id","horizontal_rule$1","allowGapCursor","alignRegex","getAlignFromDOM","className","image$1","draggable","list_item$1","ordered_list$1","paragraph$1","text$1","tables","tableGroup","cellContent","cellAttributes","markExtend","$cursor","startIndex","endIndex","hasMark","startPos","endPos","insertHr","replaceSelectionWith","liftBlockquote","range","getRangeForType","lift","listType","$to","blockRange","toggleBulletList","toggleOrderedList","deleteEmptyHeading","toggleHeader","fallBackNodeType","fallbackAttrs","firstTextblock","firstPos","nodesBetween","isTextblock","$firstPos","setAsParagraph","nextNodeType","nextAttrs","setBlockType","hardBreakCmd","br","headingCmd","KEYMAP_PLUGINS","tab","shiftTab","toggleLink","ifMac","arrowHandler","endOfTextblock","side","nextPos","goToCell","ALL_PLUGINS","fontWeight","_templateObject","data","CodeMirrorCss","_templateObject$1","ProseMirrorCss","_templateObject$2","MenuPortalContext","MenuPortalProvider","wrapperRef","MenuPortal","current","Provider","MenuPortalWrapper","_templateObject14","_templateObject13","_templateObject12","_templateObject11","_templateObject10","_templateObject9","_templateObject8","_templateObject7","_templateObject6","_templateObject5","MenuItem","MenuButton","button","disabled","MenuDropdownWrapper","MenuButtonDropdown","triggerRef","styleProps","menuPortalRef","menuOffset","menuDropdownBoundingBox","getBoundingClientRect","menuPortalBoundingBox","x","Offset","MenuOption","markControl","Icon","tooltip","defaultAttrs","_ref$selectionOnly","selectionOnly","_ref$noMix","noMix","isDisabled","onClick","_React$Component","markIsActive","markName","storedMarks","rangeHasMark","_this$props$view","inCodeBlock","incompatibleMarksAreActive","depth","reduce","someMarkActive","nextMarkActive","displayName","blockTool","Component$1","Component","typeName","_class","canDo","correctNodeType","correctAttrs","_templateObject7$1","_templateObject6$1","_templateObject5$1","_templateObject4","_templateObject3","_templateObject2","_templateObject$3","FormattingDropdown","menuButtonRef","toggle","setState","blockQuote","click","onDismiss","H1","H2","H3","H4","H5","H6","makeToggleHeader","tn","BaseHeading","HeadingOne","h1","HeadingTwo","h2","HeadingThree","h3","HeadingFour","h4","HeadingFive","h5","HeadingSix","h6","_templateObject2$1","_templateObject$4","alignColumn","alignValue","_state$schema$nodes","tableCell","tableHeader","cellNode","entries","find","entry","columnPos","parseInt","cell","FloatingTableColumnMenu","_props$editorView$vie","getElementsByClassName","markerDivRow","markerDivCol","markerDivRows","contains","IconWrapperCol","small","primary","IconWrapperRow","span","_templateObject4$1","_templateObject3$1","_templateObject2$2","_templateObject$5","AddColumnMenu","marker","tableHeight","_useState","hovered","setHovered","zIndex","Fragment","Wrapper","onMouseEnter","onMouseLeave","IconWrapperCol$1","Pointer","ColumnDivider","_ref2","_templateObject4$2","_templateObject3$2","_templateObject2$3","_templateObject$6","AddRowMenu","tableWidth","Wrapper$1","IconWrapperRow$1","position","cellInNextRow","cells","insert","addRow","Pointer$1","ColumnDivider$1","FloatingTableAddMenu","markerDivTable","tableElm","closest","_tableElm$getBounding","markerCols","markerRows","_templateObject$7","TableOptionsMenu","createPortal","Wrapper$2","_ref3","FloatingTableMenu","createCell","cellType","createChecked","UndoControl","RedoControl","_templateObject7$2","_templateObject6$2","_templateObject5$2","_templateObject4$3","_templateObject3$3","_templateObject2$4","_templateObject$8","LinkForm","setHref","setTitle","save","onEnterSave","onEscapeCancel","keyCode","cancel","componentDidMount","addEventListener","componentWillUnmount","removeEventListener","componentWillReceiveProps","_this$props","removeLink","_this$props$style","_this$state","LinkPopup","LinkLabel","LinkInput","placeholder","onKeyPress","LinkActions","DeleteLink","SaveLink","LinkPopupKeyframes","_templateObject2$5","_templateObject$9","FloatingLinkForm","linkPluginState","_view$state$selection","selState","clickTarget","domAtPos","parentNode","setPosition","renderTarget","minWidth","ow_ct","offsetWidth","ol_ct","ow_rt","parentElement","ol_rt","ol","calcLeftOffset","arrowOffset","_minWidth","calcArrowLeftOffset","linkMark","LinkFormWrapper","LinkArrow","removeMark","removeLinkBeingEdited","updateLinkBeingEdited","unmountLinkForm","_templateObject10$1","_templateObject9$1","_templateObject8$1","_templateObject7$3","_templateObject6$3","_templateObject5$3","_templateObject4$4","_templateObject3$4","_templateObject2$6","_templateObject$a","FloatingImageMenu","_useState2","setAlt","_useState3","linkTitle","setLinkTitle","_useState4","linkSrc","setLinkSrc","_view$coordsAtPos","coordsAtPos","_useState5","modalTop","setModalTop","_useState6","modalLeft","setModalLeft","inputRef","imageRef","_useState7","linked","toggleLinked","positionImage","scroll","wysiwygWrapper","wrapperDimensions","clientWidth","debouncedPositionImage","updateNodeAttrs","setNodeMarkup","closeImageSettings","LinkPopup$1","onKeyDown","evt","LinkLabel$1","LinkInput$1","ToggleElement","ToggleInput","ToggleLabel","htmlFor","role","ToggleSwitch","checked","LinkActions$1","CancelLink","SaveLink$1","ImageMenu","imageUpload","promise","then","url","_editorView$view","insertImage","_templateObject8$2","_templateObject7$4","_templateObject6$4","_templateObject5$4","_templateObject4$5","_templateObject3$5","_templateObject2$7","_templateObject$b","BoldControl","ItalicControl","UnderlineControl","LinkControl","Menu","_props$bottom","bottom","_props$sticky","sticky","menuFixed","setMenuFixed","isBrowser","menuRef","menuBoundingBox","setMenuBoundingBox","menuFixedTopOffset","handleScroll","startPosition","endPosition","offsetHeight","scrollY","handleResize","wasMenuFixed","preventProsemirrorFocusLoss","useCallback","stopPropagation","preventDefault","MenuPlaceholder","MenuWrapper","MenuContainer","onMouseDown","TableControl","QuoteControl","CodeControl","BulletList","OrderedList","commandContrl","_title","focusOnCreate","CommandControl","MenuButton$1","wrapInBlockquote","nodeRange","insertTableCmd","tableRow","headerCells","rows","newTable","insertTable","makeCodeBlock","MenuItem$1","TranslatorContext","Menu$1","_templateObject2$8","_templateObject$c","Wysiwyg","upload","_useProsemirror","prosemirrorEl","WysiwygWrapper","rel"],"mappings":"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","file":"7cb4ee50-1d7081c785beeace90b3.js","sourcesContent":["import \"core-js/modules/es7.object.entries\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.array.reduce\";\nimport \"core-js/modules/es6.string.starts-with\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.string.ends-with\";\nimport \"core-js/modules/es6.regexp.match\";\nimport \"core-js/modules/es6.string.repeat\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.array.from\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.array.map\";\nimport \"core-js/modules/es6.array.find-index\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/es6.string.link\";\nimport \"core-js/modules/es6.string.anchor\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.array.some\";\nimport \"core-js/modules/es6.array.for-each\";\nimport \"core-js/modules/es6.array.filter\";\nimport \"core-js/modules/es6.regexp.constructor\";\nimport \"core-js/modules/es6.array.index-of\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.object.to-string\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.object.create\";\nimport \"core-js/modules/es6.object.assign\";\nimport \"core-js/modules/es6.object.define-property\";\nimport React__default, { useMemo, useState, useCallback, useEffect, useRef, createElement, createContext, useContext, Component, createRef, Fragment as Fragment$1, useLayoutEffect } from 'react';\nimport styled, { css, keyframes } from 'styled-components';\nimport { Decoration, DecorationSet, EditorView } from 'prosemirror-view';\nimport { PluginKey, Plugin, EditorState, Selection, TextSelection, NodeSelection } from 'prosemirror-state';\nimport { dropCursor } from 'prosemirror-dropcursor';\nimport { gapCursor } from 'prosemirror-gapcursor';\nimport { history, undo, redo, undoDepth, redoDepth } from 'prosemirror-history';\nimport { keymap } from 'prosemirror-keymap';\nimport { CellSelection, TableMap, tableEditing, tableNodes, goToNextCell, deleteColumn, deleteRow, deleteTable } from 'prosemirror-tables';\nimport { wrappingInputRule, textblockTypeInputRule, InputRule, inputRules as inputRules$1, undoInputRule } from 'prosemirror-inputrules';\nimport { baseKeymap, chainCommands, createParagraphNear, liftEmptyBlock, splitBlock, exitCode, toggleMark, setBlockType, wrapIn, lift } from 'prosemirror-commands';\nimport { Slice, Fragment, Schema, Mark, DOMSerializer as DOMSerializer$1, DOMParser as DOMParser$1 } from 'prosemirror-model';\nimport { findParentNodeOfType, forEachCellInColumn, setCellAttrs, addColumnAt, addRowAt, getCellsInRow } from 'prosemirror-utils';\nimport { liftListItem, wrapInList, splitListItem, sinkListItem } from 'prosemirror-schema-list';\nimport { liftTarget } from 'prosemirror-transform';\nimport ReactDOM__default, { createPortal } from 'react-dom';\nimport { Dismissible } from 'react-dismissible';\nimport { HeadingIcon, AlignLeft, AlignCenter, AlignRight, TrashIcon, AddIcon, UndoIcon, RedoIcon, MediaIcon, QuoteIcon, CodeIcon, UnorderedListIcon, OrderedListIcon, TableIcon, BoldIcon, ItalicIcon, UnderlineIcon, LinkIcon } from '@tinacms/icons';\nimport { IconButton, TinaReset } from '@tinacms/styles';\nimport debounce from 'lodash.debounce';\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _taggedTemplateLiteralLoose(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  strings.raw = raw;\n  return strings;\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction singleMarkCommand(markType, getAttrs) {\n  // Version 1\n  return function command(state, dispatch, match, start, end) {\n    var attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs;\n    var tr = state.tr;\n    var offset = match[1].length;\n    var textGroup = 2;\n\n    if (match[textGroup]) {\n      var textStart = start + 1 + offset;\n      var textEnd = textStart + match[textGroup].length;\n      var deleteStart = [textStart - 1, textStart];\n      var nextChar = getNextChar(state, textEnd);\n      var deleteEndEnd = nextChar ? 0 : 1;\n      var deleteEnd = [textEnd, textEnd + deleteEndEnd]; // console.log({\n      //   match,\n      //   start,\n      //   end,\n      //   offset,\n      //   textStart,\n      //   textEnd,\n      //   deleteStart,\n      //   deleteEnd,\n      // })\n\n      tr[\"delete\"].apply(tr, deleteEnd);\n      tr[\"delete\"].apply(tr, deleteStart);\n      end = start + match[textGroup].length + offset;\n    }\n\n    tr.addMark(start + offset, end, markType.create(attrs));\n    tr.removeStoredMark(markType);\n\n    if (dispatch) {\n      dispatch(tr);\n    }\n\n    return tr;\n  };\n}\n\nfunction getNextChar(state, textEnd) {\n  try {\n    return state.doc.textBetween(textEnd + 1, textEnd + 2);\n  } catch (e) {\n    return '';\n  }\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar star = '\\\\*';\n\nvar _double = function _double(boundary) {\n  return new RegExp(\"\" + boundary + boundary + \"([^\\r\\n\\t\\f\" + boundary + \"} ](.*[^\\r\\n\\t\\f\" + boundary + \" ])?)\" + boundary + boundary);\n};\n\nvar single = function single(boundary) {\n  return new RegExp(\"(^|[^\" + boundary + \"])\" + boundary + \"([^\\r\\n\\t\\f\" + boundary + \" ](.*[^\\r\\n\\t\\f\" + boundary + \" ])?)\" + boundary);\n};\n\nvar STRONG = /*#__PURE__*/_double(star);\n\nvar EM = /*#__PURE__*/single(star);\n\nvar S = /*#__PURE__*/_double('~');\n\nvar EM_UNDERSCORE = /*#__PURE__*/single('_');\nvar CODE = /*#__PURE__*/single('`');\n\nfunction buildInputRules(schema) {\n  var rules = [];\n  var type;\n  if (type = schema.nodes.blockquote) rules.push(blockQuoteRule(type));\n  if (type = schema.nodes.ordered_list) rules.push(orderedListRule(type));\n  if (type = schema.nodes.bullet_list) rules.push(bulletListRule(type));\n  if (type = schema.nodes.code_block) rules.push(codeBlockRule(type));\n  if (type = schema.nodes.heading) rules.push(headingRule(type, 6));\n  if (type = schema.nodes.horizontal_rule) rules.push(horizontalRuleRule(type));\n  var mark;\n\n  if (mark = schema.marks.strong) {\n    rules.push(strongStarRule(mark));\n    rules.push(strongUnderRule(mark));\n  }\n\n  if (mark = schema.marks.s) {\n    rules.push(strikethroughRule(mark));\n  }\n\n  if (mark = schema.marks.em) {\n    rules.push(emStarRule(mark));\n    rules.push(emUnderRule(mark));\n  }\n\n  if (mark = schema.marks.code) rules.push(codeRule(mark));\n  return rules;\n}\n\nfunction markInputRule(regexp, markType, getAttrs) {\n  return new InputRule(regexp, function (state, match, start, end) {\n    var attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs;\n    var tr = state.tr;\n\n    if (match[1]) {\n      var textStart = start + match[0].indexOf(match[1]);\n      var textEnd = textStart + match[1].length;\n      if (textEnd < end) tr[\"delete\"](textEnd, end);\n      if (textStart > start) tr[\"delete\"](start, textStart);\n      end = start + match[1].length;\n    }\n\n    tr.addMark(start, end, markType.create(attrs));\n    tr.removeStoredMark(markType);\n    return tr;\n  }); // todo: the typing broke this\n}\n\nfunction singleMarkInputRule(regexp, markType, getAttrs) {\n  var command = singleMarkCommand(markType, getAttrs);\n  return new InputRule(regexp, function (state, match, start, end) {\n    return command(state, null, match, start, end);\n  }); // todo: broke by new typings\n}\n\nfunction strongStarRule(markType) {\n  return markInputRule(STRONG, markType, {});\n}\n\nfunction strikethroughRule(markType) {\n  return markInputRule(S, markType, {});\n}\n\nfunction strongUnderRule(markType) {\n  return markInputRule(_double('_'), markType, {});\n}\n\nfunction emStarRule(markType) {\n  return singleMarkInputRule(EM, markType, {});\n}\n\nfunction emUnderRule(markType) {\n  return singleMarkInputRule(EM_UNDERSCORE, markType, {});\n}\n\nfunction codeRule(markType) {\n  return singleMarkInputRule(CODE, markType, {});\n} // : (NodeType) → InputRule\n// Given a blockquote node type, returns an input rule that turns `\"> \"`\n// at the start of a textblock into a blockquote.\n\n\nfunction blockQuoteRule(nodeType) {\n  return wrappingInputRule(/^\\s*>\\s$/, nodeType);\n} // : (NodeType) → InputRule\n// Given a list node type, returns an input rule that turns a number\n// followed by a dot at the start of a textblock into an ordered list.\n\n\nfunction orderedListRule(nodeType) {\n  return wrappingInputRule(/^(\\d+)\\.\\s$/, nodeType, function (match) {\n    return {\n      order: +match[1]\n    };\n  }, function (match, node) {\n    return node.childCount + node.attrs.order == +match[1];\n  });\n}\n\nfunction horizontalRuleRule(nodeType) {\n  return new InputRule(/^(---|___|\\*\\*\\*)$/, function (state, _match, start, end) {\n    return state.tr.replaceRangeWith(start, end, nodeType.create());\n  });\n} // : (NodeType) → InputRule\n// Given a list node type, returns an input rule that turns a bullet\n// (dash, plush, or asterisk) at the start of a textblock into a\n// bullet list.\n\n\nfunction bulletListRule(nodeType) {\n  return wrappingInputRule(/^\\s*([-+*])\\s$/, nodeType);\n} // : (NodeType) → InputRule\n// Given a code block node type, returns an input rule that turns a\n// textblock starting with three backticks into a code block.\n\n\nfunction codeBlockRule(nodeType) {\n  return textblockTypeInputRule(/^```([a-zA-Z]*)? $/, nodeType, function (match) {\n    var language = match[1];\n\n    if (language) {\n      return {\n        params: language\n      };\n    }\n\n    return {};\n  });\n} // : (NodeType, number) → InputRule\n// Given a node type and a maximum level, creates an input rule that\n// turns up to that number of `#` characters followed by a space at\n// the start of a textblock into a heading whose level corresponds to\n// the number of `#` signs.\n\n\nfunction headingRule(nodeType, maxLevel) {\n  return textblockTypeInputRule(new RegExp('^(#{1,' + maxLevel + '})\\\\s$'), nodeType, function (match) {\n    return {\n      level: match[1].length\n    };\n  });\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction inputRules(schema) {\n  return inputRules$1({\n    rules: buildInputRules(schema)\n  });\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction byType(__type) {\n  return function (plugin) {\n    return plugin.__type === __type;\n  };\n}\n\nfunction findPlugins(type, plugins) {\n  return plugins.filter(byType(type));\n}\n\nvar mac = typeof navigator != 'undefined' ? /*#__PURE__*/ /Mac/.test(navigator.platform) : false;\n\nfunction buildKeymap(schema, plugins) {\n  var keys = _extends({}, baseKeymap);\n\n  function bind(key, cmd) {\n    if (keys[key]) {\n      cmd = chainCommands(cmd, keys[key]);\n    }\n\n    keys[key] = cmd;\n  }\n\n  bind('Enter', chainCommands(createParagraphNear, liftEmptyBlock, splitBlock));\n  findPlugins('wysiwyg:keymap', plugins).forEach(function (plugin) {\n    var skip = false; // Exit early if this is a Mac, and it shouldn't be added for Mac.\n\n    if (plugin.unlessMac && mac) skip = true; // Exit early if it is for a mark type that doesn't exist.\n\n    if (plugin.ifMark && !schema.marks[plugin.ifMark]) skip = true; // Exit early if it is for a node type that doesn't exist.\n\n    if (plugin.ifNode && !schema.nodes[plugin.ifNode]) skip = true;\n    if (plugin.ifNodes && !plugin.ifNodes.some(function (n) {\n      return schema.nodes[n];\n    })) skip = true; // Exit if condition not met\n\n    if (plugin.onCondition && !plugin.onCondition(schema)) skip = true; // Bind the command\n\n    if (!skip) bind(plugin.name, plugin.command(schema));\n  });\n  return keys;\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar commonPluginKey = /*#__PURE__*/new PluginKey('common');\nvar commonPlugin = /*#__PURE__*/new Plugin({\n  key: commonPluginKey,\n  state: {\n    init: function init() {\n      return {\n        editorFocused: false\n      };\n    },\n    apply: function apply(tr, prev) {\n      if (tr.getMeta('editor_focused') === false) {\n        return {\n          editorFocused: false\n        };\n      }\n\n      if (tr.getMeta('editor_focused')) {\n        return {\n          editorFocused: true\n        };\n      }\n\n      return prev;\n    }\n  },\n  props: {\n    handleScrollToSelection: function handleScrollToSelection() {\n      return true;\n    },\n    handleDOMEvents: {\n      focus: function focus(view) {\n        var state = view.state,\n            dispatch = view.dispatch;\n        dispatch(state.tr.setMeta('editor_focused', true));\n        return false;\n      },\n      blur: function blur(view) {\n        var state = view.state,\n            dispatch = view.dispatch;\n        dispatch(state.tr.setMeta('editor_focused', false));\n        return false;\n      }\n    }\n  }\n});\n\nvar findElementOffsetTop = function findElementOffsetTop(element, parent) {\n  var target = element;\n  var offsetTop = target.offsetTop;\n\n  while (target.offsetParent && (!parent || target.offsetParent !== parent)) {\n    target = target.offsetParent;\n    offsetTop += target.offsetTop;\n  }\n\n  return offsetTop;\n};\n\nvar findElementOffsetLeft = function findElementOffsetLeft(element, parent) {\n  var target = element;\n  var offsetLeft = target.offsetLeft;\n\n  while (target.offsetParent && (!parent || target.offsetParent !== parent)) {\n    target = target.offsetParent;\n    offsetLeft += target.offsetLeft;\n  }\n\n  return offsetLeft;\n};\n/**\r\n * Function will check if mark is present in selection.\r\n */\n\n\nvar isMarkPresent = function isMarkPresent(state, markType) {\n  return !!getMarkPresent(state, markType);\n};\n/**\r\n * Function will check if mark is present in selection.\r\n */\n\n\nvar getMarkPresent = function getMarkPresent(state, markType) {\n  var selection = state.selection;\n  var anchor = selection.anchor,\n      head = selection.head;\n  var start;\n  var end;\n\n  if (anchor < head) {\n    start = anchor;\n    end = head;\n  } else {\n    start = head;\n    end = anchor;\n  }\n\n  start = selection.empty ? start : start + 1;\n  var mark = markType.isInSet(state.doc.resolve(start).marks());\n  if (!mark) return false;\n  var markPresent = mark;\n\n  for (; start < end && markPresent; start += 1) {\n    if (!markType.isInSet(state.doc.resolve(start).marks())) markPresent = undefined;\n  }\n\n  return markPresent;\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar HTTP_LINK_REGEX = /\\bhttps?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:;%_\\+.,~#?&//=]*)/g;\nvar linkPluginKey = /*#__PURE__*/new PluginKey('image');\n\nfunction links() {\n  var shiftKey;\n  return new Plugin({\n    key: linkPluginKey,\n    state: {\n      init: function init() {\n        return {\n          showLinkForm: false\n        };\n      },\n      apply: function apply(tr, prev, _, state) {\n        if (tr.getMeta('show_link_toolbar') === false) {\n          return {\n            show_link_toolbar: false\n          };\n        }\n\n        if (tr.getMeta('show_link_toolbar')) {\n          return {\n            show_link_toolbar: true\n          };\n        }\n\n        var _commonPluginKey$getS = commonPluginKey.getState(state),\n            editorFocused = _commonPluginKey$getS.editorFocused;\n\n        if (isMarkPresent(state, state.schema.marks.link)) {\n          return {\n            show_link_toolbar: true\n          };\n        } else if (editorFocused) {\n          return {\n            show_link_toolbar: false\n          };\n        }\n\n        return prev;\n      }\n    },\n    props: {\n      transformPasted: function transformPasted(slice) {\n        if (shiftKey) {\n          return slice;\n        }\n\n        return new Slice(linkify(slice.content), slice.openStart, slice.openEnd);\n      },\n      handleKeyDown: function handleKeyDown(_x, e) {\n        shiftKey = e.shiftKey;\n        return false;\n      },\n      handleClickOn: function handleClickOn(view, _1) {\n        var dispatch = view.dispatch,\n            state = view.state;\n        var tr = state.tr,\n            schema = state.schema;\n\n        if (!isMarkPresent(state, schema.marks.link)) {\n          dispatch(tr.setMeta('show_link_toolbar', false));\n        }\n      }\n    }\n  });\n}\n/**\r\n * Taken from https://stackoverflow.com/questions/3809401/what-is-a-good-regular-expression-to-match-a-url\r\n *\r\n * Todo: Might be a good idea to replace this with a library that does it really well.\r\n *\r\n * @type {RegExp}\r\n */\n\n\nvar IMG_REGEX = /\\.(jpe?g|png)/;\n\nvar linkify = function linkify(fragment) {\n  var linkified = [];\n  fragment.forEach(function (child) {\n    if (child.isText) {\n      var text = child.text;\n      var pos = 0;\n      var match;\n      var link = child.type.schema.marks['link'];\n      var img = child.type.schema.nodes['image'];\n      var matches = [];\n\n      while (match = HTTP_LINK_REGEX.exec(text)) {\n        var start = match.index;\n        var end = start + match[0].length;\n        matches.push({\n          start: start,\n          end: end\n        });\n      }\n\n      matches.forEach(function (_ref) {\n        var start = _ref.start,\n            end = _ref.end; // simply copy across the text from before the match\n\n        if (start > 0) {\n          linkified.push(child.cut(pos, start));\n        }\n\n        var attrs;\n        var urlText = text.slice(start, end);\n\n        if (IMG_REGEX.test(urlText)) {\n          attrs = {\n            src: urlText,\n            title: '',\n            alt: ''\n          };\n          linkified.push(img.create(attrs));\n        } else {\n          attrs = {\n            href: urlText,\n            title: urlText\n          };\n          linkified.push(child.cut(start, end).mark(link.create(attrs).addToSet(child.marks)));\n        }\n\n        pos = end;\n      }); // copy over whatever is left\n\n      if (pos < text.length) {\n        linkified.push(child.cut(pos));\n      }\n    } else {\n      linkified.push(child.copy(linkify(child.content)));\n    }\n  });\n  return Fragment.fromArray(linkified);\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar buildCellSelection = function buildCellSelection(pos, classes, tableMap, table, state) {\n  if (classes.includes('tina_table_header_ext_top_left')) return buildTableSelection(pos, tableMap, table, state.doc);\n  if (classes.includes('tina_table_header_ext_left')) return buildColumnSelection(pos, tableMap, table, state.doc);\n  if (classes.includes('tina_table_header_ext_top')) return buildRowSelection(pos, tableMap, table, state.doc);\n};\n\nvar buildColumnSelection = function buildColumnSelection(pos, tableMap, table, doc) {\n  var width = tableMap.width;\n  var colStart = tableMap.map.findIndex(function (c) {\n    return c === pos - table.start;\n  });\n  return new CellSelection(doc.resolve(tableMap.map[colStart + width - 1] + table.start), doc.resolve(pos));\n};\n\nvar buildRowSelection = function buildRowSelection(pos, tableMap, table, doc) {\n  var width = tableMap.width,\n      height = tableMap.height;\n  var rowStart = tableMap.map.findIndex(function (c) {\n    return c === pos - table.start;\n  });\n  return new CellSelection(doc.resolve(tableMap.map[rowStart + width * (height - 1)] + table.start), doc.resolve(pos));\n};\n\nvar buildTableSelection = function buildTableSelection(pos, tableMap, table, doc) {\n  return new CellSelection(doc.resolve(tableMap.map[tableMap.map.length - 1] + table.start), doc.resolve(pos));\n};\n\nvar buildExtendedHeaders = function buildExtendedHeaders(tableNode, selection) {\n  var tableMap = TableMap.get(tableNode.node);\n  var colSelection = selection.isColSelection && selection.isColSelection();\n  var rowSelection = selection.isRowSelection && selection.isRowSelection();\n  var decorations = buildExtendedTableHeaders(tableNode, colSelection, rowSelection);\n  decorations = [].concat(decorations, buildExtendedColumnHeaders(tableNode, tableMap, selection, colSelection));\n  decorations = [].concat(decorations, buildExtendedRowHeaders(tableNode, tableMap, selection, rowSelection));\n  return decorations;\n};\n\nvar buildExtendedColumnHeaders = function buildExtendedColumnHeaders(tableNode, tableMap, selection, colSelection) {\n  var decorations = [];\n  var cellMap = tableMap.map;\n\n  var _loop = function _loop(i) {\n    var div = document.createElement('div');\n    div.classList.add('tina_table_header_ext_top');\n\n    if (colSelection && selection.ranges.some(function (r) {\n      return r.$from.pos === tableNode.start + cellMap[i] + 1;\n    })) {\n      div.classList.add('tina_table_header_ext_top_selected');\n    }\n\n    decorations.push(Decoration.widget(tableNode.start + cellMap[i] + 1, div));\n  };\n\n  for (var i = 0; i < tableMap.width; i++) {\n    _loop(i);\n  }\n\n  return decorations;\n};\n\nvar buildExtendedRowHeaders = function buildExtendedRowHeaders(tableNode, tableMap, selection, rowSelection) {\n  var decorations = [];\n  var cellMap = tableMap.map;\n\n  var _loop2 = function _loop2(i) {\n    var div = document.createElement('div');\n    div.classList.add('tina_table_header_ext_left');\n\n    if (rowSelection && selection.ranges.some(function (r) {\n      return r.$from.pos === tableNode.start + cellMap[i * tableMap.width] + 1;\n    })) {\n      div.classList.add('tina_table_header_ext_left_selected');\n    }\n\n    decorations.push(Decoration.widget(tableNode.start + cellMap[i * tableMap.width] + 1, div));\n  };\n\n  for (var i = 0; i < tableMap.height; i++) {\n    _loop2(i);\n  }\n\n  return decorations;\n};\n\nvar buildExtendedTableHeaders = function buildExtendedTableHeaders(tableNode, colSelection, rowSelection) {\n  var decorations = [];\n  var div = document.createElement('div');\n  div.classList.add('tina_table_header_ext_top_left');\n\n  if (colSelection && rowSelection) {\n    div.classList.add('tina_table_header_ext_top_left_selected');\n  }\n\n  decorations.push(Decoration.widget(tableNode.start + 2, div));\n  return decorations;\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar tablePluginKey = /*#__PURE__*/new PluginKey('table');\nvar tablePlugin = /*#__PURE__*/new Plugin({\n  key: tablePluginKey,\n  state: {\n    init: function init() {\n      return {\n        deco: DecorationSet.empty\n      };\n    },\n    apply: function apply(tr, prev, _3, newState) {\n      if (tr.getMeta('image_clicked') === false) return prev;\n      var selection = newState.selection;\n\n      if (selection) {\n        var table = newState.schema.nodes.table;\n        var tableNode = findParentNodeOfType(table)(selection);\n\n        if (tableNode) {\n          var decorations = buildExtendedHeaders(tableNode, selection);\n          if (decorations.length) return {\n            deco: DecorationSet.create(newState.doc, decorations),\n            tableMap: TableMap.get(tableNode.node),\n            selectedTable: tableNode\n          };\n        }\n      }\n\n      return {\n        deco: DecorationSet.empty\n      };\n    }\n  },\n  props: {\n    decorations: function decorations(state) {\n      return this.getState(state).deco;\n    },\n\n    /**\r\n     * When extended table header is clicked, corresponding column or row should be selected.\r\n     */\n    handleClickOn: function handleClickOn(view, _1, _2, nodePos, event, direct) {\n      if (!direct) return false;\n      var targetClasses = event.target.classList;\n      var state = view.state,\n          dispatch = view.dispatch;\n      var tablePluginState = tablePluginKey.getState(state);\n      var tableMap = tablePluginState.tableMap,\n          selectedTable = tablePluginState.selectedTable;\n      var cellSelection = buildCellSelection(nodePos, targetClasses.value, tableMap, selectedTable, state);\n      if (cellSelection) dispatch(state.tr.setSelection(cellSelection));\n      return false;\n    }\n  }\n});\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\nvar imagePluginKey = /*#__PURE__*/new PluginKey('image');\nvar imagePlugin = /*#__PURE__*/new Plugin({\n  key: imagePluginKey,\n  state: {\n    init: function init() {\n      return {\n        selectedImage: undefined\n      };\n    },\n    apply: function apply(tr, prev) {\n      if (prev && prev.selectedImage) {\n        var pos = prev.selectedImage.pos;\n        if (!tr.doc.nodeAt(pos)) return {};\n      }\n\n      var selectedImage = tr.getMeta('image_clicked');\n      if (selectedImage) return {\n        selectedImage: selectedImage\n      };\n      if (selectedImage === false) return {\n        selectedImage: undefined\n      };\n      return prev;\n    }\n  },\n  props: {\n    decorations: function decorations(state) {\n      return this.getState(state).deco;\n    },\n    handleKeyDown: function handleKeyDown(view, event) {\n      if (event.key === 'Escape') {\n        var state = view.state,\n            dispatch = view.dispatch;\n        dispatch(state.tr.setMeta('image_clicked', false));\n      }\n\n      return false;\n    },\n    handleClickOn: function handleClickOn(view, _1, node, nodePos, _2, direct) {\n      if (!direct) return false;\n      var state = view.state,\n          dispatch = view.dispatch;\n      var image = view.state.schema.nodes.image;\n\n      if (node.type === image) {\n        dispatch(state.tr.setMeta('image_clicked', {\n          pos: nodePos,\n          node: node\n        }));\n      } else {\n        dispatch(state.tr.setMeta('image_clicked', false));\n      }\n\n      return false;\n    }\n  }\n});\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\nfunction createEditorState(schema, translator, plugins, value) {\n  return EditorState.create({\n    schema: schema,\n    doc: translator.nodeFromString(value),\n    plugins: [commonPlugin, inputRules(schema), keymap(buildKeymap(schema, plugins)), history(), links(), dropCursor({\n      width: 2,\n      color: 'rgb(0, 132, 255)'\n    }), gapCursor(), tableEditing(), tablePlugin, imagePlugin]\n  });\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction useProsemirrorSchema(plugins) {\n  var schema = useMemo(function () {\n    return new Schema({\n      nodes: getNodes(plugins),\n      marks: getMarks(plugins)\n    });\n  }, [plugins]);\n  return [schema];\n}\n\nfunction getNodes(plugins) {\n  var nodes = {};\n  plugins.filter(function (plugin) {\n    return plugin.__type === 'wysiwyg:schema:node';\n  }).forEach(function (plugin) {\n    nodes[plugin.name] = plugin.node;\n  });\n  return nodes;\n}\n\nfunction getMarks(plugins) {\n  var marks = {};\n  plugins.filter(function (plugin) {\n    return plugin.__type === 'wysiwyg:schema:mark';\n  }).forEach(function (plugin) {\n    marks[plugin.name] = plugin.mark;\n  });\n  return marks;\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar Translator = function Translator() {};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar MarkdownSerializer = /*#__PURE__*/function () {\n  function MarkdownSerializer(nodes, marks) {\n    // :: Object<(MarkdownSerializerState, Node)> The node serializer\n    // functions for this serializer.\n    this.nodes = nodes; // :: Object The mark serializer info.\n\n    this.marks = marks;\n  } // :: (Node, ?Object) → string\n  // Serialize the content of the given node to\n  // [CommonMark](http://commonmark.org/).\n\n\n  var _proto = MarkdownSerializer.prototype;\n\n  _proto.serialize = function serialize(content, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var state = new MarkdownSerializerState(this.nodes, this.marks, options);\n    state.renderContent(content);\n    return state.out;\n  };\n\n  return MarkdownSerializer;\n}(); // ::- This is an object used to track state and expose\n// methods related to markdown serialization. Instances are passed to\n// node and mark serialization methods (see `toMarkdown`).\n\n\nvar MarkdownSerializerState = /*#__PURE__*/function () {\n  function MarkdownSerializerState(nodes, marks, options) {\n    this.nodes = nodes;\n    this.marks = marks;\n    this.delim = this.out = '';\n    this.closed = false;\n    this.inTightList = false; // :: Object\n    // The options passed to the serializer.\n    //   tightLists:: ?bool\n    //   Whether to render lists in a tight style. This can be overridden\n    //   on a node level by specifying a tight attribute on the node.\n    //   Defaults to false.\n\n    this.options = options || {};\n    if (typeof this.options.tightLists == 'undefined') this.options.tightLists = false;\n  }\n\n  var _proto2 = MarkdownSerializerState.prototype;\n\n  _proto2.flushClose = function flushClose(size) {\n    if (this.closed) {\n      if (!this.atBlank()) this.out += '\\n';\n      if (size == null) size = 2;\n\n      if (size > 1) {\n        var delimMin = this.delim;\n        var trim = /\\s+$/.exec(delimMin);\n        if (trim) delimMin = delimMin.slice(0, delimMin.length - trim[0].length);\n\n        for (var i = 1; i < size; i++) {\n          this.out += delimMin + '\\n';\n        }\n      }\n\n      this.closed = false;\n    }\n  } // :: (string, ?string, Node, ())\n  // Render a block, prefixing each line with `delim`, and the first\n  // line in `firstDelim`. `node` should be the node that is closed at\n  // the end of the block, and `f` is a function that renders the\n  // content of the block.\n  ;\n\n  _proto2.wrapBlock = function wrapBlock(delim, firstDelim, node, f) {\n    var old = this.delim;\n    this.write(firstDelim || delim);\n    this.delim += delim;\n    f();\n    this.delim = old;\n    this.closeBlock(node);\n  };\n\n  _proto2.atBlank = function atBlank() {\n    return /(^|\\n)$/.test(this.out);\n  } // :: ()\n  // Ensure the current content ends with a newline.\n  ;\n\n  _proto2.ensureNewLine = function ensureNewLine() {\n    if (!this.atBlank()) this.out += '\\n';\n  } // :: (?string)\n  // Prepare the state for writing output (closing closed paragraphs,\n  // adding delimiters, and so on), and then optionally add content\n  // (unescaped) to the output.\n  ;\n\n  _proto2.write = function write(content) {\n    this.flushClose();\n    if (this.delim && this.atBlank()) this.out += this.delim;\n    if (content) this.out += content;\n  } // :: (Node)\n  // Close the block for the given node.\n  ;\n\n  _proto2.closeBlock = function closeBlock(node) {\n    this.closed = node;\n  } // :: (string, ?bool)\n  // Add the given text to the document. When escape is not `false`,\n  // it will be escaped.\n  ;\n\n  _proto2.text = function text(_text, escape, escFn) {\n    var lines = _text.split('\\n');\n\n    for (var i = 0; i < lines.length; i++) {\n      var startOfLine = this.atBlank() || this.closed;\n      this.write();\n      var escapedString = escape !== false ? this.esc(lines[i], startOfLine) : lines[i];\n      escapedString = escFn ? escFn(escapedString) : escapedString;\n      this.out += escapedString;\n      if (i != lines.length - 1) this.out += '\\n';\n    }\n  } // :: (Node)\n  // Render the given node as a block.\n  ;\n\n  _proto2.render = function render(node, parent, index, escFn) {\n    if (typeof parent == 'number') throw new Error('!');\n    this.nodes[node.type.name](this, node, parent, index, escFn);\n  } // :: (Node)\n  // Render the contents of `parent` as block nodes.\n  ;\n\n  _proto2.renderContent = function renderContent(parent) {\n    var _this = this;\n\n    parent.forEach(function (node, _, i) {\n      return _this.render(node, parent, i);\n    });\n  } // :: (Node)\n  // Render the contents of `parent` as inline content.\n  ;\n\n  _proto2.renderInline = function renderInline(parent, escFn) {\n    var _this2 = this;\n\n    var active = [];\n    var trailing = '';\n\n    var progress = function progress(node, _, index) {\n      if (index === void 0) {\n        index = 0;\n      }\n\n      var marks = node ? node.marks : [];\n      var indexOfCode = marks.findIndex(function (p) {\n        return p.type.name === 'code';\n      });\n\n      if (indexOfCode >= 0 && marks.length > 1) {\n        marks = [].concat(marks.slice(0, indexOfCode), marks.slice(indexOfCode + 1, marks.length), [marks[indexOfCode]]);\n      }\n\n      var leading = trailing;\n      trailing = ''; // If whitespace has to be expelled from the node, adjust\n      // leading and trailing accordingly.\n\n      if (node && node.isText && marks.some(function (mark, _i, _a) {\n        var info = _this2.marks[mark.type.name];\n        return !!(info && info.expelEnclosingWhitespace);\n      }) && /^(\\s*)(.*?)(\\s*)$/.test(node.text || '') // Todo: Don't duplicate this check.\n      ) {\n          var _Array$from = Array.from(/^(\\s*)(.*?)(\\s*)$/.exec(node.text || '') || []),\n              lead = _Array$from[1],\n              _inner = _Array$from[2],\n              trail = _Array$from[3];\n\n          leading += lead;\n          trailing = trail;\n\n          if (lead || trail) {\n            node = _inner ? node.withText(_inner) : null;\n            if (!node) marks = active;\n          }\n        }\n\n      var inner = marks.length && marks[marks.length - 1];\n      var noEsc = inner && _this2.marks[inner.type.name].escape === false;\n      var len = marks.length - (noEsc ? 1 : 0); // Try to reorder 'mixable' marks, such as em and strong, which\n      // in Markdown may be opened and closed in different order, so\n      // that order of the marks for the token matches the order in\n      // active.\n\n      outer: for (var i = 0; i < len; i++) {\n        var mark = marks[i];\n        if (!_this2.marks[mark.type.name].mixable) break;\n\n        for (var j = 0; j < active.length; j++) {\n          var other = active[j];\n          if (!_this2.marks[other.type.name].mixable) break;\n\n          if (mark.eq(other)) {\n            if (i > j) marks = marks.slice(0, j).concat(mark).concat(marks.slice(j, i)).concat(marks.slice(i + 1, len));else if (j > i) marks = marks.slice(0, i).concat(marks.slice(i + 1, j)).concat(mark).concat(marks.slice(j, len));\n            continue outer;\n          }\n        }\n      } // Find the prefix of the mark set that didn't change\n\n\n      var keep = 0;\n\n      while (keep < Math.min(active.length, len) && marks[keep].eq(active[keep])) {\n        ++keep;\n      } // Close the marks that need to be closed\n\n\n      while (keep < active.length) {\n        _this2.text(_this2.markString(active.pop(), false, node), false);\n      } // Output any previously expelled trailing whitespace outside the marks\n\n\n      if (leading) _this2.text(leading); // Open the marks that need to be opened\n\n      if (node) {\n        while (active.length < len) {\n          var add = marks[active.length];\n          active.push(add);\n\n          _this2.text(_this2.markString(add, true, node), false);\n        } // Render the node. Special case code marks, since their content\n        // may not be escaped.\n\n\n        if (noEsc && node.isText && inner) _this2.text(_this2.markString(inner, false, node) + node.text + _this2.markString(inner, true, node), false, escFn);else _this2.render(node, parent, index, escFn);\n      }\n    };\n\n    parent.forEach(progress);\n    progress(null);\n  } // :: (Node, string, (number) → string)\n  // Render a node's content as a list. `delim` should be the extra\n  // indentation added to all lines except the first in an item,\n  // `firstDelim` is a function going from an item index to a\n  // delimiter for the first line of the item.\n  ;\n\n  _proto2.renderList = function renderList(node, delim, firstDelim) {\n    var _this3 = this;\n\n    if (this.closed && this.closed.type == node.type) this.flushClose(3);else if (this.inTightList) this.flushClose(1);\n    var isTight = this.options.tightLists;\n    var prevTight = this.inTightList;\n    this.inTightList = !!isTight;\n    node.forEach(function (child, _, i) {\n      if (i && isTight) _this3.flushClose(1);\n\n      _this3.wrapBlock(delim, firstDelim(i), node, function () {\n        return _this3.render(child, node, i);\n      });\n    });\n    this.inTightList = prevTight;\n  } // :: (string, ?bool) → string\n  // Escape the given string so that it can safely appear in Markdown\n  // content. If `startOfLine` is true, also escape characters that\n  // has special meaning only at the start of the line.\n  ;\n\n  _proto2.esc = function esc(str, startOfLine) {\n    str = str.replace(/[`\\\\~\\[\\]]/g, '\\\\$&');\n    if (startOfLine) str = str.replace(/^[#\\-*+]/, '\\\\$&').replace(/^(\\d+)\\./, '$1\\\\.');\n    return str;\n  };\n\n  _proto2.quote = function quote(str) {\n    var wrap = str.indexOf('\"') == -1 ? '\"\"' : str.indexOf(\"'\") == -1 ? \"''\" : '()';\n    return wrap[0] + str + wrap[1];\n  } // :: (string, number) → string\n  // Repeat the given string `n` times.\n  ;\n\n  _proto2.repeat = function repeat(str, n) {\n    var out = '';\n\n    for (var i = 0; i < n; i++) {\n      out += str;\n    }\n\n    return out;\n  } // : (Mark, bool) → string\n  // Get the markdown string for a given opening or closing mark.\n  ;\n\n  _proto2.markString = function markString(mark, open, node) {\n    var info = this.marks[mark.type.name];\n    var value = open ? info.open : info.close;\n    return typeof value == 'string' ? value : value(this, mark, node);\n  } // :: (string) → { leading: ?string, trailing: ?string }\n  // Get leading and trailing whitespace from a string. Values of\n  // leading or trailing property of the return object will be undefined\n  // if there is no match.\n  ;\n\n  _proto2.getEnclosingWhitespace = function getEnclosingWhitespace(text) {\n    return {\n      leading: (text.match(/^(\\s+)/) || [])[0],\n      trailing: (text.match(/(\\s+)$/) || [])[0]\n    };\n  };\n\n  return MarkdownSerializerState;\n}();\n\nvar _ALIGN_STYLES;\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar get = /*#__PURE__*/require('lodash.get');\n\nvar ALIGN_STYLES = (_ALIGN_STYLES = {}, _ALIGN_STYLES['text-align:left'] = 'left', _ALIGN_STYLES['text-align:center'] = 'center', _ALIGN_STYLES['text-align:right'] = 'right', _ALIGN_STYLES);\nvar ALIGN_DASHES = {\n  left: ':---',\n  center: ':---:',\n  right: '---:'\n};\nvar TOKENS = {\n  blockquote: {\n    block: 'blockquote'\n  },\n  paragraph: {\n    block: 'paragraph'\n  },\n  list_item: {\n    block: 'list_item'\n  },\n  bullet_list: {\n    block: 'bullet_list'\n  },\n  ordered_list: {\n    block: 'ordered_list',\n    getAttrs: function getAttrs(tok) {\n      return {\n        order: +tok.attrGet('order') || 1\n      };\n    }\n  },\n  heading: {\n    block: 'heading',\n    getAttrs: function getAttrs(tok) {\n      return {\n        level: +tok.tag.slice(1)\n      };\n    }\n  },\n  code_block: {\n    block: 'code_block'\n  },\n  fence: {\n    block: 'code_block',\n    getAttrs: function getAttrs(tok) {\n      return {\n        params: tok.info || ''\n      };\n    }\n  },\n  hr: {\n    node: 'horizontal_rule'\n  },\n  image: {\n    node: 'image',\n    getAttrs: function getAttrs(tok) {\n      return {\n        src: tok.attrGet('src'),\n        title: tok.attrGet('title') || null,\n        alt: tok.children[0] && tok.children[0].content || null,\n        width: tok.attrGet('width') || null,\n        height: tok.attrGet('height') || null\n      };\n    }\n  },\n  table: {\n    block: 'table'\n  },\n  table_row: {\n    block: 'table_row'\n  },\n  table_cell: {\n    block: 'table_cell',\n    getAttrs: function getAttrs(tok) {\n      var style = '';\n\n      if (tok.attrs) {\n        for (var i = 0; i < tok.attrs.length; i++) {\n          if (tok.attrs[i][0] === 'style') {\n            style = tok.attrs[i][1];\n          }\n        }\n      }\n\n      return {\n        align: ALIGN_STYLES[style]\n      };\n    }\n  },\n  table_header: {\n    block: 'table_header',\n    getAttrs: function getAttrs(tok) {\n      var style = '';\n\n      if (tok.attrs) {\n        for (var i = 0; i < tok.attrs.length; i++) {\n          if (tok.attrs[i][0] === 'style') {\n            style = tok.attrs[i][1];\n          }\n        }\n      }\n\n      return {\n        align: ALIGN_STYLES[style]\n      };\n    }\n  },\n  hardbreak: {\n    node: 'hard_break'\n  },\n  em: {\n    mark: 'em'\n  },\n  s: {\n    mark: 's'\n  },\n  strong: {\n    mark: 'strong'\n  },\n  link: {\n    mark: 'link',\n    getAttrs: function getAttrs(tok) {\n      return {\n        href: tok.attrGet('href'),\n        title: tok.attrGet('title') || null\n      };\n    }\n  },\n  code_inline: {\n    mark: 'code'\n  }\n};\nvar NODES = {\n  blockquote: function blockquote(state, node) {\n    state.wrapBlock('> ', null, node, function () {\n      return state.renderContent(node);\n    });\n  },\n  code_block: function code_block(state, node) {\n    if (!node.attrs.params) {\n      state.wrapBlock('    ', null, node, function () {\n        return state.text(node.textContent, false);\n      });\n    } else {\n      state.write('```' + node.attrs.params + '\\n');\n      state.text(node.textContent, false);\n      state.ensureNewLine();\n      state.write('```');\n      state.closeBlock(node);\n    }\n  },\n  heading: function heading(state, node) {\n    if (/\\n/.test(node.textContent) && node.attrs.level < 3) {\n      state.renderInline(node);\n      state.write('\\n');\n      state.write(node.attrs.level === 1 ? '=' : '-');\n    } else {\n      state.write(state.repeat('#', node.attrs.level) + ' ');\n      state.renderInline(node);\n    }\n\n    state.closeBlock(node);\n  },\n  horizontal_rule: function horizontal_rule(state, node) {\n    state.write(node.attrs.markup || '***');\n    state.closeBlock(node);\n  },\n  bullet_list: function bullet_list(state, node) {\n    state.renderList(node, '  ', function () {\n      return (node.attrs.bullet || '*') + ' ';\n    });\n  },\n  ordered_list: function ordered_list(state, node) {\n    var start = node.attrs.order || 1;\n    var maxW = String(start + node.childCount - 1).length;\n    var space = state.repeat(' ', maxW + 2);\n    state.renderList(node, space, function (i) {\n      var nStr = String(start + i);\n      return state.repeat(' ', maxW - nStr.length) + nStr + '. ';\n    });\n  },\n  list_item: function list_item(state, node) {\n    state.renderContent(node);\n  },\n  paragraph: function paragraph(state, node, _parent, _index) {\n    state.renderInline(node);\n    state.closeBlock(node);\n  },\n  image: function image(state, node) {\n    var size = '';\n\n    if (node.attrs.height || node.attrs.width) {\n      size = \" =\" + (node.attrs.width || '') + \"x\" + (node.attrs.height || '');\n    }\n\n    var alt = state.esc(node.attrs.alt || '');\n    var src = state.esc(node.attrs.src);\n    var title = node.attrs.title ? ' ' + state.quote(node.attrs.title) : '';\n    state.write(\"![\" + alt + \"](\" + src + title + size + \")\");\n  },\n  hard_break: function hard_break(state, node, parent, index) {\n    if (!parent || typeof index !== 'number') return;\n\n    for (var i = index + 1; i < parent.childCount; i++) {\n      if (parent.child(i).type != node.type) {\n        state.write('  \\n');\n        return;\n      }\n    }\n  },\n  text: function text(state, node, _1, _2, escFn) {\n    if (typeof node.text !== 'string') return;\n    state.text(node.text, true, escFn);\n  },\n  table: function table(state, node) {\n    var inHead = true;\n    node.forEach(function (row) {\n      var nextRowIsInBody = row.content.child(0).type.name === 'table_cell';\n\n      if (inHead && nextRowIsInBody) {\n        state.write('|');\n\n        for (var i = 0; i < row.childCount; i++) {\n          var align = row.content.child(i).attrs.align;\n          var dash = ALIGN_DASHES[align] || '---';\n          state.write(\" \" + dash + \" |\");\n        }\n\n        state.write('\\n');\n        inHead = false;\n      }\n\n      NODES.table_row(state, row);\n    });\n    state.closeBlock(node);\n  },\n  table_row: function table_row(state, node) {\n    state.write('|');\n    state.renderContent(node);\n    state.write('\\n');\n  },\n  table_cell: function table_cell(state, node) {\n    state.write(' ');\n    /**\r\n     * In the case of table's are pipes escaped.\r\n     */\n\n    state.renderInline(node, function (str) {\n      return str.replace(/[\\|]/g, '\\\\$&');\n    });\n    state.write(' |');\n  },\n  table_header: function table_header(state, node) {\n    NODES.table_cell(state, node);\n  }\n};\nvar MARKS = {\n  em: {\n    open: '_',\n    close: '_',\n    mixable: true,\n    expelEnclosingWhitespace: true\n  },\n  strong: {\n    open: function open(_state, mark, node) {\n      if (get(node, 'text', '').endsWith('*')) return mark.openedWith = '__';\n      return '**';\n    },\n    close: function close(_state, mark, node) {\n      if (mark.openedWith) {\n        var closeWith = mark.openedWith;\n        mark.openedWith = null;\n        return closeWith;\n      }\n\n      if (get(node, 'text', '').endsWith('*')) return '__';\n      return '**';\n    },\n    mixable: true,\n    expelEnclosingWhitespace: true\n  },\n  link: {\n    open: '[',\n    close: function close(state, mark) {\n      return '](' + state.esc(mark.attrs.href) + (mark.attrs.title ? ' ' + state.quote(mark.attrs.title) : '') + ')';\n    }\n  },\n  s: {\n    open: '~~',\n    close: '~~',\n    mixable: true,\n    expelEnclosingWhitespace: true\n  },\n  code: {\n    open: '`',\n    close: '`',\n    escape: false\n  }\n};\n\nfunction buildTokensForSchema(schema) {\n  var tokens = {};\n  if (schema.nodes.blockquote) tokens.blockquote = TOKENS.blockquote;\n  if (schema.nodes.paragraph) tokens.paragraph = TOKENS.paragraph;\n  if (schema.nodes.list_item) tokens.list_item = TOKENS.list_item;\n  if (schema.nodes.bullet_list) tokens.bullet_list = TOKENS.bullet_list;\n  if (schema.nodes.ordered_list) tokens.ordered_list = TOKENS.ordered_list;\n  if (schema.nodes.heading) tokens.heading = TOKENS.heading;\n\n  if (schema.nodes.code_block) {\n    tokens.code_block = TOKENS.code_block;\n    tokens.fence = TOKENS.fence;\n  }\n\n  if (schema.nodes.horizontal_rule) tokens.hr = TOKENS.hr;\n  if (schema.nodes.image) tokens.image = TOKENS.image;\n  if (schema.nodes.hard_break) tokens.hardbreak = TOKENS.hardbreak;\n  if (schema.nodes.ordered_list) tokens.ordered_list = TOKENS.ordered_list;\n  if (schema.nodes.bullet_list) tokens.bullet_list = TOKENS.bullet_list;\n  if (schema.nodes.list_item) tokens.list_item = TOKENS.list_item;\n\n  if (schema.nodes.table) {\n    tokens.table = TOKENS.table;\n    tokens.thead = {\n      ignore: true\n    };\n    tokens.th = TOKENS.table_header;\n    tokens.tbody = {\n      ignore: true\n    };\n    tokens.tr = TOKENS.table_row;\n    tokens.td = TOKENS.table_cell;\n  }\n\n  if (schema.marks.em) tokens.em = TOKENS.em;\n  if (schema.marks.strong) tokens.strong = TOKENS.strong;\n  if (schema.marks.link) tokens.link = TOKENS.link;\n  if (schema.marks.code) tokens.code_inline = TOKENS.code_inline;\n  if (schema.marks.s) tokens.s = TOKENS.s;\n  return tokens;\n}\n\nfunction buildNodesFromSchema(schema) {\n  var nodes = {};\n  if (schema.nodes.blockquote) nodes.blockquote = NODES.blockquote;\n  if (schema.nodes.paragraph) nodes.paragraph = NODES.paragraph;\n  if (schema.nodes.list_item) nodes.list_item = NODES.list_item;\n  if (schema.nodes.bullet_list) nodes.bullet_list = NODES.bullet_list;\n  if (schema.nodes.ordered_list) nodes.ordered_list = NODES.ordered_list;\n  if (schema.nodes.heading) nodes.heading = NODES.heading;\n  if (schema.nodes.code_block) nodes.code_block = NODES.code_block;\n  if (schema.nodes.horizontal_rule) nodes.horizontal_rule = NODES.horizontal_rule;\n  if (schema.nodes.image) nodes.image = NODES.image;\n  if (schema.nodes.hard_break) nodes.hard_break = NODES.hard_break;\n  if (schema.nodes.ordered_list) nodes.ordered_list = NODES.ordered_list;\n  if (schema.nodes.bullet_list) nodes.bullet_list = NODES.bullet_list;\n  if (schema.nodes.list_item) nodes.list_item = NODES.list_item;\n\n  if (schema.nodes.table) {\n    nodes.table = NODES.table;\n    nodes.table_header = NODES.table_header;\n    nodes.table_row = NODES.table_row;\n    nodes.table_cell = NODES.table_cell;\n  }\n\n  nodes.text = NODES.text;\n  return nodes;\n}\n\nfunction buildMarksFromSchema(schema) {\n  return MARKS;\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction CommonMarkSerializer(schema) {\n  return new MarkdownSerializer(buildNodesFromSchema(schema), buildMarksFromSchema());\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction parseNextNumber(str, pos, max) {\n  var code;\n  var start = pos;\n  var result = {\n    ok: false,\n    pos: pos\n  };\n  code = str.charCodeAt(pos);\n\n  while (pos < max && code >= 0x30\n  /* 0 */\n  && code <= 0x39 ||\n  /* 9 */\n  code === 0x25\n  /* % */\n  ) {\n    code = str.charCodeAt(++pos);\n  }\n\n  result.ok = true;\n  result.pos = pos;\n  result.value = Number(str.slice(start, pos));\n  return result;\n}\n\nfunction parseImageSize(str, pos, max) {\n  var code;\n  var result = {\n    ok: false,\n    pos: 0\n  };\n\n  if (pos >= max) {\n    return result;\n  }\n\n  code = str.charCodeAt(pos);\n\n  if (code !== 0x3d\n  /* = */\n  ) {\n      return result;\n    }\n\n  pos++; // size must follow = without any white spaces as follows\n  // (1) =300x200\n  // (2) =300x\n  // (3) =x200\n\n  code = str.charCodeAt(pos);\n\n  if (code !== 0x78\n  /* x */\n  && (code < 0x30 || code > 0x39)\n  /* [0-9] */\n  ) {\n      return result;\n    } // parse width\n\n\n  var resultW = parseNextNumber(str, pos, max);\n  pos = resultW.pos; // next charactor must be 'x'\n\n  code = str.charCodeAt(pos);\n\n  if (code !== 0x78\n  /* x */\n  ) {\n      return result;\n    }\n\n  pos++; // parse height\n\n  var resultH = parseNextNumber(str, pos, max);\n  pos = resultH.pos;\n  result.width = resultW.value;\n  result.height = resultH.value;\n  result.pos = pos;\n  result.ok = true;\n  return result;\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction parseLinkDestination(md, state, pos) {\n  var isSpace = md.utils.isSpace;\n  var unescapeAll = md.utils.unescapeAll;\n  var str = state.src;\n  var max = state.posMax;\n  var code;\n  var level;\n  var lines = 0;\n  var start = pos;\n  var result = {\n    ok: false,\n    pos: 0,\n    lines: 0,\n    str: ''\n  };\n\n  if (str.charCodeAt(pos) === 0x3c\n  /* < */\n  ) {\n      pos++;\n\n      while (pos < max) {\n        code = str.charCodeAt(pos);\n\n        if (code === 0x0a\n        /* \\n */\n        || isSpace(code)) {\n          return result;\n        }\n\n        if (code === 0x3e\n        /* > */\n        ) {\n            result.pos = pos + 1;\n            result.str = unescapeAll(str.slice(start + 1, pos));\n            result.ok = true;\n            return result;\n          }\n\n        if (code === 0x5c\n        /* \\ */\n        && pos + 1 < max) {\n          pos += 2;\n          continue;\n        }\n\n        pos++;\n      } // no closing '>'\n\n\n      return result;\n    } // this should be ... } else { ... branch\n\n\n  level = 0;\n\n  while (pos < max) {\n    code = str.charCodeAt(pos);\n\n    if (code == 61\n    /* = */\n    || code == 34\n    /* \" */\n    || code == 39\n    /* ' */\n    // code === 0x20\n    ) {\n        pos--;\n        break;\n      } // ascii control characters\n\n\n    if (code < 0x20 || code === 0x7f) {\n      break;\n    }\n\n    if (code === 0x5c\n    /* \\ */\n    && pos + 1 < max) {\n      pos += 2;\n      continue;\n    }\n\n    if (code === 0x28\n    /* ( */\n    ) {\n        level++;\n      }\n\n    if (code === 0x29\n    /* ) */\n    ) {\n        if (level === 0) {\n          break;\n        }\n\n        level--;\n      }\n\n    pos++;\n  }\n\n  if (start === pos) {\n    return result;\n  }\n\n  if (level !== 0) {\n    return result;\n  }\n\n  result.str = unescapeAll(str.slice(start, pos));\n  result.lines = lines;\n  result.pos = pos;\n  result.ok = true;\n  return result;\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction image_with_size(md) {\n  return function (state, silent) {\n    var attrs,\n        code,\n        label,\n        pos,\n        ref,\n        res,\n        title,\n        width = null,\n        height = null,\n        token,\n        tokens,\n        start,\n        href = '';\n    var oldPos = state.pos,\n        max = state.posMax;\n\n    if (state.src.charCodeAt(state.pos) !== 0x21\n    /* ! */\n    ) {\n        return false;\n      }\n\n    if (state.src.charCodeAt(state.pos + 1) !== 0x5b\n    /* [ */\n    ) {\n        return false;\n      }\n\n    var labelStart = state.pos + 2;\n    var labelEnd = md.helpers.parseLinkLabel(state, state.pos + 1, false); // parser failed to find ']', so it's not a valid link\n\n    if (labelEnd < 0) {\n      return false;\n    }\n\n    pos = labelEnd + 1;\n\n    if (pos < max && state.src.charCodeAt(pos) === 0x28\n    /* ( */\n    ) {\n        //\n        // Inline link\n        //\n        // [link](  <href>  \"title\"  )\n        //        ^^ skipping these spaces\n        pos++;\n\n        for (; pos < max; pos++) {\n          code = state.src.charCodeAt(pos);\n\n          if (code !== 0x20 && code !== 0x0a) {\n            break;\n          }\n        }\n\n        if (pos >= max) {\n          return false;\n        } // [link](  <href>  \"title\"  )\n        //          ^^^^^^ parsing link destination\n\n\n        start = pos;\n        res = parseLinkDestination(md, state, pos);\n\n        if (res.ok) {\n          href = res.str;\n\n          if (state.md.validateLink(href)) {\n            pos = res.pos;\n          } else {\n            href = '';\n          }\n        } // [link](  <href>  \"title\"  )\n        //                ^^ skipping these spaces\n\n\n        start = pos;\n\n        for (; pos < max; pos++) {\n          code = state.src.charCodeAt(pos);\n\n          if (code !== 0x20 && code !== 0x0a) {\n            break;\n          }\n        } // [link](  <href>  \"title\"  )\n        //                  ^^^^^^^ parsing link title\n\n\n        res = md.helpers.parseLinkTitle(state.src, pos, state.posMax);\n\n        if (pos < max && start !== pos && res.ok) {\n          title = res.str;\n          pos = res.pos; // [link](  <href>  \"title\"  )\n          //                         ^^ skipping these spaces\n\n          for (; pos < max; pos++) {\n            code = state.src.charCodeAt(pos);\n\n            if (code !== 0x20 && code !== 0x0a) {\n              break;\n            }\n          }\n        } else {\n          title = '';\n        } // [link](  <href>  \"title\" =WxH  )\n        //                          ^^^^ parsing image size\n\n\n        if (pos - 1 >= 0) {\n          code = state.src.charCodeAt(pos - 1); // there must be at least one white spaces\n          // between previous field and the size\n\n          if (code === 0x20) {\n            res = parseImageSize(state.src, pos, state.posMax);\n\n            if (res.ok) {\n              width = res.width;\n              height = res.height;\n              pos = res.pos; // [link](  <href>  \"title\" =WxH  )\n              //                              ^^ skipping these spaces\n\n              for (; pos < max; pos++) {\n                code = state.src.charCodeAt(pos);\n\n                if (code !== 0x20 && code !== 0x0a) {\n                  break;\n                }\n              }\n            }\n          }\n        }\n\n        if (pos >= max || state.src.charCodeAt(pos) !== 0x29\n        /* ) */\n        ) {\n            state.pos = oldPos;\n            return false;\n          }\n\n        pos++;\n      } else {\n      //\n      // Link reference\n      //\n      if (typeof state.env.references === 'undefined') {\n        return false;\n      } // [foo]  [bar]\n      //      ^^ optional whitespace (can include newlines)\n\n\n      for (; pos < max; pos++) {\n        code = state.src.charCodeAt(pos);\n\n        if (code !== 0x20 && code !== 0x0a) {\n          break;\n        }\n      }\n\n      if (pos < max && state.src.charCodeAt(pos) === 0x5b\n      /* [ */\n      ) {\n          start = pos + 1;\n          pos = md.helpers.parseLinkLabel(state, pos);\n\n          if (pos >= 0) {\n            label = state.src.slice(start, pos++);\n          } else {\n            pos = labelEnd + 1;\n          }\n        } else {\n        pos = labelEnd + 1;\n      } // covers label === '' and label === undefined\n      // (collapsed reference link and shortcut reference link respectively)\n\n\n      if (!label) {\n        label = state.src.slice(labelStart, labelEnd);\n      }\n\n      ref = state.env.references[md.utils.normalizeReference(label)];\n\n      if (!ref) {\n        state.pos = oldPos;\n        return false;\n      }\n\n      href = ref.href;\n      title = ref.title;\n    } //\n    // We found the end of the link, and know for a fact it's a valid link;\n    // so all that's left to do is to call tokenizer.\n    //\n\n\n    if (!silent) {\n      state.pos = labelStart;\n      state.posMax = labelEnd;\n      var newState = new state.md.inline.State(state.src.slice(labelStart, labelEnd), state.md, state.env, tokens = []);\n      newState.md.inline.tokenize(newState);\n      token = state.push('image', 'img', 0);\n      token.attrs = attrs = [['src', href], ['alt', '']];\n      token.children = tokens;\n\n      if (title) {\n        attrs.push(['title', title]);\n      }\n\n      if (width !== null) {\n        attrs.push(['width', width]);\n      }\n\n      if (height !== null) {\n        attrs.push(['height', height]);\n      }\n    }\n\n    state.pos = pos;\n    state.posMax = max;\n    return true;\n  };\n}\n\nfunction imsize(md) {\n  md.inline.ruler.before('emphasis', 'image', image_with_size(md));\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction _link(md) {\n  return function (state, silent) {\n    var normalizeReference = state.md.utils.normalizeReference;\n    var isSpace = state.md.utils.isSpace;\n    var attrs,\n        code,\n        label,\n        pos,\n        res,\n        ref,\n        title,\n        token,\n        href = '',\n        start = state.pos,\n        parseReference = true;\n    var oldPos = state.pos,\n        max = state.posMax;\n\n    if (state.src.charCodeAt(state.pos) !== 0x5b\n    /* [ */\n    ) {\n        return false;\n      }\n\n    var labelStart = state.pos + 1;\n    var labelEnd = state.md.helpers.parseLinkLabel(state, state.pos, true); // parser failed to find ']', so it's not a valid link\n\n    if (labelEnd < 0) {\n      return false;\n    }\n\n    pos = labelEnd + 1;\n\n    if (pos < max && state.src.charCodeAt(pos) === 0x28\n    /* ( */\n    ) {\n        //\n        // Inline link\n        //\n        // might have found a valid shortcut link, disable reference parsing\n        parseReference = false; // [link](  <href>  \"title\"  )\n        //        ^^ skipping these spaces\n\n        pos++;\n\n        for (; pos < max; pos++) {\n          code = state.src.charCodeAt(pos);\n\n          if (!isSpace(code) && code !== 0x0a) {\n            break;\n          }\n        }\n\n        if (pos >= max) {\n          return false;\n        }\n\n        start = pos;\n        res = parseLinkDestination(md, state, pos);\n\n        if (res.ok) {\n          href = res.str;\n\n          if (state.md.validateLink(href)) {\n            pos = res.pos;\n          } else {\n            href = '';\n          }\n        } // [link](  <href>  \"title\"  )\n        //                ^^ skipping these spaces\n\n\n        start = pos;\n\n        for (; pos < max; pos++) {\n          code = state.src.charCodeAt(pos);\n\n          if (!isSpace(code) && code !== 0x0a) {\n            break;\n          }\n        } // [link](  <href>  \"title\"  )\n        //                  ^^^^^^^ parsing link title\n\n\n        res = state.md.helpers.parseLinkTitle(state.src, pos, state.posMax);\n\n        if (pos < max && start !== pos && res.ok) {\n          title = res.str;\n          pos = res.pos; // [link](  <href>  \"title\"  )\n          //                         ^^ skipping these spaces\n\n          for (; pos < max; pos++) {\n            code = state.src.charCodeAt(pos);\n\n            if (!isSpace(code) && code !== 0x0a) {\n              break;\n            }\n          }\n        } else {\n          title = '';\n        }\n\n        if (pos >= max || state.src.charCodeAt(pos) !== 0x29\n        /* ) */\n        ) {\n            // parsing a valid shortcut link failed, fallback to reference\n            parseReference = true;\n          }\n\n        pos++;\n      }\n\n    if (parseReference) {\n      //\n      // Link reference\n      //\n      if (typeof state.env.references === 'undefined') {\n        return false;\n      }\n\n      if (pos < max && state.src.charCodeAt(pos) === 0x5b\n      /* [ */\n      ) {\n          start = pos + 1;\n          pos = state.md.helpers.parseLinkLabel(state, pos);\n\n          if (pos >= 0) {\n            label = state.src.slice(start, pos++);\n          } else {\n            pos = labelEnd + 1;\n          }\n        } else {\n        pos = labelEnd + 1;\n      } // covers label === '' and label === undefined\n      // (collapsed reference link and shortcut reference link respectively)\n\n\n      if (!label) {\n        label = state.src.slice(labelStart, labelEnd);\n      }\n\n      ref = state.env.references[normalizeReference(label)];\n\n      if (!ref) {\n        state.pos = oldPos;\n        return false;\n      }\n\n      href = ref.href;\n      title = ref.title;\n    } //\n    // We found the end of the link, and know for a fact it's a valid link;\n    // so all that's left to do is to call tokenizer.\n    //\n\n\n    if (!silent) {\n      state.pos = labelStart;\n      state.posMax = labelEnd;\n      token = state.push('link_open', 'a', 1);\n      token.attrs = attrs = [['href', href]];\n\n      if (title) {\n        attrs.push(['title', title]);\n      }\n\n      state.md.inline.tokenize(state);\n      token = state.push('link_close', 'a', -1);\n    }\n\n    state.pos = pos;\n    state.posMax = max;\n    return true;\n  };\n}\n\nfunction link(md) {\n  md.inline.ruler.before('emphasis', 'link', _link(md));\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction maybeMerge(a, b) {\n  if (a.isText && b.isText && Mark.sameSet(a.marks, b.marks)) return a.copy(a.text + b.text);\n} // Object used to track the context of a running parse.\n\n\nvar MarkdownParseState = /*#__PURE__*/function () {\n  function MarkdownParseState(schema, tokenHandlers) {\n    this.schema = schema;\n    this.stack = [{\n      type: schema.topNodeType,\n      content: []\n    }];\n    this.marks = Mark.none;\n    this.tokenHandlers = tokenHandlers;\n  }\n\n  var _proto = MarkdownParseState.prototype;\n\n  _proto.top = function top() {\n    return this.stack[this.stack.length - 1];\n  };\n\n  _proto.push = function push(elt) {\n    if (this.stack.length) this.top().content.push(elt);\n  } // : (string)\n  // Adds the given text to the current position in the document,\n  // using the current marks as styling.\n  ;\n\n  _proto.addText = function addText(text) {\n    if (!text) return;\n    var nodes = this.top().content,\n        last = nodes[nodes.length - 1],\n        node = this.schema.text(text, this.marks);\n    var merged;\n    if (last && (merged = maybeMerge(last, node))) nodes[nodes.length - 1] = merged;else nodes.push(node);\n  } // : (Mark)\n  // Adds the given mark to the set of active marks.\n  ;\n\n  _proto.openMark = function openMark(mark) {\n    this.marks = mark.addToSet(this.marks);\n  } // : (Mark)\n  // Removes the given mark from the set of active marks.\n  ;\n\n  _proto.closeMark = function closeMark(mark) {\n    this.marks = mark.removeFromSet(this.marks);\n  };\n\n  _proto.parseTokens = function parseTokens(toks) {\n    for (var i = 0; i < toks.length; i++) {\n      var tok = toks[i];\n      var handler = this.tokenHandlers[tok.type];\n      if (!handler) throw new Error('Token type `' + tok.type + '` not supported by Markdown parser');\n      handler(this, tok);\n    }\n  } // : (NodeType, ?Object, ?[Node]) → ?Node\n  // Add a node at the current position.\n  ;\n\n  _proto.addNode = function addNode(type, attrs, content) {\n    var node = type.createAndFill(attrs, content, this.marks);\n    if (!node) return null;\n    this.push(node);\n    return node;\n  } // : (NodeType, ?Object)\n  // Wrap subsequent content in a node of the given type.\n  ;\n\n  _proto.openNode = function openNode(type, attrs) {\n    this.stack.push({\n      type: type,\n      attrs: attrs,\n      content: []\n    });\n  } // : () → ?Node\n  // Close and return the node that is currently on top of the stack.\n  ;\n\n  _proto.closeNode = function closeNode() {\n    if (this.marks.length) this.marks = Mark.none;\n    var info = this.stack.pop();\n    if (!info) return; //devWarn(\"Attempted to close a non-existent node.\")\n\n    return this.addNode(info.type, info.attrs, info.content);\n  };\n\n  return MarkdownParseState;\n}();\n\nfunction attrs(spec, token) {\n  if (spec.getAttrs) return spec.getAttrs(token); // For backwards compatibility when `attrs` is a Function\n  else if (spec.attrs instanceof Function) return spec.attrs(token);else return spec.attrs;\n} // Code content is represented as a single token with a `content`\n// property in Markdown-it.\n\n\nfunction noOpenClose(type) {\n  return type == 'code_inline' || type == 'code_block' || type == 'fence';\n}\n\nfunction withoutTrailingNewline(str) {\n  return str[str.length - 1] == '\\n' ? str.slice(0, str.length - 1) : str;\n}\n\nfunction noOp() {}\n\nfunction tokenHandlers(schema, tokens) {\n  var handlers = Object.create(null);\n\n  var _loop = function _loop(type) {\n    var spec = tokens[type];\n\n    if (spec.block) {\n      var nodeType = schema.nodeType(spec.block);\n\n      if (noOpenClose(type)) {\n        handlers[type] = function (state, tok) {\n          state.openNode(nodeType, attrs(spec, tok));\n          state.addText(withoutTrailingNewline(tok.content));\n          state.closeNode();\n        };\n      } else {\n        handlers[type + '_open'] = function (state, tok) {\n          return state.openNode(nodeType, attrs(spec, tok));\n        };\n\n        handlers[type + '_close'] = function (state) {\n          return state.closeNode();\n        };\n      }\n    } else if (spec.node) {\n      var _nodeType = schema.nodeType(spec.node);\n\n      handlers[type] = function (state, tok) {\n        return state.addNode(_nodeType, attrs(spec, tok));\n      };\n    } else if (spec.mark) {\n      var markType = schema.marks[spec.mark];\n\n      if (noOpenClose(type)) {\n        handlers[type] = function (state, tok) {\n          state.openMark(markType.create(attrs(spec, tok)));\n          state.addText(withoutTrailingNewline(tok.content));\n          state.closeMark(markType);\n        };\n      } else {\n        handlers[type + '_open'] = function (state, tok) {\n          return state.openMark(markType.create(attrs(spec, tok)));\n        };\n\n        handlers[type + '_close'] = function (state) {\n          return state.closeMark(markType);\n        };\n      }\n    } else if (spec.ignore) {\n      if (noOpenClose(type)) {\n        handlers[type] = noOp;\n      } else {\n        handlers[type + '_open'] = noOp;\n        handlers[type + '_close'] = noOp;\n      }\n    } else {\n      throw new RangeError('Unrecognized parsing spec ' + JSON.stringify(spec));\n    }\n  };\n\n  for (var type in tokens) {\n    _loop(type);\n  }\n\n  handlers.text = function (state, tok) {\n    return state.addText(tok.content);\n  };\n\n  handlers.inline = function (state, tok) {\n    return state.parseTokens(tok.children);\n  };\n\n  handlers.softbreak = function (state) {\n    return state.addText('\\n');\n  };\n\n  return handlers;\n} // ::- A configuration of a Markdown parser. Such a parser uses\n// [markdown-it](https://github.com/markdown-it/markdown-it) to\n// tokenize a file, and then runs the custom rules it is given over\n// the tokens to create a ProseMirror document tree.\n\n\nvar MarkdownParser = /*#__PURE__*/function () {\n  //\n  // **`getAttrs`**`: ?(MarkdownToken) → Object`\n  //   : A function used to compute the attributes for the node or mark\n  //     that takes a [markdown-it\n  //     token](https://markdown-it.github.io/markdown-it/#Token) and\n  //     returns an attribute object.\n  //\n  // **`ignore`**`: ?bool`\n  //   : When true, ignore content for the matched token.\n  function MarkdownParser(schema, tokenizer, tokens) {\n    // :: Object The value of the `tokens` object used to construct\n    // this parser. Can be useful to copy and modify to base other\n    // parsers on.\n    this.tokens = tokens;\n    this.schema = schema;\n    this.tokenizer = tokenizer;\n    this.tokenHandlers = tokenHandlers(schema, tokens);\n  } // :: (string) → Node\n  // Parse a string as [CommonMark](http://commonmark.org/) markup,\n  // and create a ProseMirror document as prescribed by this parser's\n  // rules.\n\n\n  var _proto2 = MarkdownParser.prototype;\n\n  _proto2.parse = function parse(text) {\n    var state = new MarkdownParseState(this.schema, this.tokenHandlers);\n    var doc;\n    state.parseTokens(this.tokenizer.parse(text, {}));\n\n    do {\n      doc = state.closeNode();\n    } while (state.stack.length);\n\n    return doc;\n  };\n\n  return MarkdownParser;\n}();\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar markdownit = /*#__PURE__*/require('markdown-it');\n\nfunction CommonMarkParser(schema) {\n  var parser = markdownit({\n    html: false\n  });\n  parser.use(imsize);\n  parser.use(link);\n  return new MarkdownParser(schema, parser, buildTokensForSchema(schema));\n}\n\nvar MarkdownTranslator = /*#__PURE__*/function (_Translator) {\n  _inheritsLoose(MarkdownTranslator, _Translator);\n\n  function MarkdownTranslator(schema) {\n    var _this;\n\n    _this = _Translator.call(this) || this;\n    _this.parser = null;\n    _this.serializer = null;\n    _this.schema = schema;\n    return _this;\n  }\n\n  MarkdownTranslator.fromSchema = function fromSchema(schema) {\n    return MarkdownTranslator.commonMarkFromSchema(schema);\n  };\n\n  MarkdownTranslator.commonMarkFromSchema = function commonMarkFromSchema(schema) {\n    var translator = new MarkdownTranslator(schema);\n    translator.parser = CommonMarkParser(schema);\n    translator.serializer = CommonMarkSerializer(schema);\n    return translator;\n  };\n\n  var _proto = MarkdownTranslator.prototype;\n\n  _proto.nodeFromString = function nodeFromString(value) {\n    return this.parser.parse(value);\n  };\n\n  _proto.stringFromNode = function stringFromNode(node) {\n    return this.serializer.serialize(node, {\n      tightLists: true\n    });\n  };\n\n  return MarkdownTranslator;\n}(Translator);\n\nvar DOMSerializer = /*#__PURE__*/function (_DOMSerializer2) {\n  _inheritsLoose(DOMSerializer, _DOMSerializer2);\n\n  function DOMSerializer() {\n    return _DOMSerializer2.apply(this, arguments) || this;\n  }\n\n  DOMSerializer.nodesFromSchema = function nodesFromSchema(schema) {\n    var result = gatherToDOM(schema.nodes);\n    if (!result.text) result.text = function (node) {\n      return node.text;\n    };\n    return result;\n  };\n\n  DOMSerializer.marksFromSchema = function marksFromSchema(schema) {\n    return gatherToDOM(schema.marks);\n  };\n\n  return DOMSerializer;\n}(DOMSerializer$1);\n\nfunction gatherToDOM(obj) {\n  var result = {};\n\n  for (var name in obj) {\n    var toDocument = obj[name].spec.toDocument;\n    var toDOM = obj[name].spec.toDOM;\n    if (toDocument) result[name] = toDocument;else if (toDOM) result[name] = toDOM;\n  }\n\n  return result;\n}\n\nvar DOMTranslator = /*#__PURE__*/function (_Translator) {\n  _inheritsLoose(DOMTranslator, _Translator);\n\n  function DOMTranslator(schema) {\n    var _this;\n\n    _this = _Translator.call(this) || this;\n    _this.schema = schema;\n    _this.parser = DOMParser$1.fromSchema(schema);\n    _this.serializer = DOMSerializer.fromSchema(schema);\n    return _this;\n  }\n\n  DOMTranslator.fromSchema = function fromSchema(schema) {\n    return new DOMTranslator(schema);\n  };\n\n  var _proto = DOMTranslator.prototype;\n\n  _proto.nodeFromString = function nodeFromString(value) {\n    var al;\n\n    try {\n      al = window.document.createRange().createContextualFragment(value);\n    } catch (e) {\n      al = new DOMParser().parseFromString(value, 'text/html');\n    }\n\n    return this.parser.parse(al);\n  };\n\n  _proto.stringFromNode = function stringFromNode(node) {\n    var el = document.createElement('div');\n    el.appendChild(this.serializer.serializeFragment(node.content));\n    return el.innerHTML;\n  };\n\n  return DOMTranslator;\n}(Translator);\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction useProsemirrorTranslator(schema, format) {\n  if (format === void 0) {\n    format = 'markdown';\n  }\n\n  var translator = useMemo(function () {\n    if (format === 'html') return DOMTranslator.fromSchema(schema);\n    return MarkdownTranslator.fromSchema(schema);\n  }, [schema]);\n  return [translator];\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction exitCodeHard(state, dispatch) {\n  var $head = state.selection.$head;\n  var above = $head.node(-1);\n  var after = $head.indexAfter(-1);\n  var type = above.defaultContentType(after);\n\n  if (dispatch) {\n    var pos = $head.before();\n    var tr = state.tr.replaceWith(pos, pos, type.createAndFill());\n    tr.setSelection(Selection.near(tr.doc.resolve(pos), 1));\n    dispatch(tr.scrollIntoView());\n  }\n\n  return true;\n}\n\nfunction exitCodeUp(state, dispatch) {\n  var _state$selection = state.selection,\n      $head = _state$selection.$head,\n      $anchor = _state$selection.$anchor;\n  if (!$head.parent.type.spec.code || !$head.sameParent($anchor)) return false;\n  var above = $head.node(-1);\n  var after = $head.indexAfter(-1);\n  var type = above.defaultContentType(after);\n  if (!above.canReplaceWith(after, after, type)) return false;\n\n  if (dispatch) {\n    var pos = $head.before();\n    var tr = state.tr.replaceWith(pos, pos, type.createAndFill());\n    tr.setSelection(Selection.near(tr.doc.resolve(pos), -1));\n    dispatch(tr.scrollIntoView());\n  }\n\n  return true;\n}\n\nfunction deleteEmptyCodeblock(cm) {\n  return function (state, dispatch) {\n    // Todo: It would be nice to have a way to get this without CodeMirror being passed in.\n    var pos = cm.getCursor();\n    var code = cm.getValue();\n    var codeWithoutInvisibles = code.replace(/[ \\r\\n]/g, '');\n    var shouldRemove = !codeWithoutInvisibles;\n\n    if (!(pos.line == 0 && pos.ch == 0 && shouldRemove)) {\n      return false;\n    }\n\n    var $from = state.selection.$from;\n\n    if (dispatch) {\n      // I hate my life\n      dispatch(state.tr // Replace the entire codeblock with an empty paragraph\n      .replaceRangeWith($from.pos - 1, $from.pos + code.length + 1, state.schema.nodes.paragraph.create()) // Set the seleciton to be at the start of the paragram\n      .setSelection(Selection.near(state.doc.resolve($from.pos - 1))));\n    }\n\n    return true;\n  };\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar ssr = typeof navigator == 'undefined';\nvar mac$1 = typeof navigator != 'undefined' ? /*#__PURE__*/ /Mac/.test(navigator.platform) : false;\nvar CodeMirror = null;\n\nif (!ssr) {\n  CodeMirror = /*#__PURE__*/require('codemirror');\n}\n\nvar CodeBlockView = /*#__PURE__*/function () {\n  function CodeBlockView(node, view, getPos) {\n    var _this = this;\n\n    this.node = node;\n    this.view = view;\n    this.getPos = getPos;\n    this.updating = false;\n\n    this.onCursorActivity = function () {\n      if (!_this.updating) {\n        _this.forwardSelection();\n      }\n    };\n    /**\r\n     * When CodeMirror's Selection is changed, a transaction is dispatched to\r\n     * update the ProseMirror editor's Selection.\r\n     */\n\n\n    this.forwardSelection = function () {\n      if (!_this.cm.hasFocus()) return;\n      var state = _this.view.state;\n\n      var selection = _this.asProseMirrorSelection(state.doc);\n\n      if (!selection.eq(state.selection)) {\n        _this.view.dispatch(state.tr.setSelection(selection));\n      }\n    };\n\n    this.onChange = function () {\n      if (!_this.updating) {\n        _this.valueChanged();\n      }\n    };\n\n    if (ssr) return;\n    this.cm = this.setupCodeMirror(node);\n    this.dom = this.cm.getWrapperElement();\n    setTimeout(function () {\n      return _this.cm.refresh();\n    }, 20);\n    this.cm.on('cursorActivity', this.onCursorActivity);\n    this.cm.on('changes', this.onChange);\n    this.cm.on('focus', this.forwardSelection);\n  }\n  /**\r\n   * If the code block is changed, a ProseMirror transaction is dispatched\r\n   * to keep the two editors in sync.\r\n   */\n\n\n  var _proto = CodeBlockView.prototype;\n\n  _proto.valueChanged = function valueChanged() {\n    var change = computeChange(this.node.textContent, this.cm.getValue());\n\n    if (change) {\n      var codeBlockStart = this.getPos() + 1;\n      var schema = this.view.state.schema;\n      var tr = this.view.state.tr.replaceWith(codeBlockStart + change.from, codeBlockStart + change.to, change.text ? schema.text(change.text) : null);\n      this.view.dispatch(tr); // Damn typings :(\n    }\n  }\n  /**\r\n   * Creates a ProseMirror TextSelection based off the CodeMirror selection.\r\n   */\n  ;\n\n  _proto.asProseMirrorSelection = function asProseMirrorSelection(doc) {\n    var offset = this.getPos() + 1;\n    var anchor = this.cm.indexFromPos(this.cm.getCursor('anchor')) + offset;\n    var head = this.cm.indexFromPos(this.cm.getCursor('head')) + offset;\n    return TextSelection.create(doc, anchor, head);\n  }\n  /**\r\n   * Set's the CodeMirror selection given the anchor and head.\r\n   */\n  ;\n\n  _proto.setSelection = function setSelection(anchor, head) {\n    this.cm.focus();\n    this.updating = true;\n    this.cm.setSelection(this.cm.posFromIndex(anchor), this.cm.posFromIndex(head));\n    this.updating = false;\n  }\n  /**\r\n   * Creates a new instance of CodeMirror from a ProseMirror Node\r\n   */\n  ;\n\n  _proto.setupCodeMirror = function setupCodeMirror(node) {\n    return CodeMirror(null, {\n      value: node.textContent,\n      lineNumbers: true,\n      extraKeys: this.codeMirrorKeymap(),\n      mode: node.attrs.params,\n      theme: 'forestry'\n    });\n  }\n  /**\r\n   * Generates a Keymap for the CodeMirror instance.\r\n   */\n  ;\n\n  _proto.codeMirrorKeymap = function codeMirrorKeymap() {\n    var _this2 = this,\n        _CodeMirror$normalize;\n\n    var view = this.view;\n    var mod = mac$1 ? 'Cmd' : 'Ctrl';\n    return CodeMirror.normalizeKeyMap((_CodeMirror$normalize = {\n      Up: function Up() {\n        return _this2.maybeEscape('line', -1);\n      },\n      Left: function Left() {\n        return _this2.maybeEscape('char', -1);\n      },\n      Down: function Down() {\n        return _this2.maybeEscape('line', 1);\n      },\n      Right: function Right() {\n        return _this2.maybeEscape('char', 1);\n      },\n      Backspace: function Backspace() {\n        if (!deleteEmptyCodeblock(_this2.cm)(_this2.view.state, _this2.view.dispatch)) {\n          return CodeMirror.Pass;\n        }\n\n        _this2.view.focus();\n      }\n    }, _CodeMirror$normalize[mod + \"-Z\"] = function Z() {\n      return undo(view.state, view.dispatch);\n    }, _CodeMirror$normalize[\"Shift-\" + mod + \"-Z\"] = function ShiftZ() {\n      return redo(view.state, view.dispatch);\n    }, _CodeMirror$normalize[mod + \"-Shift-Enter\"] = function ShiftEnter() {\n      var pos = _this2.cm.getCursor();\n\n      if (_this2.cm.somethingSelected() || pos.line != _this2.cm.firstLine()) {\n        return CodeMirror.Pass;\n      }\n\n      if (view.state.selection.$anchor.parentOffset) {\n        var _pos = view.state.selection.$anchor.pos;\n        view.dispatch(view.state.tr.setSelection(Selection.near(_this2.view.state.doc.resolve(_pos - 1), -1)));\n      }\n\n      if (exitCodeUp(view.state, view.dispatch)) {\n        view.focus();\n      }\n\n      return true;\n    }, _CodeMirror$normalize['Shift-Enter'] = function ShiftEnter() {\n      var pos = _this2.cm.getCursor();\n\n      if (_this2.cm.somethingSelected() || pos.line != _this2.cm.lastLine()) {\n        return CodeMirror.Pass;\n      }\n\n      if (view.state.selection.$anchor.parentOffset) {\n        var _pos2 = view.state.selection.$anchor.pos;\n        view.dispatch(view.state.tr.setSelection(Selection.near(_this2.view.state.doc.resolve(_pos2 - 1), -1)));\n      }\n\n      if (exitCode(view.state, view.dispatch)) {\n        return view.focus();\n      } else if (exitCodeHard(view.state, view.dispatch)) {\n        return view.focus();\n      }\n    }, _CodeMirror$normalize));\n  };\n\n  _proto.maybeEscape = function maybeEscape(unit, dir) {\n    var pos = this.cm.getCursor();\n\n    if (this.cm.somethingSelected() || pos.line != (dir < 0 ? this.cm.firstLine() : this.cm.lastLine()) || unit == 'char' && pos.ch != (dir < 0 ? 0 : this.cm.getLine(pos.line).length)) {\n      return CodeMirror.Pass;\n    }\n\n    var targetPos = this.getPos() + (dir < 0 ? 0 : this.node.nodeSize);\n    var selection = Selection.near(this.view.state.doc.resolve(targetPos), dir);\n    var atEndOfDocument = !(selection.$from.pos + 1 < this.view.state.doc.content.size);\n\n    if (atEndOfDocument) {\n      return CodeMirror.Pass;\n    }\n\n    this.view.dispatch(this.view.state.tr.setSelection(selection));\n    this.view.focus();\n  }\n  /**\r\n   * When the Prosemirror Node is updated, compute the change between the\r\n   * ProseMirror and CodeMirror. Then update CodeMirror to match ProseMirror.\r\n   */\n  ;\n\n  _proto.update = function update(node) {\n    if (node.type != this.node.type) return false;\n    this.node = node;\n    var change = computeChange(this.cm.getValue(), node.textContent);\n\n    if (change) {\n      this.updating = true;\n      this.cm.replaceRange(change.text, this.cm.posFromIndex(change.from), this.cm.posFromIndex(change.to));\n      this.updating = false;\n    }\n\n    return true;\n  }\n  /**\r\n   * Called by ProseMirror when the CodeView is clicked.\r\n   */\n  ;\n\n  _proto.selectNode = function selectNode() {\n    this.cm.focus();\n  }\n  /**\r\n   * Prevents Events in here from bubbling.\r\n   */\n  ;\n\n  _proto.stopEvent = function stopEvent() {\n    return true;\n  };\n\n  return CodeBlockView;\n}();\n\nfunction computeChange(oldVal, newVal) {\n  if (oldVal == newVal) return null;\n  var start = 0;\n  var oldEnd = oldVal.length;\n  var newEnd = newVal.length;\n\n  while (start < oldEnd && oldVal.charCodeAt(start) == newVal.charCodeAt(start)) {\n    ++start;\n  }\n\n  while (oldEnd > start && newEnd > start && oldVal.charCodeAt(oldEnd - 1) == newVal.charCodeAt(newEnd - 1)) {\n    oldEnd--;\n    newEnd--;\n  }\n\n  return {\n    from: start,\n    to: oldEnd,\n    text: newVal.slice(start, newEnd)\n  };\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar Identity = function Identity(str) {\n  return str;\n};\n\nvar ImageView = /*#__PURE__*/function () {\n  function ImageView(node, view, getPos, previewUrl) {\n    var _this = this;\n\n    if (previewUrl === void 0) {\n      previewUrl = Identity;\n    }\n\n    this.selectNode = function () {\n      if (_this.img) {\n        _this.img.style.outline = '4px solid #0084FF';\n\n        _this.img.classList.add('tina-selected-image');\n      }\n    };\n\n    this.deselectNode = function () {\n      if (_this.img) {\n        _this.img.style.outline = '';\n\n        _this.img.classList.remove('tina-selected-image');\n      }\n    };\n\n    this.destroy = function () {\n      _this.deselectNode();\n    };\n\n    this.node = node;\n    this.view = view;\n    this.getPos = getPos;\n    this.dom = document.createElement('span');\n    this.dom.classList.add('tinacms-image-wrapper');\n    this.img = document.createElement('img');\n    var _node$attrs = node.attrs,\n        src = _node$attrs.src,\n        align = _node$attrs.align,\n        alt = _node$attrs.alt,\n        title = _node$attrs.title,\n        width = _node$attrs.width,\n        height = _node$attrs.height;\n    this.img.src = previewUrl(src);\n    if (height) this.img.style.height = height;\n    if (width) this.img.style.width = width;\n    if (align) this.img.classList.add(\"align-\" + align);\n    if (alt) this.img.alt = alt;\n    if (title) this.img.title = title;\n    this.dom.appendChild(this.img);\n  }\n\n  var _proto = ImageView.prototype;\n\n  _proto.update = function update(node) {\n    if (this.img) {\n      var _node$attrs2 = node.attrs,\n          alt = _node$attrs2.alt,\n          title = _node$attrs2.title;\n      if (alt) this.img.alt = alt;\n      if (title) this.img.title = title;\n    }\n\n    return true;\n  };\n\n  return ImageView;\n}();\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar nodeViews = function nodeViews(previewUrl) {\n  return {\n    code_block: function code_block(node, view, getPos) {\n      return new CodeBlockView(node, view, getPos);\n    },\n    image: function image(node, view, getPos) {\n      return new ImageView(node, view, getPos, previewUrl);\n    }\n  };\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction useProsemirror(input, plugins, format, previewUrl) {\n  if (plugins === void 0) {\n    plugins = [];\n  }\n  /**\r\n   * Construct the Prosemirror Schema\r\n   */\n\n\n  var _useProsemirrorSchema = useProsemirrorSchema(plugins),\n      schema = _useProsemirrorSchema[0];\n  /**\r\n   * Create a MarkdownTranslattor based on the schema\r\n   */\n\n\n  var _useProsemirrorTransl = useProsemirrorTranslator(schema, format),\n      translator = _useProsemirrorTransl[0];\n  /**\r\n   * A reference to the DOM Node where the prosemirror editor will be added.\r\n   */\n\n\n  var _React$useState = useState(),\n      el = _React$useState[0],\n      setEl = _React$useState[1];\n\n  var elRef = useCallback(function (nextEl) {\n    if (nextEl !== el) {\n      setEl(nextEl);\n    }\n  }, []);\n  /**\r\n   * CreateState3\r\n   */\n\n  var createState = useCallback(function (value) {\n    return createEditorState(schema, translator, plugins, value);\n  }, []);\n  /**\r\n   * The Prosemirror EditorView instance\r\n   */\n\n  var _React$useState2 = useState(),\n      editorView = _React$useState2[0],\n      setEditorView = _React$useState2[1];\n\n  useEffect(function setupEditor() {\n    /**\r\n     * Exit early if the target Node has not yet been set.\r\n     */\n    if (!el) {\n      return;\n    }\n    /**\r\n     * Create a new Prosemirror EditorView on in the DOM\r\n     */\n\n\n    var view = new EditorView(el, {\n      nodeViews: nodeViews(previewUrl),\n\n      /**\r\n       * The initial state of the Wysiwyg\r\n       */\n      state: createState(input.value),\n\n      /**\r\n       * Call input.onChange with the translated content after updating\r\n       * the Prosemiror state.\r\n       * @param tr\r\n       */\n      dispatchTransaction: function dispatchTransaction(tr) {\n        var nextState = view.state.apply(tr);\n        view.updateState(nextState);\n        setEditorView({\n          view: view\n        });\n\n        if (tr.docChanged) {\n          input.onChange(translator.stringFromNode(tr.doc));\n        }\n      }\n    });\n    setEditorView({\n      view: view\n    });\n    /**\r\n     * Destroy the EditorView to prevent duplicates\r\n     */\n\n    return function () {\n      setEditorView(undefined);\n      if (editorView) view.destroy();\n    };\n  },\n  /**\r\n   * Rerender if the target Node has changed.\r\n   */\n  [el]);\n  return {\n    elRef: elRef,\n    editorView: editorView,\n    translator: translator\n  };\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n/**\r\n * code\r\n */\n\n\nvar code = {\n  parseDOM: [{\n    tag: 'code'\n  }],\n  toDOM: function toDOM() {\n    return ['code'];\n  }\n};\nvar code$1 = {\n  __type: 'wysiwyg:schema:mark',\n  name: 'code',\n  mark: code\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n/**\r\n * Emphasis\r\n */\n\nvar em = {\n  __type: 'wysiwyg:schema:mark',\n  name: 'em',\n  mark: {\n    parseDOM: [{\n      tag: 'i'\n    }, {\n      tag: 'em'\n    }, {\n      style: 'font-style',\n      getAttrs: function getAttrs(value) {\n        return value === 'italic' && null;\n      }\n    }],\n    toDOM: function toDOM() {\n      return ['em'];\n    }\n  }\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n/**\r\n * Link\r\n */\n\nvar link$1 = {\n  attrs: {\n    href: {},\n    title: {\n      \"default\": null\n    }\n  },\n  inclusive: false,\n  parseDOM: [{\n    tag: 'a[href]',\n    getAttrs: function getAttrs(dom) {\n      return {\n        href: dom.getAttribute('href'),\n        title: dom.getAttribute('title')\n      };\n    }\n  }],\n  toDOM: function toDOM(node) {\n    return ['a', node.attrs];\n  },\n  toDocument: function toDocument(node) {\n    return ['a', node.attrs];\n  }\n};\nvar link$2 = {\n  __type: 'wysiwyg:schema:mark',\n  name: 'link',\n  mark: link$1\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\nvar strong = {\n  __type: 'wysiwyg:schema:mark',\n  name: 'strong',\n  mark: {\n    parseDOM: [{\n      tag: 'strong'\n    }, // This works around a Google Docs misbehavior where\n    // pasted content will be inexplicably wrapped in `<b>`\n    // tags with a font-weight normal.\n    {\n      tag: 'b',\n      getAttrs: function getAttrs(node) {\n        return node.style.fontWeight != 'normal' && null;\n      }\n    }, {\n      style: 'font-weight',\n      getAttrs: function getAttrs(value) {\n        return /^(bold(er)?|[5-9]\\d{2,})$/.test(value) && null;\n      }\n    }],\n    toDOM: function toDOM() {\n      return ['strong'];\n    }\n  }\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n/**\r\n * text\r\n */\n\nvar doc = {\n  content: 'block+'\n};\nvar doc$1 = {\n  __type: 'wysiwyg:schema:node',\n  name: 'doc',\n  node: doc\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\nvar blockquote = {\n  content: 'block+',\n  group: 'block',\n  defining: true,\n  parseDOM: [{\n    tag: 'blockquote'\n  }],\n  toDOM: function toDOM() {\n    return ['blockquote', 0];\n  }\n};\nvar blockquote$1 = {\n  __type: 'wysiwyg:schema:node',\n  name: 'blockquote',\n  node: blockquote\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n/**\r\n * bullet_list\r\n */\n\nvar bullet_list = {\n  content: 'list_item+',\n  group: 'block',\n  attrs: {\n    tight: {\n      \"default\": false\n    }\n  },\n  parseDOM: [{\n    tag: 'ul',\n    getAttrs: function getAttrs(dom) {\n      return {\n        tight: dom.hasAttribute('data-tight')\n      };\n    }\n  }],\n  toDOM: function toDOM(node) {\n    return ['ul', {\n      'data-tight': node.attrs.tight ? 'true' : null\n    }, 0];\n  }\n};\nvar bullet_list$1 = {\n  __type: 'wysiwyg:schema:node',\n  name: 'bullet_list',\n  node: bullet_list\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n/**\r\n * code_block\r\n */\n\nvar code_block = {\n  content: 'text*',\n  attrs: {\n    params: {\n      \"default\": ''\n    }\n  },\n  group: 'block',\n  code: true,\n  defining: true,\n  parseDOM: [{\n    tag: 'pre',\n    preserveWhitespace: 'full'\n  }],\n  toDOM: function toDOM() {\n    return ['pre', ['code', 0]];\n  }\n};\nvar code_block$1 = {\n  __type: 'wysiwyg:schema:node',\n  name: 'code_block',\n  node: code_block\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n/**\r\n * hard_break\r\n */\n\nvar hard_break = {\n  inline: true,\n  group: 'inline',\n  selectable: false,\n  parseDOM: [{\n    tag: 'br'\n  }],\n  toDOM: function toDOM() {\n    return ['br'];\n  }\n};\nvar hard_break$1 = {\n  __type: 'wysiwyg:schema:node',\n  name: 'hard_break',\n  node: hard_break\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\nfunction domAttrs(attrs) {\n  var domAttrs = {};\n\n  for (var key in attrs) {\n    if (attrs[key]) {\n      domAttrs[\"forestry-\" + key] = attrs[key];\n    }\n  }\n\n  return domAttrs;\n}\n\nfunction docAttrs(attrs) {\n  var domAttrs = {};\n\n  for (var key in attrs) {\n    if (attrs[key]) {\n      domAttrs[key] = attrs[key];\n    }\n  }\n\n  return domAttrs;\n}\n\nfunction getAttrsWith(attrs) {\n  return function (dom) {\n    return _extends({}, attrs, {}, getAttrs(dom));\n  };\n}\n\nfunction getAttrs(dom) {\n  var attrs = {};\n  var attributes = dom.attributes;\n\n  for (var i = 0; i < attributes.length; i++) {\n    var attribute = attributes[i];\n\n    if (attribute.value) {\n      var name = attribute.name.startsWith('forestry-') ? attribute.name.slice(9) : attribute.name;\n      attrs[name] = attribute.value;\n    }\n  }\n\n  return attrs;\n}\n/**\r\n * heading\r\n */\n\n\nvar heading = {\n  attrs: {\n    level: {\n      \"default\": 1\n    },\n    \"class\": {\n      \"default\": ''\n    },\n    id: {\n      \"default\": ''\n    }\n  },\n  content: 'inline*',\n  marks: '_',\n  group: 'block',\n  defining: true,\n  parseDOM: [{\n    tag: 'h1',\n    getAttrs: /*#__PURE__*/getAttrsWith({\n      level: 1\n    })\n  }, {\n    tag: 'h2',\n    getAttrs: /*#__PURE__*/getAttrsWith({\n      level: 2\n    })\n  }, {\n    tag: 'h3',\n    getAttrs: /*#__PURE__*/getAttrsWith({\n      level: 3\n    })\n  }, {\n    tag: 'h4',\n    getAttrs: /*#__PURE__*/getAttrsWith({\n      level: 4\n    })\n  }, {\n    tag: 'h5',\n    getAttrs: /*#__PURE__*/getAttrsWith({\n      level: 5\n    })\n  }, {\n    tag: 'h6',\n    getAttrs: /*#__PURE__*/getAttrsWith({\n      level: 6\n    })\n  }],\n  toDocument: function toDocument(node) {\n    var _node$attrs = node.attrs,\n        level = _node$attrs.level,\n        other = _objectWithoutPropertiesLoose(_node$attrs, [\"level\"]);\n\n    return ['h' + level, docAttrs(other), 0];\n  },\n  toDOM: function toDOM(node) {\n    var _node$attrs2 = node.attrs,\n        level = _node$attrs2.level,\n        other = _objectWithoutPropertiesLoose(_node$attrs2, [\"level\"]);\n\n    return ['h' + level, domAttrs(other), 0];\n  }\n};\nvar heading$1 = {\n  __type: 'wysiwyg:schema:node',\n  name: 'heading',\n  node: heading\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n/**\r\n * horizontal_rule\r\n */\n\nvar horizontal_rule = {\n  group: 'block',\n  allowGapCursor: true,\n  parseDOM: [{\n    tag: 'hr'\n  }],\n  toDOM: function toDOM() {\n    return ['hr'];\n  }\n};\nvar horizontal_rule$1 = {\n  __type: 'wysiwyg:schema:node',\n  name: 'horizontal_rule',\n  node: horizontal_rule\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\nvar image = {\n  inline: true,\n  attrs: {\n    src: {},\n    align: {\n      \"default\": null\n    },\n    alt: {\n      \"default\": null\n    },\n    title: {\n      \"default\": null\n    },\n    width: {\n      \"default\": null\n    },\n    height: {\n      \"default\": null\n    }\n  },\n  group: 'inline',\n  draggable: true,\n  allowGapCursor: true,\n  parseDOM: [{\n    tag: 'img[src]',\n    getAttrs: function getAttrs(dom) {\n      return {\n        src: dom.getAttribute('src'),\n        title: dom.getAttribute('title'),\n        alt: dom.getAttribute('alt'),\n        align: getAlignFromDOM(dom),\n        width: dom.getAttribute('width'),\n        height: dom.getAttribute('height')\n      };\n    }\n  }],\n  toDOM: function toDOM(node) {\n    var attrs = {\n      src: node.attrs.src\n    };\n    if (node.attrs.title) attrs.title = node.attrs.title;\n    if (node.attrs.alt) attrs.alt = node.attrs.alt;\n    if (node.attrs.width) attrs.width = node.attrs.width;\n    if (node.attrs.height) attrs.height = node.attrs.height;\n    if (node.attrs.align) attrs['class'] = \"align-\" + node.attrs.align;\n    return ['img', attrs];\n  }\n};\nvar alignRegex = /align-([a-z]*)/;\n\nfunction getAlignFromDOM(image) {\n  var className = image.getAttribute('class') || '';\n  var match = alignRegex.exec(className);\n\n  if (match && match.length > 1) {\n    return match[1];\n  }\n\n  return null;\n}\n\nvar image$1 = {\n  __type: 'wysiwyg:schema:node',\n  name: 'image',\n  node: image\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n/**\r\n * list_item\r\n */\n\nvar list_item = {\n  content: 'paragraph block*',\n  defining: true,\n  parseDOM: [{\n    tag: 'li'\n  }],\n  toDOM: function toDOM() {\n    return ['li', 0];\n  }\n};\nvar list_item$1 = {\n  __type: 'wysiwyg:schema:node',\n  name: 'list_item',\n  node: list_item\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n/**\r\n * Ordered List\r\n */\n\nvar ordered_list = {\n  content: 'list_item+',\n  group: 'block',\n  attrs: {\n    order: {\n      \"default\": 1\n    },\n    tight: {\n      \"default\": false\n    }\n  },\n  parseDOM: [{\n    tag: 'ol',\n    getAttrs: function getAttrs(dom) {\n      return {\n        order: dom.hasAttribute('start') ? +(dom.getAttribute('start') || 0) : 1,\n        tight: dom.hasAttribute('data-tight')\n      };\n    }\n  }],\n  toDOM: function toDOM(node) {\n    return ['ol', {\n      start: node.attrs.order == 1 ? null : node.attrs.order,\n      'data-tight': node.attrs.tight ? 'true' : null\n    }, 0];\n  }\n};\nvar ordered_list$1 = {\n  __type: 'wysiwyg:schema:node',\n  name: 'ordered_list',\n  node: ordered_list\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\nvar paragraph = {\n  content: 'inline*',\n  marks: '_',\n  attrs: {\n    \"class\": {\n      \"default\": ''\n    },\n    id: {\n      \"default\": ''\n    }\n  },\n  group: 'block',\n  parseDOM: [{\n    tag: 'p',\n    getAttrs: getAttrs\n  }],\n  toDocument: function toDocument(node) {\n    return ['p', docAttrs(node.attrs), 0];\n  },\n  toDOM: function toDOM(node) {\n    return ['p', domAttrs(node.attrs), 0];\n  }\n};\nvar paragraph$1 = {\n  __type: 'wysiwyg:schema:node',\n  name: 'paragraph',\n  node: paragraph\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n/**\r\n * text\r\n */\n\nvar text = {\n  group: 'inline'\n};\nvar text$1 = {\n  __type: 'wysiwyg:schema:node',\n  name: 'text',\n  node: text\n};\nvar tables = /*#__PURE__*/tableNodes({\n  tableGroup: 'block',\n  cellContent: 'inline*',\n  cellAttributes: {}\n});\ntables.table_cell = /*#__PURE__*/_extends({}, tables.table_cell, {\n  marks: '_',\n  attrs: /*#__PURE__*/_extends({}, tables.table_cell.attrs, {\n    align: {\n      \"default\": null\n    }\n  }),\n  toDOM: function toDOM(node) {\n    var attrs = {};\n\n    if (node.attrs.align) {\n      attrs.style = \"text-align: \" + node.attrs.align + \";\";\n    }\n\n    return ['td', attrs, 0];\n  }\n});\ntables.table_header = /*#__PURE__*/_extends({}, tables.table_header, {\n  marks: '_',\n  attrs: /*#__PURE__*/_extends({}, tables.table_header.attrs, {\n    align: {\n      \"default\": null\n    }\n  }),\n  toDOM: function toDOM(node) {\n    var attrs = {};\n\n    if (node.attrs.align) {\n      attrs.style = \"text-align: \" + node.attrs.align + \";\";\n    }\n\n    return ['th', attrs, 0];\n  }\n});\nvar plugins = /*#__PURE__*/Object.keys(tables).map(function (name) {\n  return {\n    __type: 'wysiwyg:schema:node',\n    name: name,\n    node: tables[name]\n  };\n});\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\nfunction insertImage(state, dispatch, src) {\n  var nodeType = state.schema.nodes['image'];\n  var image = nodeType.createAndFill({\n    src: src,\n    alt: '',\n    title: ''\n  });\n\n  if (dispatch) {\n    dispatch(state.tr.replaceSelectionWith(image));\n  }\n\n  return true;\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction markExtend($cursor, markType) {\n  window.$cursor = $cursor;\n  var startIndex = $cursor.index();\n  var endIndex = $cursor.indexAfter(); // Clicked outside edge of tag.\n\n  if (startIndex === $cursor.parent.childCount) {\n    startIndex--;\n    endIndex--;\n  }\n\n  var mark = markType.isInSet($cursor.parent.child(startIndex).marks);\n  if (!mark) return; // TODO: This might be a problem.\n\n  var hasMark = function hasMark(index) {\n    return mark.isInSet($cursor.parent.child(index).marks);\n  };\n\n  while (startIndex > 0 && hasMark(startIndex - 1)) {\n    startIndex--;\n  }\n\n  while (endIndex < $cursor.parent.childCount && hasMark(endIndex)) {\n    endIndex++;\n  }\n\n  var startPos = $cursor.start();\n  var endPos = startPos;\n\n  for (var i = 0; i < endIndex; i++) {\n    var size = $cursor.parent.child(i).nodeSize;\n    if (i < startIndex) startPos += size;\n    endPos += size;\n  }\n\n  return {\n    from: startPos,\n    to: endPos,\n    mark: mark\n  };\n}\n\nfunction unmountLinkForm(view) {\n  var dispatch = view.dispatch,\n      state = view.state;\n  dispatch(state.tr.setMeta('show_link_toolbar', false));\n}\n/**\r\n * Finds the Link currently being edited and sets it's attributes.\r\n *\r\n * @param {EditorState} state\r\n * @param {(tr: Transaction) => void} dispatch\r\n * @param {Object} attrs\r\n */\n\n\nfunction updateLinkBeingEdited(state, dispatch, attrs) {\n  if (dispatch) {\n    var selection = state.selection,\n        schema = state.schema,\n        tr = state.tr;\n    var mark = markExtend(selection.$anchor, schema.marks.link);\n\n    if (mark) {\n      tr.addMark(mark.from, mark.to, schema.marks.link.create(attrs));\n    }\n\n    tr.setMeta('show_link_toolbar', false);\n    dispatch(tr);\n  }\n\n  return true;\n}\n\nfunction removeLinkBeingEdited(state, dispatch) {\n  if (dispatch) {\n    var selection = state.selection,\n        schema = state.schema,\n        tr = state.tr;\n    var mark = markExtend(selection.$anchor, schema.marks.link);\n\n    if (mark) {\n      tr.removeMark(mark.from, mark.to, mark.mark);\n    }\n\n    tr.setMeta('show_link_toolbar', false);\n    dispatch(tr);\n  }\n\n  return true;\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction insertHr(state, dispatch) {\n  var type = state.schema.nodes.horizontal_rule;\n\n  if (dispatch) {\n    dispatch(state.tr.replaceSelectionWith(type.create()).scrollIntoView());\n  }\n\n  return true;\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction liftBlockquote(state, dispatch) {\n  var range = getRangeForType(state, state.schema.nodes.blockquote);\n  if (!range) return false;\n  var target = liftTarget(range);\n  if (!target) return false;\n\n  if (dispatch) {\n    dispatch(state.tr.lift(range, target)); //dont lift lists\n  }\n\n  return true;\n}\n\nvar getRangeForType = function getRangeForType(state, listType) {\n  var _state$selection = state.selection,\n      $from = _state$selection.$from,\n      $to = _state$selection.$to;\n  var range = $from.blockRange($to, function (node) {\n    return node.type == listType;\n  });\n  return range;\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction toggleBulletList(state, dispatch) {\n  var lift = liftListItem(state.schema.nodes.list_item);\n  var wrap = wrapInList(state.schema.nodes.bullet_list);\n  var canDo = wrap(state, dispatch) || lift(state, dispatch);\n  return canDo;\n}\n\nfunction toggleOrderedList(state, dispatch) {\n  var lift = liftListItem(state.schema.nodes.list_item);\n  var wrap = wrapInList(state.schema.nodes.ordered_list);\n  return wrap(state, dispatch) || lift(state, dispatch);\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nfunction deleteEmptyHeading(state, dispatch) {\n  var $cursor = state.selection.$cursor;\n  if (!$cursor) return false;\n  var node = state.doc.nodeAt(Math.max($cursor.pos - 1, 0));\n  if (!node) return false;\n  if (node.type != state.schema.nodes.heading) return false;\n  if (node.textContent.length) return false;\n\n  if (dispatch) {\n    var tr = state.tr;\n    dispatch(tr // Replace the entire heading with an empty paragraph\n    .replaceRangeWith($cursor.pos - 1, $cursor.pos + node.nodeSize - 1, state.schema.nodes.paragraph.create()) // Set the selection to be at the start of the paragraph\n    .setSelection(new TextSelection(tr.doc.resolve(state.selection.head))).scrollIntoView());\n  }\n\n  return true;\n}\n\nfunction toggleHeader(nodeType, attrs, fallBackNodeType, fallbackAttrs) {\n  return function (state, dispatch) {\n    var _state$selection = state.selection,\n        from = _state$selection.from,\n        to = _state$selection.to;\n    var firstTextblock = null;\n    var firstPos = -1; // Find the first textblock\n\n    state.doc.nodesBetween(from, to, function (node, pos) {\n      if (firstTextblock) return false;\n\n      if (node.isTextblock) {\n        firstTextblock = node;\n        firstPos = pos;\n      }\n\n      return true;\n    });\n    if (!firstTextblock || firstPos < 0) return false;\n    var $firstPos = state.doc.resolve(firstPos);\n    var index = $firstPos.index();\n    var setAsParagraph = state.selection.$head.parent.attrs.level == attrs.level;\n    var nextNodeType = setAsParagraph ? fallBackNodeType : nodeType;\n    var nextAttrs = setAsParagraph ? fallbackAttrs : attrs;\n    if (!$firstPos.parent.canReplaceWith(index, index + 1, nextNodeType)) return false;\n\n    if (dispatch) {\n      dispatch(state.tr.setBlockType(from, to, nextNodeType, nextAttrs).scrollIntoView());\n    }\n\n    return true;\n  };\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar hardBreakCmd = function hardBreakCmd(schema) {\n  var br = schema.nodes.hard_break;\n  return chainCommands(exitCode, function (state, dispatch) {\n    dispatch(state.tr.replaceSelectionWith(br.create()).scrollIntoView());\n    return true;\n  });\n};\n\nvar headingCmd = function headingCmd(level) {\n  return function (schema) {\n    var heading = schema.nodes.heading;\n    return toggleHeader(heading, {\n      level: level\n    }, schema.nodes.paragraph, null);\n  };\n};\n\nvar KEYMAP_PLUGINS = [{\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-z',\n  command: function command() {\n    return undo;\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Backspace',\n  command: function command() {\n    return undoInputRule;\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-Shift-z',\n  command: function command() {\n    return redo;\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-y',\n  command: function command() {\n    return redo;\n  },\n  unlessMac: true\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Tab',\n  command: function command() {\n    return tab;\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Shift-Tab',\n  command: function command() {\n    return shiftTab;\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-b',\n  ifMark: 'strong',\n  command: function command(schema) {\n    return toggleMark(schema.marks.strong);\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-i',\n  ifMark: 'em',\n  command: function command(schema) {\n    return toggleMark(schema.marks.em);\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-k',\n  ifMark: 'link',\n  command: function command(schema) {\n    var toggleLink = toggleMark(schema.marks.link, {\n      href: '',\n      title: ''\n    });\n    return function (state, dispatch) {\n      if (!state.selection.$cursor) {\n        return toggleLink(state, dispatch);\n      }\n\n      return false;\n    };\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-Enter',\n  command: hardBreakCmd,\n  ifNode: 'hard_break'\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Shift-Enter',\n  command: hardBreakCmd,\n  ifNode: 'hard_break'\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Ctrl-Enter',\n  command: hardBreakCmd,\n  ifNode: 'hard_break',\n  ifMac: true\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-Alt-1',\n  command: /*#__PURE__*/headingCmd(1),\n  ifNode: 'heading'\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-Alt-2',\n  command: /*#__PURE__*/headingCmd(2),\n  ifNode: 'heading'\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-Alt-3',\n  command: /*#__PURE__*/headingCmd(3),\n  ifNode: 'heading'\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-Alt-4',\n  command: /*#__PURE__*/headingCmd(4),\n  ifNode: 'heading'\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-Alt-5',\n  command: /*#__PURE__*/headingCmd(5),\n  ifNode: 'heading'\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-Alt-6',\n  command: /*#__PURE__*/headingCmd(6),\n  ifNode: 'heading'\n}, {\n  // TODO: NOT WORKING\n  __type: 'wysiwyg:keymap',\n  name: 'Backspace',\n  command: function command() {\n    return deleteEmptyHeading;\n  },\n  ifNode: 'heading'\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-Alt-7',\n  command: function command() {\n    return toggleOrderedList;\n  },\n  ifNode: 'ordered_list'\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-Alt-8',\n  command: function command() {\n    return toggleBulletList;\n  },\n  ifNode: 'bullet_list'\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-Alt-9',\n  command: function command(schema) {\n    return liftListItem(schema.nodes.list_item);\n  },\n  onCondition: function onCondition(schema) {\n    return !!(schema.nodes.bullet_list || schema.nodes.ordered_list);\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-Alt-0',\n  command: function command(schema) {\n    return setBlockType(schema.nodes.code_block);\n  },\n  ifNode: 'code_block'\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'ArrowLeft',\n  command: function command() {\n    return arrowHandler('left');\n  },\n  ifNodes: ['code_block', 'table']\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'ArrowRight',\n  command: function command() {\n    return arrowHandler('right');\n  },\n  ifNodes: ['code_block', 'table']\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'ArrowUp',\n  command: function command() {\n    return arrowHandler('up');\n  },\n  ifNodes: ['code_block', 'table']\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'ArrowDown',\n  command: function command() {\n    return arrowHandler('down');\n  },\n  ifNodes: ['code_block', 'table']\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-0',\n  ifMark: 'code',\n  command: function command(schema) {\n    return toggleMark(schema.marks.code);\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod->',\n  ifNode: 'blockquote',\n  command: function command(schema) {\n    return wrapIn(schema.nodes.blockquote);\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-<',\n  ifNode: 'blockquote',\n  command: function command() {\n    return liftBlockquote;\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-Alt-9',\n  ifNode: 'paragraph',\n  command: function command(schema) {\n    return setBlockType(schema.nodes.paragraph);\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Shift-Ctrl-0',\n  ifNode: 'paragraph',\n  command: function command(schema) {\n    return setBlockType(schema.nodes.paragraph);\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Mod-Enter',\n  ifNode: 'horizontal_rule',\n  command: function command() {\n    return insertHr;\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Enter',\n  ifNode: 'list_item',\n  command: function command(schema) {\n    return splitListItem(schema.nodes.list_item);\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Tab',\n  ifNode: 'list_item',\n  command: function command(schema) {\n    return sinkListItem(schema.nodes.list_item);\n  }\n}, {\n  __type: 'wysiwyg:keymap',\n  name: 'Shift-Tab',\n  ifNode: 'list_item',\n  command: function command(schema) {\n    return liftListItem(schema.nodes.list_item);\n  }\n}];\n\nfunction arrowHandler(dir) {\n  return function (state, dispatch, view) {\n    if (view.endOfTextblock(dir)) {\n      var side = dir == 'left' || dir == 'up' ? -1 : 1;\n      var $head = state.selection.$head;\n      var nextPos = Selection.near(state.doc.resolve(side > 0 ? $head.after() : $head.before()), side);\n\n      if (nextPos.$head) {\n        var name = nextPos.$head.parent.type.name;\n\n        if (name == 'code_block' || name === 'table_header' || name === 'table_cell') {\n          dispatch(state.tr.setSelection(nextPos));\n          return true;\n        }\n      }\n    }\n\n    return false;\n  };\n}\n\nvar tab = /*#__PURE__*/goToCell(1);\nvar shiftTab = /*#__PURE__*/goToCell(-1);\n\nfunction goToCell(dir) {\n  return function (state, dispatch) {\n    var table = state.schema.nodes.table;\n    var parentTable = findParentNodeOfType(table)(state.selection);\n\n    if (parentTable) {\n      goToNextCell(1 * dir)(state, dispatch);\n      return true;\n    }\n\n    return false;\n  };\n}\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar MARK_PLUGINS = [code$1, em, link$2, strong];\nvar NODE_PLUGINS = /*#__PURE__*/[doc$1, paragraph$1, blockquote$1, bullet_list$1, code_block$1, hard_break$1, heading$1, horizontal_rule$1, image$1, list_item$1, ordered_list$1, text$1].concat(plugins); // all\n\nvar ALL_PLUGINS = /*#__PURE__*/[].concat(MARK_PLUGINS, NODE_PLUGINS, KEYMAP_PLUGINS);\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  white-space: pre-wrap;\\n\\n  .CodeMirror {\\n    font-family: monospace;\\n    height: auto;\\n    width: 100%;\\n    border-radius: 5px;\\n    margin-bottom: 16px;\\n    color: black;\\n    direction: ltr;\\n  }\\n\\n  .CodeMirror-lines {\\n    padding: 4px 0; /* Vertical padding around content */\\n  }\\n  .CodeMirror pre.CodeMirror-line,\\n  .CodeMirror pre.CodeMirror-line-like {\\n    padding: 0 4px; /* Horizontal padding of content */\\n  }\\n\\n  .CodeMirror-scrollbar-filler,\\n  .CodeMirror-gutter-filler {\\n    background-color: white; /* The little square between H and V scrollbars */\\n  }\\n\\n  /* GUTTER */\\n\\n  .CodeMirror-gutters {\\n    border-right: 1px solid #ddd;\\n    background-color: #f7f7f7;\\n    white-space: nowrap;\\n  }\\n  .CodeMirror-linenumbers {\\n  }\\n  .CodeMirror-linenumber {\\n    padding: 0 3px 0 5px;\\n    min-width: 20px;\\n    text-align: right;\\n    color: #999;\\n    white-space: nowrap;\\n  }\\n\\n  .CodeMirror-guttermarker {\\n    color: black;\\n  }\\n  .CodeMirror-guttermarker-subtle {\\n    color: #999;\\n  }\\n\\n  /* CURSOR */\\n\\n  .CodeMirror-cursor {\\n    border-left: 1px solid black;\\n    border-right: none;\\n    width: 0;\\n  }\\n  /* Shown when moving in bi-directional text */\\n  .CodeMirror div.CodeMirror-secondarycursor {\\n    border-left: 1px solid silver;\\n  }\\n  .cm-fat-cursor .CodeMirror-cursor {\\n    width: auto;\\n    border: 0 !important;\\n    background: #7e7;\\n  }\\n  .cm-fat-cursor div.CodeMirror-cursors {\\n    z-index: 1;\\n  }\\n  .cm-fat-cursor-mark {\\n    background-color: rgba(20, 255, 20, 0.5);\\n    -webkit-animation: blink 1.06s steps(1) infinite;\\n    -moz-animation: blink 1.06s steps(1) infinite;\\n    animation: blink 1.06s steps(1) infinite;\\n  }\\n  .cm-animate-fat-cursor {\\n    width: auto;\\n    border: 0;\\n    -webkit-animation: blink 1.06s steps(1) infinite;\\n    -moz-animation: blink 1.06s steps(1) infinite;\\n    animation: blink 1.06s steps(1) infinite;\\n    background-color: #7e7;\\n  }\\n  @-moz-keyframes blink {\\n    0% {\\n    }\\n    50% {\\n      background-color: transparent;\\n    }\\n    100% {\\n    }\\n  }\\n  @-webkit-keyframes blink {\\n    0% {\\n    }\\n    50% {\\n      background-color: transparent;\\n    }\\n    100% {\\n    }\\n  }\\n  @keyframes blink {\\n    0% {\\n    }\\n    50% {\\n      background-color: transparent;\\n    }\\n    100% {\\n    }\\n  }\\n\\n  /* Can style cursor different in overwrite (non-insert) mode */\\n  .CodeMirror-overwrite .CodeMirror-cursor {\\n  }\\n\\n  .cm-tab {\\n    display: inline-block;\\n    text-decoration: inherit;\\n  }\\n\\n  .CodeMirror-rulers {\\n    position: absolute;\\n    left: 0;\\n    right: 0;\\n    top: -50px;\\n    bottom: 0;\\n    overflow: hidden;\\n  }\\n  .CodeMirror-ruler {\\n    border-left: 1px solid #ccc;\\n    top: 0;\\n    bottom: 0;\\n    position: absolute;\\n  }\\n\\n  /* DEFAULT THEME */\\n\\n  .cm-s-default .cm-header {\\n    color: blue;\\n  }\\n  .cm-s-default .cm-quote {\\n    color: #090;\\n  }\\n  .cm-negative {\\n    color: #d44;\\n  }\\n  .cm-positive {\\n    color: #292;\\n  }\\n  .cm-header,\\n  .cm-strong {\\n    font-weight: bold;\\n  }\\n  .cm-em {\\n    font-style: italic;\\n  }\\n  .cm-link {\\n    text-decoration: underline;\\n  }\\n  .cm-strikethrough {\\n    text-decoration: line-through;\\n  }\\n\\n  .cm-s-default .cm-keyword {\\n    color: #708;\\n  }\\n  .cm-s-default .cm-atom {\\n    color: #219;\\n  }\\n  .cm-s-default .cm-number {\\n    color: #164;\\n  }\\n  .cm-s-default .cm-def {\\n    color: #00f;\\n  }\\n  .cm-s-default .cm-variable,\\n  .cm-s-default .cm-punctuation,\\n  .cm-s-default .cm-property,\\n  .cm-s-default .cm-operator {\\n  }\\n  .cm-s-default .cm-variable-2 {\\n    color: #05a;\\n  }\\n  .cm-s-default .cm-variable-3,\\n  .cm-s-default .cm-type {\\n    color: #085;\\n  }\\n  .cm-s-default .cm-comment {\\n    color: #a50;\\n  }\\n  .cm-s-default .cm-string {\\n    color: #a11;\\n  }\\n  .cm-s-default .cm-string-2 {\\n    color: #f50;\\n  }\\n  .cm-s-default .cm-meta {\\n    color: #555;\\n  }\\n  .cm-s-default .cm-qualifier {\\n    color: #555;\\n  }\\n  .cm-s-default .cm-builtin {\\n    color: #30a;\\n  }\\n  .cm-s-default .cm-bracket {\\n    color: #997;\\n  }\\n  .cm-s-default .cm-tag {\\n    color: #170;\\n  }\\n  .cm-s-default .cm-attribute {\\n    color: #00c;\\n  }\\n  .cm-s-default .cm-hr {\\n    color: #999;\\n  }\\n  .cm-s-default .cm-link {\\n    color: #00c;\\n  }\\n\\n  .cm-s-default .cm-error {\\n    color: #f00;\\n  }\\n  .cm-invalidchar {\\n    color: #f00;\\n  }\\n\\n  .CodeMirror-composing {\\n    border-bottom: 2px solid;\\n  }\\n\\n  /* Default styles for common addons */\\n\\n  div.CodeMirror span.CodeMirror-matchingbracket {\\n    color: #0b0;\\n  }\\n  div.CodeMirror span.CodeMirror-nonmatchingbracket {\\n    color: #a22;\\n  }\\n  .CodeMirror-matchingtag {\\n    background: rgba(255, 150, 0, 0.3);\\n  }\\n  .CodeMirror-activeline-background {\\n    background: #e8f2ff;\\n  }\\n\\n  /* STOP */\\n\\n  /* The rest of this file contains styles related to the mechanics of\\n    the editor. You probably shouldn't touch them. */\\n\\n  .CodeMirror {\\n    position: relative;\\n    overflow: hidden;\\n    background: white;\\n  }\\n\\n  .CodeMirror-scroll {\\n    overflow: scroll !important; /* Things will break if this is overridden */\\n    /* 30px is the magic margin used to hide the element's real scrollbars */\\n    /* See overflow: hidden in .CodeMirror */\\n    margin-bottom: -30px;\\n    margin-right: -30px;\\n    padding-bottom: 30px;\\n    height: 100%;\\n    outline: none; /* Prevent dragging from highlighting the element */\\n    position: relative;\\n  }\\n  .CodeMirror-sizer {\\n    position: relative;\\n    min-height: auto;\\n    border-right: 30px solid transparent;\\n  }\\n\\n  /* The fake, visible scrollbars. Used to force redraw during scrolling\\n    before actual scrolling happens, thus preventing shaking and\\n    flickering artifacts. */\\n  .CodeMirror-vscrollbar,\\n  .CodeMirror-hscrollbar,\\n  .CodeMirror-scrollbar-filler,\\n  .CodeMirror-gutter-filler {\\n    position: absolute;\\n    z-index: 6;\\n    display: none;\\n  }\\n  .CodeMirror-vscrollbar {\\n    right: 0;\\n    top: 0;\\n    overflow-x: hidden;\\n    overflow-y: scroll;\\n  }\\n  .CodeMirror-hscrollbar {\\n    bottom: 0;\\n    left: 0;\\n    overflow-y: hidden;\\n    overflow-x: scroll;\\n  }\\n  .CodeMirror-scrollbar-filler {\\n    right: 0;\\n    bottom: 0;\\n  }\\n  .CodeMirror-gutter-filler {\\n    left: 0;\\n    bottom: 0;\\n  }\\n\\n  .CodeMirror-gutters {\\n    position: absolute;\\n    left: 0;\\n    top: 0;\\n    min-height: 100%;\\n    z-index: 3;\\n  }\\n  .CodeMirror-gutter {\\n    white-space: normal;\\n    height: 100%;\\n    display: inline-block;\\n    vertical-align: top;\\n    margin-bottom: -30px;\\n  }\\n  .CodeMirror-gutter-wrapper {\\n    position: absolute;\\n    z-index: 4;\\n    background: none !important;\\n    border: none !important;\\n  }\\n  .CodeMirror-gutter-background {\\n    position: absolute;\\n    top: 0;\\n    bottom: 0;\\n    z-index: 4;\\n  }\\n  .CodeMirror-gutter-elt {\\n    position: absolute;\\n    cursor: default;\\n    z-index: 4;\\n  }\\n  .CodeMirror-gutter-wrapper ::selection {\\n    background-color: transparent;\\n  }\\n  .CodeMirror-gutter-wrapper ::-moz-selection {\\n    background-color: transparent;\\n  }\\n\\n  .CodeMirror-lines {\\n    cursor: text;\\n    min-height: 1px; /* prevents collapsing before first draw */\\n  }\\n  .CodeMirror pre.CodeMirror-line,\\n  .CodeMirror pre.CodeMirror-line-like {\\n    /* Reset some styles that the rest of the page might have set */\\n    -moz-border-radius: 0;\\n    -webkit-border-radius: 0;\\n    border-radius: 0;\\n    border-width: 0;\\n    background: transparent;\\n    font-family: inherit;\\n    font-size: inherit;\\n    margin: 0;\\n    white-space: pre;\\n    word-wrap: normal;\\n    line-height: inherit;\\n    color: inherit;\\n    z-index: 2;\\n    position: relative;\\n    overflow: visible;\\n    -webkit-tap-highlight-color: transparent;\\n    -webkit-font-variant-ligatures: contextual;\\n    font-variant-ligatures: contextual;\\n  }\\n  .CodeMirror-wrap pre.CodeMirror-line,\\n  .CodeMirror-wrap pre.CodeMirror-line-like {\\n    word-wrap: break-word;\\n    white-space: pre-wrap;\\n    word-break: normal;\\n  }\\n\\n  .CodeMirror-linebackground {\\n    position: absolute;\\n    left: 0;\\n    right: 0;\\n    top: 0;\\n    bottom: 0;\\n    z-index: 0;\\n  }\\n\\n  .CodeMirror-linewidget {\\n    position: relative;\\n    z-index: 2;\\n    padding: 0.1px; /* Force widget margins to stay inside of the container */\\n  }\\n\\n  .CodeMirror-widget {\\n  }\\n\\n  .CodeMirror-rtl pre {\\n    direction: rtl;\\n  }\\n\\n  .CodeMirror-code {\\n    outline: none;\\n  }\\n\\n  /* Force content-box sizing for the elements where we expect it */\\n  .CodeMirror-scroll,\\n  .CodeMirror-sizer,\\n  .CodeMirror-gutter,\\n  .CodeMirror-gutters,\\n  .CodeMirror-linenumber {\\n    -moz-box-sizing: content-box;\\n    box-sizing: content-box;\\n  }\\n\\n  .CodeMirror-measure {\\n    position: absolute;\\n    width: 100%;\\n    height: 0;\\n    overflow: hidden;\\n    visibility: hidden;\\n  }\\n\\n  .CodeMirror-cursor {\\n    position: absolute;\\n    pointer-events: none;\\n  }\\n  .CodeMirror-measure pre {\\n    position: static;\\n  }\\n\\n  div.CodeMirror-cursors {\\n    visibility: hidden;\\n    position: relative;\\n    z-index: 3;\\n  }\\n  div.CodeMirror-dragcursors {\\n    visibility: visible;\\n  }\\n\\n  .CodeMirror-focused div.CodeMirror-cursors {\\n    visibility: visible;\\n  }\\n\\n  .CodeMirror-selected {\\n    background: #d9d9d9;\\n  }\\n  .CodeMirror-focused .CodeMirror-selected {\\n    background: #d7d4f0;\\n  }\\n  .CodeMirror-crosshair {\\n    cursor: crosshair;\\n  }\\n  .CodeMirror-line::selection,\\n  .CodeMirror-line > span::selection,\\n  .CodeMirror-line > span > span::selection {\\n    background: #d7d4f0;\\n  }\\n  .CodeMirror-line::-moz-selection,\\n  .CodeMirror-line > span::-moz-selection,\\n  .CodeMirror-line > span > span::-moz-selection {\\n    background: #d7d4f0;\\n  }\\n\\n  .cm-searching {\\n    background-color: #ffa;\\n    background-color: rgba(255, 255, 0, 0.4);\\n  }\\n\\n  /* Used to force a border model for a node */\\n  .cm-force-border {\\n    padding-right: 0.1px;\\n  }\\n\\n  @media print {\\n    /* Hide the cursor when printing */\\n    .CodeMirror div.CodeMirror-cursors {\\n      visibility: hidden;\\n    }\\n  }\\n\\n  /* See issue #2901 */\\n  .cm-tab-wrap-hack:after {\\n    content: '';\\n  }\\n\\n  /* Help users use markselection to safely style text background */\\n  span.CodeMirror-selectedtext {\\n    background: none;\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar CodeMirrorCss = /*#__PURE__*/css( /*#__PURE__*/_templateObject());\n\nfunction _templateObject$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  .ProseMirror .tinacms-image-wrapper {\\n    display: inline-block;\\n    margin: 1em 0;\\n  }\\n\\n  \", \"\\n\"]);\n\n  _templateObject$1 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar paddingX = 8;\nvar paddingY = 6;\nvar borderWidth = 1;\nvar controlSize = 12;\nvar proseMirrorTableStyles = \"\\n  .ProseMirror {\\n    display: inline-block\\n  }\\n  .ProseMirror .tableWrapper {\\n    overflow-x: auto;\\n  }\\n  .ProseMirror .column-resize-handle {\\n    position: absolute;\\n    right: -2px;\\n    top: 0;\\n    bottom: 0;\\n    width: 4px;\\n    z-index: 20;\\n    background-color: #adf;\\n    pointer-events: none;\\n  }\\n  .ProseMirror.resize-cursor {\\n    cursor: ew-resize;\\n    cursor: col-resize;\\n  }\\n  /* Give selected cells a blue overlay */\\n  .ProseMirror .selectedCell:after {\\n    z-index: 2;\\n    position: absolute;\\n    content: '';\\n    left: 0;\\n    right: 0;\\n    top: 0;\\n    bottom: 0;\\n    background: rgba(0, 132, 255, 0.25);\\n    /* This provides a bullet-proof border for selected cells even with border collapsing */\\n    box-shadow: 0 0 0 1px #0574E4;\\n    pointer-events: none;\\n  }\\n  .ProseMirror:focus {\\n    outline: 0px solid transparent;\\n  }\\n  .ProseMirror table {\\n    border-collapse: collapse;\\n    table-layout: fixed;\\n    display: inline-table;\\n    margin: 32px 0 32px 0;\\n    overflow: visible;\\n    width: 100%;\\n  }\\n  .ProseMirror th {\\n    background-color: #F6F6F9;\\n  }\\n  .ProseMirror table td,\\n  .ProseMirror table th {\\n    border: 1px solid #E1DDEC;\\n    padding: \" + paddingY + \"px \" + paddingX + \"px;\\n    position: relative;\\n    vertical-align: top;\\n    box-sizing: border-box;\\n  }\\n  .ProseMirror .tina_table_header_ext_top {\\n    background: #F6F6F9;\\n    border: 1px solid #E1DDEC;\\n    position: absolute;\\n    height: \" + controlSize + \"px;\\n    width: calc(100% + \" + borderWidth * 2 + \"px);\\n    transform: translate(\" + (borderWidth + paddingX) * -1 + \"px, \" + (controlSize + paddingY) * -1 + \"px);\\n    cursor: pointer;\\n    z-index: 1;\\n    user-select: none;\\n  }\\n  .ProseMirror div.tina_table_header_ext_top_selected {\\n    background: #0084ff;\\n    border-color: #0574E4;\\n    z-index: 10;\\n  }\\n  .ProseMirror .tina_table_header_ext_left {\\n    background: #F6F6F9;\\n    border: 1px solid #E1DDEC;\\n    position: absolute;\\n    height: calc(100% + \" + borderWidth * 2 + \"px);\\n    width: \" + controlSize + \"px;\\n    transform: translate(\" + (controlSize + paddingX) * -1 + \"px, \" + (borderWidth + paddingY) * -1 + \"px);\\n    cursor: pointer;\\n    z-index: 1;\\n    user-select: none;\\n  }\\n  .ProseMirror div.tina_table_header_ext_left_selected {\\n    background: #0084ff;\\n    border-color: #0574E4;\\n    z-index: 10;\\n  }\\n  .ProseMirror .tina_table_header_ext_top_left {\\n    background: #F6F6F9;\\n    border: 1px solid #E1DDEC;\\n    position: absolute;\\n    height: \" + controlSize + \"px;\\n    width: \" + controlSize + \"px;\\n    transform: translate(\" + (controlSize + paddingX) * -1 + \"px, \" + (controlSize + paddingY) * -1 + \"px);\\n    border-radius: 5px 0 0 0;\\n    z-index: 1;\\n    cursor: pointer;\\n    user-select: none;\\n  }\\n  .ProseMirror div.tina_table_header_ext_top_left_selected {\\n    background: #0084ff;\\n    border-color: #0574E4;\\n    z-index: 10;\\n  }\\n  .ProseMirror .selectedCell {\\n    border-color: transparent;\\n  }\\n\";\nvar ProseMirrorCss = /*#__PURE__*/css( /*#__PURE__*/_templateObject$1(), proseMirrorTableStyles);\n\nfunction _templateObject$2() {\n  var data = _taggedTemplateLiteralLoose([\"\"]);\n\n  _templateObject$2 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar MenuPortalContext = /*#__PURE__*/createContext(function () {\n  return null;\n});\n\nfunction useMenuPortal() {\n  return useContext(MenuPortalContext);\n}\n\nvar MenuPortalProvider = function MenuPortalProvider(_ref) {\n  var children = _ref.children;\n  var wrapperRef = useRef(null);\n  var MenuPortal = useCallback(function (props) {\n    if (!wrapperRef.current) return null;\n    return createPortal(props.children, wrapperRef.current);\n  }, [wrapperRef.current]);\n  return createElement(MenuPortalContext.Provider, {\n    value: MenuPortal\n  }, createElement(MenuPortalWrapper, {\n    ref: wrapperRef\n  }, children));\n};\n\nvar MenuPortalWrapper = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject$2());\n\nfunction _templateObject14() {\n  var data = _taggedTemplateLiteralLoose([\"\\n      color: var(--tina-color-primary);\\n      fill: var(--tina-color-primary);\\n      background-color: rgba(53, 50, 50, 0.05);\\n    \"]);\n\n  _templateObject14 = function _templateObject14() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject13() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: block;\\n  padding: 8px 16px;\\n  transition: all 85ms ease-out;\\n  cursor: pointer;\\n  &:first-child {\\n    padding-top: var(--tina-padding-small);\\n  }\\n  &:last-child {\\n    padding-bottom: var(--tina-padding-small);\\n  }\\n  &:hover {\\n    background-color: var(--tina-color-grey-1);\\n    color: var(--tina-color-primary);\\n  }\\n  &:active {\\n    color: var(--tina-color-primary);\\n    fill: var(--tina-color-primary);\\n    background-color: rgba(53, 50, 50, 0.05);\\n  }\\n  \", \";\\n\"]);\n\n  _templateObject13 = function _templateObject13() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject12() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: absolute;\\n  left: \", \"px;\\n\"]);\n\n  _templateObject12 = function _templateObject12() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject11() {\n  var data = _taggedTemplateLiteralLoose([\"\\n      opacity: 1;\\n      pointer-events: all;\\n      transform: translate3d(0, 100%, 0) scale3d(1, 1, 1);\\n    \"]);\n\n  _templateObject11 = function _templateObject11() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject10() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  border-radius: var(--tina-radius-big);\\n  border: 1px solid #efefef;\\n  display: block;\\n  position: absolute;\\n  bottom: -4px;\\n  left: 0;\\n  transform: translate3d(0, 100%, 0) scale3d(0.5, 0.5, 1);\\n  opacity: 0;\\n  pointer-events: none;\\n  transition: all 85ms ease-out;\\n  transform-origin: 0 0;\\n  box-shadow: 0px 2px 3px rgba(0, 0, 0, 0.12), 0px 4px 8px rgba(48, 48, 48, 0.1);\\n  background-color: white;\\n  overflow: hidden;\\n\\n  \", \";\\n\"]);\n\n  _templateObject10 = function _templateObject10() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject9() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  \", \"\\n  position: relative;\\n\\n  \", \" {\\n    width: 100%;\\n  }\\n\"]);\n\n  _templateObject9 = function _templateObject9() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject8() {\n  var data = _taggedTemplateLiteralLoose([\"\\n      pointer-events: none;\\n      color: #d1d1d1;\\n      fill: #d1d1d1;\\n    \"]);\n\n  _templateObject8 = function _templateObject8() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject7() {\n  var data = _taggedTemplateLiteralLoose([\"\\n      color: var(--tina-color-primary);\\n      fill: var(--tina-color-primary);\\n      background-color: rgba(53, 50, 50, 0.05);\\n    \"]);\n\n  _templateObject7 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  \", \"\\n  background-color: \", \";\\n  color: \", \";\\n  fill: \", \";\\n  border: 1px solid var(--tina-color-grey-2);\\n  margin: -1px;\\n  outline: none;\\n  padding: 6px 4px;\\n  transition: all 85ms ease-out;\\n  cursor: pointer;\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  &:hover {\\n    background-color: rgba(53, 50, 50, 0.09);\\n  }\\n  &:active {\\n    color: var(--tina-color-primary);\\n    fill: var(--tina-color-primary);\\n    background-color: rgba(53, 50, 50, 0.05);\\n  }\\n  svg {\\n    width: 20px;\\n    height: 20px;\\n  }\\n  \", \";\\n  \", \";\\n\"]);\n\n  _templateObject6 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  flex: 1 1 24px;\\n\"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nvar MenuItem = /*#__PURE__*/css( /*#__PURE__*/_templateObject5());\nvar MenuButton = /*#__PURE__*/styled.button( /*#__PURE__*/_templateObject6(), MenuItem, function (p) {\n  return p.active ? 'rgba(53, 50, 50, 0.05)' : 'transparent';\n}, function (p) {\n  return p.active ? 'var(--tina-color-primary)' : 'var(--tina-color-grey-8)';\n}, function (p) {\n  return p.active ? 'var(--tina-color-primary)' : 'var(--tina-color-grey-8)';\n}, function (props) {\n  return props.active && css(_templateObject7());\n}, function (props) {\n  return props.disabled && css(_templateObject8());\n});\nvar MenuDropdownWrapper = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject9(), MenuItem, MenuButton);\nvar MenuButtonDropdown = /*#__PURE__*/styled(function (_ref) {\n  var children = _ref.children,\n      triggerRef = _ref.triggerRef,\n      styleProps = _objectWithoutPropertiesLoose(_ref, [\"children\", \"open\", \"triggerRef\"]);\n\n  var MenuPortal = useMenuPortal();\n  var menuPortalRef = useRef(null);\n  var menuOffset = useMemo(function () {\n    if (!triggerRef.current || !menuPortalRef.current) return 0;\n    var menuDropdownBoundingBox = triggerRef.current.getBoundingClientRect();\n    var menuPortalBoundingBox = menuPortalRef.current.getBoundingClientRect();\n    return menuDropdownBoundingBox.x - menuPortalBoundingBox.x;\n  }, [triggerRef.current, menuPortalRef.current]);\n  return createElement(MenuPortal, null, createElement(Offset, {\n    offset: menuOffset\n  }, createElement(\"div\", Object.assign({\n    ref: menuPortalRef\n  }, styleProps), children)));\n})( /*#__PURE__*/_templateObject10(), function (props) {\n  return props.open && css(_templateObject11());\n});\nvar Offset = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject12(), function (props) {\n  return props.offset;\n});\nvar MenuOption = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject13(), function (props) {\n  return props.active && css(_templateObject14());\n});\n\nfunction markControl(_ref) {\n  var mark = _ref.mark,\n      Icon = _ref.Icon,\n      tooltip = _ref.tooltip,\n      defaultAttrs = _ref.defaultAttrs,\n      _ref$selectionOnly = _ref.selectionOnly,\n      selectionOnly = _ref$selectionOnly === void 0 ? false : _ref$selectionOnly,\n      _ref$noMix = _ref.noMix,\n      noMix = _ref$noMix === void 0 ? [] : _ref$noMix,\n      isDisabled = _ref.isDisabled,\n      onClick = _ref.onClick;\n\n  var _a;\n\n  return _a = /*#__PURE__*/function (_React$Component) {\n    _inheritsLoose(_, _React$Component);\n\n    function _() {\n      var _this;\n\n      _this = _React$Component.apply(this, arguments) || this;\n\n      _this.markIsActive = function (markName) {\n        var state = _this.props.view.state;\n\n        var mark = _this.markType(markName);\n\n        var _state$selection = state.selection,\n            from = _state$selection.from,\n            $from = _state$selection.$from,\n            to = _state$selection.to,\n            empty = _state$selection.empty;\n        if (empty) return !!mark.isInSet(state.storedMarks || $from.marks());else return state.doc.rangeHasMark(from, to, mark);\n      };\n\n      _this.onClick = function () {\n        if (onClick) {\n          onClick(_this.props.view);\n        }\n\n        if (_this.disabled) return;\n        var _this$props$view = _this.props.view,\n            state = _this$props$view.state,\n            dispatch = _this$props$view.dispatch;\n\n        if (state.selection.$cursor && selectionOnly) {\n          return;\n        }\n\n        toggleMark(_this.markType(mark), defaultAttrs)(state, dispatch);\n      };\n\n      return _this;\n    }\n\n    var _proto = _.prototype;\n\n    _proto.markType = function markType(markName) {\n      var schema = this.props.view.state.schema;\n      return schema.marks[markName];\n    };\n\n    _proto.render = function render() {\n      if (!this.markType(mark)) {\n        return null;\n      }\n\n      return createElement(MenuButton, {\n        \"data-tooltip\": tooltip,\n        \"data-side\": \"top\",\n        onClick: this.onClick,\n        active: !this.disabled && this.active,\n        disabled: this.disabled\n      }, createElement(Icon, null));\n    };\n\n    _createClass(_, [{\n      key: \"active\",\n      get: function get() {\n        return this.markIsActive(mark);\n      }\n    }, {\n      key: \"disabled\",\n      get: function get() {\n        if (isDisabled) return isDisabled(this.props.view);\n        if (mark === 'image') if (selectionOnly) {\n          var $cursor = this.props.view.state.selection.$cursor;\n          return !!$cursor || this.inCodeBlock || this.incompatibleMarksAreActive;\n        }\n        return this.inCodeBlock || this.incompatibleMarksAreActive;\n      }\n    }, {\n      key: \"inCodeBlock\",\n      get: function get() {\n        var view = this.props.view;\n        var node = view.state.selection.$from.node(view.state.selection.$from.depth);\n        return node.type === view.state.schema.nodes.code_block;\n      }\n    }, {\n      key: \"incompatibleMarksAreActive\",\n      get: function get() {\n        return noMix.map(this.markIsActive).reduce(function (someMarkActive, nextMarkActive) {\n          return nextMarkActive || someMarkActive;\n        }, false);\n      }\n    }]);\n\n    return _;\n  }(Component), _a.displayName = mark + \"Control\", _a;\n}\n\nfunction blockTool(options) {\n  var Component$1 = options.Component,\n      children = options.children,\n      command = options.command,\n      typeName = options.typeName,\n      attrs = options.attrs;\n  return /*#__PURE__*/function (_React$Component) {\n    _inheritsLoose(_class, _React$Component);\n\n    function _class() {\n      var _this;\n\n      _this = _React$Component.apply(this, arguments) || this;\n\n      _this.canDo = function () {\n        return command(_this.props.view.state);\n      };\n\n      _this.onClick = function () {\n        command(_this.props.view.state, _this.props.view.dispatch);\n\n        _this.props.view.focus();\n\n        _this.props.onClick();\n      };\n\n      return _this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.render = function render() {\n      return createElement(MenuOption, {\n        onClick: this.onClick,\n        disabled: !this.canDo(),\n        active: this.active\n      }, createElement(Component$1, null, children));\n    };\n\n    _createClass(_class, [{\n      key: \"active\",\n      get: function get() {\n        if (!typeName) return false;\n        var state = this.props.view.state;\n        var $from = state.selection.$from;\n        var node = $from.node($from.depth);\n        var correctNodeType = node.type.name === typeName; // Only works for Heading\n\n        var correctAttrs = attrs ? node.attrs.level === attrs.level : true;\n        return correctNodeType && correctAttrs;\n      }\n    }]);\n\n    return _class;\n  }(Component);\n}\n\nfunction _templateObject7$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  \", \"\\n\"]);\n\n  _templateObject7$1 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  \", \"\\n\"]);\n\n  _templateObject6$1 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  \", \"\\n\"]);\n\n  _templateObject5$1 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  \", \"\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  \", \"\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  \", \"\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  white-space: nowrap;\\n  line-height: 1;\\n  display: block;\\n  margin: 0;\\n\"]);\n\n  _templateObject$3 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar FormattingDropdown = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(FormattingDropdown, _React$Component);\n\n  function FormattingDropdown() {\n    var _this;\n\n    _this = _React$Component.apply(this, arguments) || this;\n    _this.state = {\n      active: false\n    };\n    _this.menuButtonRef = createRef();\n\n    _this.toggle = function () {\n      return _this.setState(function (_ref) {\n        var active = _ref.active;\n        return {\n          active: !active\n        };\n      });\n    };\n\n    _this.blockQuote = function () {\n      return wrapIn(_this.props.view.state.schema.nodes.blockquote)(_this.props.view.state, _this.props.view.dispatch);\n    };\n\n    _this.lift = function () {\n      return lift(_this.props.view.state, _this.props.view.dispatch);\n    };\n\n    return _this;\n  }\n\n  var _proto = FormattingDropdown.prototype;\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    var view = this.props.view;\n    return createElement(MenuDropdownWrapper, null, createElement(MenuButton, {\n      ref: this.menuButtonRef,\n      \"data-tooltip\": 'Heading',\n      onClick: this.toggle,\n      active: this.state.active\n    }, createElement(HeadingIcon, null)), createElement(MenuButtonDropdown, {\n      triggerRef: this.menuButtonRef,\n      open: this.state.active\n    }, createElement(Dismissible, {\n      click: true,\n      escape: true,\n      disabled: !this.state.active,\n      onDismiss: function onDismiss() {\n        _this2.toggle();\n      }\n    }, createElement(H1, {\n      view: view,\n      onClick: this.toggle\n    }), createElement(H2, {\n      view: view,\n      onClick: this.toggle\n    }), createElement(H3, {\n      view: view,\n      onClick: this.toggle\n    }), createElement(H4, {\n      view: view,\n      onClick: this.toggle\n    }), createElement(H5, {\n      view: view,\n      onClick: this.toggle\n    }), createElement(H6, {\n      view: view,\n      onClick: this.toggle\n    }))));\n  };\n\n  return FormattingDropdown;\n}(Component);\n\nfunction makeToggleHeader(level) {\n  return function toggleHeader$1(state, dispatch) {\n    var tn = toggleHeader(state.schema.nodes.heading, {\n      level: level\n    }, state.schema.nodes.paragraph, null);\n    return tn(state, dispatch);\n  };\n}\n\nvar BaseHeading = /*#__PURE__*/css( /*#__PURE__*/_templateObject$3());\nvar HeadingOne = /*#__PURE__*/styled.h1( /*#__PURE__*/_templateObject2(), BaseHeading);\nvar HeadingTwo = /*#__PURE__*/styled.h2( /*#__PURE__*/_templateObject3(), BaseHeading);\nvar HeadingThree = /*#__PURE__*/styled.h3( /*#__PURE__*/_templateObject4(), BaseHeading);\nvar HeadingFour = /*#__PURE__*/styled.h4( /*#__PURE__*/_templateObject5$1(), BaseHeading);\nvar HeadingFive = /*#__PURE__*/styled.h5( /*#__PURE__*/_templateObject6$1(), BaseHeading);\nvar HeadingSix = /*#__PURE__*/styled.h6( /*#__PURE__*/_templateObject7$1(), BaseHeading);\nvar H1 = /*#__PURE__*/blockTool({\n  Component: HeadingOne,\n  children: 'Heading 1',\n  command: /*#__PURE__*/makeToggleHeader(1),\n  typeName: 'heading',\n  attrs: {\n    level: 1\n  }\n});\nvar H2 = /*#__PURE__*/blockTool({\n  Component: HeadingTwo,\n  children: 'Heading 2',\n  command: /*#__PURE__*/makeToggleHeader(2),\n  typeName: 'heading',\n  attrs: {\n    level: 2\n  }\n});\nvar H3 = /*#__PURE__*/blockTool({\n  Component: HeadingThree,\n  children: 'Heading 3',\n  command: /*#__PURE__*/makeToggleHeader(3),\n  typeName: 'heading',\n  attrs: {\n    level: 3\n  }\n});\nvar H4 = /*#__PURE__*/blockTool({\n  Component: HeadingFour,\n  children: 'Heading 4',\n  command: /*#__PURE__*/makeToggleHeader(4),\n  typeName: 'heading',\n  attrs: {\n    level: 4\n  }\n});\nvar H5 = /*#__PURE__*/blockTool({\n  Component: HeadingFive,\n  children: 'Heading 5',\n  command: /*#__PURE__*/makeToggleHeader(5),\n  typeName: 'heading',\n  attrs: {\n    level: 5\n  }\n});\nvar H6 = /*#__PURE__*/blockTool({\n  Component: HeadingSix,\n  children: 'Heading 6',\n  command: /*#__PURE__*/makeToggleHeader(6),\n  typeName: 'heading',\n  attrs: {\n    level: 6\n  }\n});\n\nfunction _templateObject2$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: absolute;\\n  top: 50%;\\n  left: -8px;\\n  transform: translate3d(-100%, -50%, 0);\\n\"]);\n\n  _templateObject2$1 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  left: 50%;\\n  position: absolute;\\n  top: -8px;\\n  transform: translate3d(-50%, -100%, 0);\\n  button:not(:first-of-type) {\\n    margin-left: 10px;\\n  }\\n\"]);\n\n  _templateObject$4 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar alignColumn = function alignColumn(view, alignValue) {\n  var state = view.state,\n      dispatch = view.dispatch;\n  var selection = state.selection;\n  var _state$schema$nodes = state.schema.nodes,\n      table = _state$schema$nodes.table,\n      table_cell = _state$schema$nodes.table_cell,\n      table_header = _state$schema$nodes.table_header;\n  var tableCell = findParentNodeOfType(table_cell)(state.selection);\n  var tableHeader = findParentNodeOfType(table_header)(state.selection);\n  var cellNode = tableCell || tableHeader;\n  if (!cellNode) return;\n  var align = cellNode.node.attrs.align === alignValue ? undefined : alignValue;\n  var tableNode = findParentNodeOfType(table)(state.selection);\n  if (!tableNode) return;\n  var tableMap = TableMap.get(tableNode.node);\n  var pos = Object.entries(tableMap.map).find(function (entry) {\n    return entry[1] > selection.head - tableNode.start;\n  });\n  if (!pos) return;\n  var cellPos = parseInt(pos[0]) - 1;\n  var columnPos = cellPos % tableMap.width;\n  dispatch(forEachCellInColumn(columnPos, function (cell, tr) {\n    return setCellAttrs(cell, {\n      align: align\n    })(tr);\n  })(state.tr));\n  view.focus();\n};\n\nvar FloatingTableColumnMenu = function FloatingTableColumnMenu(props) {\n  var _props$editorView$vie = props.editorView.view,\n      state = _props$editorView$vie.state,\n      dispatch = _props$editorView$vie.dispatch;\n  var markerDivTable = document.getElementsByClassName('tina_table_header_ext_top_left_selected')[0];\n  if (markerDivTable) return null;\n  var markerDivCol = document.getElementsByClassName('tina_table_header_ext_top_selected')[0];\n  var markerDivRows = document.getElementsByClassName('tina_table_header_ext_left');\n  var markerDivRow;\n\n  for (var i = 1; i < markerDivRows.length; i++) {\n    if (markerDivRows[i].classList.contains('tina_table_header_ext_left_selected')) markerDivRow = markerDivRows[i];\n  }\n\n  if (!markerDivCol && !markerDivRow) return null;\n  var view = props.editorView.view;\n  return createElement(Fragment$1, null, markerDivCol && createPortal(createElement(IconWrapperCol, null, createElement(IconButton, {\n    onClick: function onClick() {\n      return alignColumn(view, 'left');\n    },\n    small: true,\n    primary: true\n  }, createElement(AlignLeft, null)), createElement(IconButton, {\n    onClick: function onClick() {\n      return alignColumn(view, 'center');\n    },\n    small: true,\n    primary: true\n  }, createElement(AlignCenter, null)), createElement(IconButton, {\n    onClick: function onClick() {\n      return alignColumn(view, 'right');\n    },\n    small: true,\n    primary: true\n  }, createElement(AlignRight, null)), createElement(IconButton, {\n    onClick: function onClick() {\n      deleteColumn(state, dispatch);\n      view.focus();\n    },\n    small: true,\n    primary: true\n  }, createElement(TrashIcon, null))), markerDivCol), markerDivRow && createPortal(createElement(IconWrapperRow, null, createElement(IconButton, {\n    onClick: function onClick() {\n      deleteRow(state, dispatch);\n      view.focus();\n    },\n    small: true,\n    primary: true\n  }, createElement(TrashIcon, null))), markerDivRow));\n};\n\nvar IconWrapperCol = /*#__PURE__*/styled.span( /*#__PURE__*/_templateObject$4());\nvar IconWrapperRow = /*#__PURE__*/styled.span( /*#__PURE__*/_templateObject2$1());\n\nfunction _templateObject4$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: absolute;\\n  background: #0574e4;\\n  top: \", \"px;\\n  z-index: 1000;\\n  right: \", \"px;\\n  width: \", \"px;\\n  height: \", \";\\n\"]);\n\n  _templateObject4$1 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: absolute;\\n  top: 0;\\n  left: 50%;\\n  transform: translate3d(-50%, -50%, 0);\\n\"]);\n\n  _templateObject3$1 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2$2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  background: #e1ddec;\\n  border-radius: 50%;\\n  height: 4px;\\n  width: 4px;\\n\"]);\n\n  _templateObject2$2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$5() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  top: -7px;\\n  position: absolute;\\n  right: 0;\\n  padding: 8px;\\n  transform: translate3d(50%, -100%, 0);\\n  user-select: none;\\n\"]);\n\n  _templateObject$5 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar borderWidth$1 = 1;\nvar controlSize$1 = 12;\n\nvar AddColumnMenu = function AddColumnMenu(_ref) {\n  var index = _ref.index,\n      marker = _ref.marker,\n      tableHeight = _ref.tableHeight,\n      view = _ref.view;\n  var state = view.state,\n      dispatch = view.dispatch;\n\n  var addColumn = function addColumn(pos) {\n    dispatch(addColumnAt(pos)(state.tr));\n    view.focus();\n  };\n\n  var _useState = useState(false),\n      hovered = _useState[0],\n      setHovered = _useState[1];\n\n  useEffect(function () {\n    if (hovered) marker.style.zIndex = '1000';else marker.style.zIndex = '1';\n  }, [hovered]);\n  return createPortal(React__default.createElement(React__default.Fragment, null, React__default.createElement(Wrapper, {\n    onMouseEnter: function onMouseEnter() {\n      return setHovered(true);\n    },\n    onMouseLeave: function onMouseLeave() {\n      return setHovered(false);\n    }\n  }, hovered ? React__default.createElement(IconWrapperCol$1, null, React__default.createElement(IconButton, {\n    onClick: function onClick() {\n      addColumn(index);\n      setHovered(false);\n    },\n    small: true,\n    primary: true\n  }, React__default.createElement(AddIcon, null))) : React__default.createElement(Pointer, null)), hovered && React__default.createElement(ColumnDivider, {\n    height: tableHeight\n  })), marker);\n};\n\nvar Wrapper = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject$5());\nvar Pointer = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject2$2());\nvar IconWrapperCol$1 = /*#__PURE__*/styled.span( /*#__PURE__*/_templateObject3$1());\nvar ColumnDivider = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject4$1(), -1 * borderWidth$1, -1 * borderWidth$1, 2 * borderWidth$1, function (_ref2) {\n  var height = _ref2.height;\n  return height + controlSize$1 - borderWidth$1 + \"px\";\n});\n\nfunction _templateObject4$2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: absolute;\\n  background: #0574e4;\\n  left: \", \"px;\\n  z-index: 1000;\\n  bottom: \", \"px;\\n  height: \", \"px;\\n  width: \", \";\\n\"]);\n\n  _templateObject4$2 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3$2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: absolute;\\n  top: 50%;\\n  left: 0;\\n  transform: translate3d(-50%, -50%, 0);\\n\"]);\n\n  _templateObject3$2 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2$3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  background: #e1ddec;\\n  border-radius: 50%;\\n  height: 4px;\\n  width: 4px;\\n\"]);\n\n  _templateObject2$3 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$6() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  left: -7px;\\n  position: absolute;\\n  bottom: 0;\\n  padding: 8px;\\n  transform: translate3d(-100%, 50%, 0);\\n  user-select: none;\\n\"]);\n\n  _templateObject$6 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar borderWidth$2 = 1;\nvar controlSize$2 = 12;\n\nvar AddRowMenu = function AddRowMenu(_ref) {\n  var index = _ref.index,\n      marker = _ref.marker,\n      tableWidth = _ref.tableWidth,\n      view = _ref.view;\n  var state = view.state,\n      dispatch = view.dispatch;\n\n  var addRow = function addRow(pos) {\n    if (pos > 1) dispatch(addRowAt(pos, true)(state.tr));else {\n      var _state$schema$nodes = state.schema.nodes,\n          table = _state$schema$nodes.table,\n          table_cell = _state$schema$nodes.table_cell,\n          table_row = _state$schema$nodes.table_row;\n      var tableNode = findParentNodeOfType(table)(state.selection);\n      if (!tableNode) return;\n      var tableMap = TableMap.get(tableNode.node);\n      var position = tableNode.start + tableMap.map[tableMap.width] - 1;\n      var cellInNextRow = getCellsInRow(0)(state.selection);\n      if (!cellInNextRow) return;\n      var cells = cellInNextRow === null || cellInNextRow === void 0 ? void 0 : cellInNextRow.map(function (cell) {\n        return table_cell.createAndFill(_extends({}, cell.node.attrs));\n      });\n      dispatch(state.tr.insert(position, table_row.create(null, cells)));\n    }\n    view.focus();\n  };\n\n  var _useState = useState(false),\n      hovered = _useState[0],\n      setHovered = _useState[1];\n\n  useEffect(function () {\n    if (hovered) marker.style.zIndex = '1000';else marker.style.zIndex = '1';\n  }, [hovered]);\n  return createPortal(React__default.createElement(React__default.Fragment, null, React__default.createElement(Wrapper$1, {\n    onMouseEnter: function onMouseEnter() {\n      return setHovered(true);\n    },\n    onMouseLeave: function onMouseLeave() {\n      return setHovered(false);\n    }\n  }, hovered && index > 0 ? React__default.createElement(IconWrapperRow$1, null, React__default.createElement(IconButton, {\n    onClick: function onClick() {\n      return addRow(index);\n    },\n    small: true,\n    primary: true\n  }, React__default.createElement(AddIcon, null))) : React__default.createElement(Pointer$1, null)), hovered && React__default.createElement(ColumnDivider$1, {\n    width: tableWidth\n  })), marker);\n};\n\nvar Wrapper$1 = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject$6());\nvar Pointer$1 = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject2$3());\nvar IconWrapperRow$1 = /*#__PURE__*/styled.span( /*#__PURE__*/_templateObject3$2());\nvar ColumnDivider$1 = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject4$2(), -1 * borderWidth$2, -1 * borderWidth$2, 2 * borderWidth$2, function (_ref2) {\n  var width = _ref2.width;\n  return width + controlSize$2 - borderWidth$2 + \"px\";\n});\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\nvar FloatingTableAddMenu = function FloatingTableAddMenu(_ref) {\n  var editorView = _ref.editorView;\n  var markerDivTable = document.getElementsByClassName('tina_table_header_ext_top_left');\n  if (!markerDivTable.length) return null;\n  var tableElm = markerDivTable[0].closest('table');\n  if (!tableElm) return null;\n\n  var _tableElm$getBounding = tableElm.getBoundingClientRect(),\n      height = _tableElm$getBounding.height,\n      width = _tableElm$getBounding.width;\n\n  var markerDivCol = document.getElementsByClassName('tina_table_header_ext_top');\n  var markerCols = [markerDivTable[0]];\n\n  for (var i = 0; i < markerDivCol.length; i++) {\n    markerCols.push(markerDivCol[i]);\n  }\n\n  var markerDivRow = document.getElementsByClassName('tina_table_header_ext_left');\n  var markerRows = [markerDivTable[0]];\n\n  for (var _i = 0; _i < markerDivRow.length; _i++) {\n    markerRows.push(markerDivRow[_i]);\n  }\n\n  var view = editorView.view;\n  return React__default.createElement(React__default.Fragment, null, markerCols.map(function (marker, index) {\n    return React__default.createElement(AddColumnMenu, {\n      key: \"add-column-menu-\" + index,\n      index: index,\n      marker: marker,\n      tableHeight: height,\n      view: view\n    });\n  }), markerRows.map(function (marker, index) {\n    return React__default.createElement(AddRowMenu, {\n      key: \"add-row-menu-\" + index,\n      index: index,\n      marker: marker,\n      tableWidth: width,\n      view: view\n    });\n  }));\n};\n\nfunction _templateObject$7() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  background-color: #ffffff;\\n  border-radius: 2px;\\n  cursor: default;\\n  padding: 0px 4px;\\n  position: absolute;\\n  top: \", \";\\n  left: \", \";\\n\"]);\n\n  _templateObject$7 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar TableOptionsMenu = function TableOptionsMenu(_ref) {\n  var editorView = _ref.editorView;\n  var view = editorView.view;\n\n  var deleteSelectedTable = function deleteSelectedTable() {\n    var state = view.state,\n        dispatch = view.dispatch;\n    deleteTable(state, dispatch);\n    view.focus();\n  };\n\n  var markerDivTable = document.getElementsByClassName('tina_table_header_ext_top_left');\n  if (!markerDivTable.length) return null;\n  var tableElm = markerDivTable[0].closest('table');\n  if (!tableElm) return null;\n\n  var _tableElm$getBounding = tableElm.getBoundingClientRect(),\n      height = _tableElm$getBounding.height,\n      width = _tableElm$getBounding.width;\n\n  return ReactDOM__default.createPortal(React__default.createElement(Wrapper$2, {\n    height: height,\n    width: width\n  }, React__default.createElement(IconButton, {\n    onClick: deleteSelectedTable,\n    small: true,\n    primary: true\n  }, React__default.createElement(TrashIcon, null))), markerDivTable[0]);\n};\n\nvar Wrapper$2 = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject$7(), function (_ref2) {\n  var height = _ref2.height;\n  return height + 24 + \"px\";\n}, function (_ref3) {\n  var width = _ref3.width;\n  return width / 2 - 8 + \"px\";\n});\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\nvar FloatingTableMenu = function FloatingTableMenu(props) {\n  return createElement(Fragment$1, null, createElement(FloatingTableColumnMenu, Object.assign({}, props)), createElement(FloatingTableAddMenu, Object.assign({}, props)), createElement(TableOptionsMenu, Object.assign({}, props)));\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar createCell = function createCell(cellType, cellContent) {\n  if (cellContent) return cellType.createChecked(null, cellContent);\n  return cellType.createAndFill();\n};\n\nvar insertTable = function insertTable(state, dispatch) {\n  if (!dispatch) return true;\n  var _state$schema$nodes = state.schema.nodes,\n      tableCell = _state$schema$nodes.table_cell,\n      tableHeader = _state$schema$nodes.table_header,\n      tableRow = _state$schema$nodes.table_row,\n      table = _state$schema$nodes.table;\n  var rowsCount = 3;\n  var colsCount = 3;\n  var cells = [];\n  var headerCells = [];\n\n  for (var i = 0; i < colsCount; i += 1) {\n    headerCells.push(createCell(tableHeader));\n    cells.push(createCell(tableCell));\n  }\n\n  var rows = [];\n\n  for (var _i = 0; _i < rowsCount; _i += 1) {\n    rows.push(tableRow.createChecked(null, _i === 0 ? headerCells : cells));\n  }\n\n  var newTable = table.createChecked(null, rows);\n  var selection = state.selection,\n      tr = state.tr;\n  var $from = selection.$from,\n      $to = selection.$to;\n  dispatch(tr.replaceWith($from.pos, $to.pos, newTable).scrollIntoView());\n  return true;\n};\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\n\nvar UndoControl = function UndoControl(_ref) {\n  var view = _ref.view;\n\n  var undoChange = function undoChange() {\n    var state = view.state,\n        dispatch = view.dispatch;\n    undo(state, dispatch);\n  };\n\n  return createElement(MenuButton, {\n    \"data-tooltip\": \"Undo\",\n    \"data-side\": \"top\",\n    onClick: undoChange,\n    disabled: undoDepth(view.state) < 1\n  }, createElement(UndoIcon, null));\n};\n\nvar RedoControl = function RedoControl(_ref2) {\n  var view = _ref2.view;\n\n  var redoChange = function redoChange() {\n    var state = view.state,\n        dispatch = view.dispatch;\n    redo(state, dispatch);\n  };\n\n  return createElement(MenuButton, {\n    \"data-tooltip\": \"Redo\",\n    \"data-side\": \"top\",\n    onClick: redoChange,\n    disabled: redoDepth(view.state) < 1\n  }, createElement(RedoIcon, null));\n};\n\nfunction _templateObject7$2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  background-color: white;\\n  border: 1px solid var(--tina-color-grey-2);\\n  color: #0084ff;\\n  &:hover {\\n    background-color: #f6f6f9;\\n    opacity: 1;\\n  }\\n\"]);\n\n  _templateObject7$2 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6$2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  text-align: center;\\n  border: 0;\\n  border-radius: var(--tina-radius-big);\\n  box-shadow: 0px 2px 3px rgba(0, 0, 0, 0.12);\\n  background-color: #0084ff;\\n  color: white;\\n  font-weight: 500;\\n  cursor: pointer;\\n  transition: all 85ms ease-out;\\n  font-size: var(--tina-font-size-0);\\n  padding: 8px 20px;\\n  margin-left: 8px;\\n  &:hover {\\n    background-color: #2296fe;\\n  }\\n  &:active {\\n    background-color: #0574e4;\\n  }\\n\"]);\n\n  _templateObject6$2 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5$2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  justify-content: flex-end;\\n  padding-top: 4px;\\n\"]);\n\n  _templateObject5$2 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4$3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: relative;\\n  background-color: white;\\n  border-radius: var(--tina-radius-small);\\n  font-size: var(--tina-font-size-1);\\n  line-height: 1.35;\\n  transition: all 85ms ease-out;\\n  padding: 8px 12px;\\n  border: 1px solid var(--tina-color-grey-2);\\n  width: 100%;\\n  margin: 0 0 8px 0;\\n  outline: none;\\n  box-shadow: 0 0 0 2px transparent;\\n\\n  &:hover {\\n    box-shadow: 0 0 0 2px var(--tina-color-grey-3);\\n  }\\n\\n  &:focus {\\n    box-shadow: 0 0 0 2px #0084ff;\\n  }\\n\\n  &::placeholder {\\n    font-size: var(--tina-font-size-2);\\n    color: #cfd3d7;\\n  }\\n\"]);\n\n  _templateObject4$3 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3$3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: block;\\n  font-size: var(--tina-font-size-1);\\n  font-weight: 600;\\n  letter-spacing: 0.01em;\\n  color: var(--tina-color-grey-8);\\n  margin-bottom: 3px;\\n\"]);\n\n  _templateObject3$3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2$4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  background-color: #f6f6f9;\\n  position: relative;\\n  height: max-content;\\n  border-radius: var(--tina-radius-small);\\n  border: 1px solid var(--tina-color-grey-2);\\n  filter: drop-shadow(0px 4px 8px rgba(48, 48, 48, 0.1))\\n    drop-shadow(0px 2px 3px rgba(0, 0, 0, 0.12));\\n  transform-origin: 50% 0;\\n  animation: \", \" 85ms ease-out both 1;\\n  overflow: visible;\\n  padding: 12px;\\n  z-index: 10;\\n\"]);\n\n  _templateObject2$4 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$8() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  0% {\\n    transform: scale3d(0.5,0.5,1)\\n  }\\n  100% {\\n    transform: scale3d(1, 1, 1);\\n  }\\n\"]);\n\n  _templateObject$8 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar LinkForm = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(LinkForm, _React$Component);\n\n  function LinkForm() {\n    var _this;\n\n    _this = _React$Component.apply(this, arguments) || this;\n    _this.state = {\n      href: _this.props.href || '',\n      title: _this.props.title || ''\n    };\n\n    _this.setHref = function (_ref) {\n      var value = _ref.target.value;\n      return _this.setState(function () {\n        return {\n          href: value\n        };\n      });\n    };\n\n    _this.setTitle = function (_ref2) {\n      var value = _ref2.target.value;\n      return _this.setState(function () {\n        return {\n          title: value\n        };\n      });\n    };\n\n    _this.save = function () {\n      return _this.props.onChange(_this.state);\n    };\n\n    _this.onEnterSave = function (e) {\n      if (e.key === 'Enter') {\n        _this.save();\n      }\n    };\n\n    _this.onEscapeCancel = function (e) {\n      if (e.keyCode === 27) {\n        _this.props.cancel();\n      }\n    };\n\n    return _this;\n  }\n\n  var _proto = LinkForm.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    document.addEventListener('keydown', this.onEscapeCancel);\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    document.removeEventListener('keydown', this.onEscapeCancel);\n  };\n\n  _proto.componentWillReceiveProps = function componentWillReceiveProps(props) {\n    var href = props.href,\n        title = props.title;\n    this.setState(function () {\n      return {\n        href: href,\n        title: title\n      };\n    });\n  };\n\n  _proto.render = function render() {\n    var _this$props = this.props,\n        removeLink = _this$props.removeLink,\n        _this$props$style = _this$props.style,\n        style = _this$props$style === void 0 ? {} : _this$props$style;\n    var _this$state = this.state,\n        href = _this$state.href,\n        title = _this$state.title;\n    return createElement(LinkPopup, {\n      style: _extends({}, style)\n    }, createElement(LinkLabel, null, \"Title\"), createElement(LinkInput, {\n      placeholder: \"Enter Title\",\n      type: 'text',\n      value: title,\n      onChange: this.setTitle,\n      onKeyPress: this.onEnterSave\n    }), createElement(LinkLabel, null, \"URL\"), createElement(LinkInput, {\n      placeholder: \"Enter URL\",\n      type: 'text',\n      value: href,\n      onChange: this.setHref,\n      onKeyPress: this.onEnterSave\n    }), createElement(LinkActions, null, createElement(DeleteLink, {\n      onClick: removeLink\n    }, \"Delete\"), createElement(SaveLink, {\n      onClick: this.save\n    }, \"Save\")));\n  };\n\n  return LinkForm;\n}(Component);\n\nvar LinkPopupKeyframes = /*#__PURE__*/keyframes( /*#__PURE__*/_templateObject$8());\nvar LinkPopup = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject2$4(), LinkPopupKeyframes);\nvar LinkLabel = /*#__PURE__*/styled.label( /*#__PURE__*/_templateObject3$3());\nvar LinkInput = /*#__PURE__*/styled.input( /*#__PURE__*/_templateObject4$3());\nvar LinkActions = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject5$2());\nvar SaveLink = /*#__PURE__*/styled.button( /*#__PURE__*/_templateObject6$2());\nvar DeleteLink = /*#__PURE__*/styled(SaveLink)( /*#__PURE__*/_templateObject7$2());\n\nfunction _templateObject2$5() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: absolute;\\n  top: \", \";\\n  left: \", \";\\n  margin-top: 3px;\\n  transform: translate3d(-50%, -100%, 0);\\n  width: 16px;\\n  height: 13px;\\n  clip-path: polygon(50% 0%, 0% 100%, 100% 100%);\\n  background-color: #f6f6f9;\\n  z-index: 100;\\n\"]);\n\n  _templateObject2$5 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$9() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: relative;\\n\"]);\n\n  _templateObject$9 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar width = 240;\n\nvar FloatingLinkForm = function FloatingLinkForm(_ref) {\n  var editorView = _ref.editorView;\n  var view = editorView.view;\n  var linkPluginState = linkPluginKey.getState(view.state);\n  var _view$state$selection = view.state.selection,\n      anchor = _view$state$selection.anchor,\n      head = _view$state$selection.head;\n  var selState = anchor < head ? anchor : head;\n  var node = view.state.selection.empty ? view.domAtPos(selState).node : view.domAtPos(selState + 1).node;\n  var clickTarget = node.parentNode;\n\n  var onChange = function onChange(attrs) {\n    updateLinkBeingEdited(view.state, view.dispatch, attrs);\n  };\n\n  var onCancel = function onCancel() {\n    unmountLinkForm(view);\n  };\n\n  var _useState = useState(undefined),\n      position = _useState[0],\n      setPosition = _useState[1];\n\n  var wrapperRef = createRef();\n  useEffect(function () {\n    if (!clickTarget || !wrapperRef.current) {\n      setPosition(undefined);\n      return;\n    }\n\n    var left = calcLeftOffset(clickTarget, wrapperRef.current, width);\n    var top = \"calc(32px + \" + (findElementOffsetTop(clickTarget) - findElementOffsetTop(wrapperRef.current)) + \"px)\";\n    var arrowOffset = calcArrowLeftOffset(clickTarget, wrapperRef.current);\n    setPosition({\n      arrowOffset: arrowOffset,\n      left: left,\n      top: top\n    });\n  }, [linkPluginState]);\n\n  if (!linkPluginState.show_link_toolbar) {\n    return null;\n  }\n\n  var _ref2 = position || {},\n      arrowOffset = _ref2.arrowOffset,\n      left = _ref2.left,\n      top = _ref2.top;\n\n  var state = view.state,\n      dispatch = view.dispatch;\n  var href = '';\n  var title = '';\n  var linkMark = getMarkPresent(state, state.schema.marks.link);\n\n  if (linkMark) {\n    href = linkMark.attrs.href;\n    title = linkMark.attrs.title;\n  }\n\n  return createElement(\"div\", {\n    ref: wrapperRef,\n    style: {\n      position: 'absolute'\n    }\n  }, position && createElement(TinaReset, null, createElement(LinkFormWrapper, null, createElement(LinkArrow, {\n    offset: arrowOffset,\n    top: top\n  }), createElement(LinkForm, {\n    style: {\n      left: left,\n      top: top,\n      width: width + \"px\"\n    },\n    removeLink: function removeLink() {\n      return removeLinkBeingEdited(state, dispatch);\n    },\n    onChange: onChange,\n    href: href,\n    title: title,\n    cancel: onCancel\n  }))));\n};\n\nvar LinkFormWrapper = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject$9());\nvar LinkArrow = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject2$5(), function (p) {\n  return p.top;\n}, function (p) {\n  return p.offset;\n});\n/**\r\n * Calculates the leftOffset of the form.\r\n *\r\n * It centers the form on the link, unless the form would\r\n * show up outside of the window, in which case the offset is the edge\r\n * of the editor.\r\n *\r\n * @param {HTMLElement} clickTarget\r\n * @param {HTMLElement} renderTarget\r\n * @param {number} minWidth\r\n * @returns {string}\r\n */\n\nfunction calcLeftOffset(clickTarget, renderTarget, minWidth) {\n  var ow_ct = clickTarget.offsetWidth;\n  var ol_ct = findElementOffsetLeft(clickTarget);\n  var ow_rt = renderTarget.parentElement.offsetWidth;\n  var ol_rt = findElementOffsetLeft(renderTarget);\n  var ol = ol_ct - ol_rt + ow_ct / 2 - minWidth / 2;\n  var leftEdgeOutsideView = ol < -ol_rt;\n\n  if (leftEdgeOutsideView) {\n    return \"-8px\";\n  }\n\n  var rightEdgeOutsideView = ol + minWidth > ow_rt;\n\n  if (rightEdgeOutsideView) {\n    return \"calc(\" + (ol - (ol + minWidth - ow_rt)) + \"px + 8px)\";\n  }\n\n  return ol + \"px\";\n}\n\nfunction calcArrowLeftOffset(clickTarget, renderTarget, _minWidth) {\n  var ow_ct = clickTarget.offsetWidth;\n  var ol_ct = findElementOffsetLeft(clickTarget);\n  var ol_rt = findElementOffsetLeft(renderTarget);\n  var ol = ol_ct - ol_rt + ow_ct / 2;\n  return ol + \"px\";\n}\n\nfunction _templateObject10$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: 48px;\\n  height: 28px;\\n  opacity: 0;\\n  margin: 0;\\n  cursor: \", \";\\n\"]);\n\n  _templateObject10$1 = function _templateObject10() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject9$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: relative;\\n  width: 48px;\\n  height: 28px;\\n  border-radius: var(--tina-radius-big);\\n  background-color: white;\\n  border: 1px solid var(--tina-color-grey-2);\\n  pointer-events: none;\\n  margin-left: -2px;\\n  span {\\n    position: absolute;\\n    border-radius: var(--tina-radius-big);\\n    left: 2px;\\n    top: 50%;\\n    width: calc(28px - 6px);\\n    height: calc(28px - 6px);\\n    background: \", \";\\n    transform: translate3d(\", \", -50%, 0);\\n    transition: all 150ms ease-out;\\n  }\\n\"]);\n\n  _templateObject9$1 = function _templateObject9() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject8$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  background: none;\\n  color: inherit;\\n  padding: 0;\\n  opacity: \", \";\\n  outline: none;\\n  height: 28px;\\n  pointer-events: \", \";\\n  font-size: var(--tina-font-size-1);\\n  font-weight: 600;\\n  letter-spacing: 0.01em;\\n  line-height: 1.35;\\n  color: var(--tina-color-grey-8);\\n\"]);\n\n  _templateObject8$1 = function _templateObject8() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject7$3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: block;\\n  position: relative;\\n  margin: 0 0 0.5rem 0;\\n\"]);\n\n  _templateObject7$3 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6$3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  background-color: white;\\n  border: 1px solid var(--tina-color-grey-2);\\n  color: var(--tina-color-primary);\\n  &:hover {\\n    background-color: var(--tina-color-grey-1);\\n    opacity: 1;\\n  }\\n\"]);\n\n  _templateObject6$3 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5$3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  text-align: center;\\n  border: 0;\\n  border-radius: var(--tina-radius-big);\\n  box-shadow: 0px 2px 3px rgba(0, 0, 0, 0.12);\\n  background-color: var(--tina-color-primary);\\n  color: white;\\n  font-weight: 500;\\n  cursor: pointer;\\n  transition: all 85ms ease-out;\\n  font-size: var(--tina-font-size-0);\\n  padding: 8px 20px;\\n  margin-left: 8px;\\n  &:hover {\\n    background-color: var(--tina-color-primary-light);\\n  }\\n  &:active {\\n    background-color: var(--tina-color-primary-dark);\\n  }\\n\"]);\n\n  _templateObject5$3 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4$4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  justify-content: flex-end;\\n  padding-top: 4px;\\n\"]);\n\n  _templateObject4$4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3$4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: relative;\\n  background-color: white;\\n  border-radius: var(--tina-radius-small);\\n  font-size: var(--tina-font-size-1);\\n  line-height: 1.35;\\n  transition: all 85ms ease-out;\\n  padding: 8px 12px;\\n  border: 1px solid var(--tina-color-grey-2);\\n  width: 100%;\\n  margin: 0 0 8px 0;\\n  outline: none;\\n  box-shadow: 0 0 0 2px transparent;\\n\\n  &:hover {\\n    box-shadow: 0 0 0 2px var(--tina-color-grey-3);\\n  }\\n\\n  &:focus {\\n    box-shadow: 0 0 0 2px var(--tina-color-primary);\\n  }\\n\\n  &::placeholder {\\n    font-size: var(--tina-font-size-2);\\n    color: #cfd3d7;\\n  }\\n\"]);\n\n  _templateObject3$4 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2$6() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: block;\\n  font-size: var(--tina-font-size-1);\\n  font-weight: 600;\\n  letter-spacing: 0.01em;\\n  color: var(--tina-color-grey-8);\\n  margin-bottom: 3px;\\n\"]);\n\n  _templateObject2$6 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$a() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  background-color: #f6f6f9;\\n  position: absolute;\\n  border-radius: var(--tina-radius-small);\\n  border: 1px solid var(--tina-color-grey-2);\\n  filter: drop-shadow(0px 4px 8px rgba(48, 48, 48, 0.1))\\n    drop-shadow(0px 2px 3px rgba(0, 0, 0, 0.12));\\n  transform-origin: 50% 0;\\n  overflow: visible;\\n  padding: 12px;\\n  z-index: 10;\\n  width: 16rem;\\n  left: \", \";\\n  top: \", \";\\n\"]);\n\n  _templateObject$a = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar FloatingImageMenu = function FloatingImageMenu(props) {\n  var view = props.editorView.view;\n\n  var _imagePluginKey$getSt = imagePluginKey.getState(view.state),\n      selectedImage = _imagePluginKey$getSt.selectedImage;\n\n  if (!selectedImage) return null;\n  var node = selectedImage.node,\n      pos = selectedImage.pos;\n  var link = view.state.schema.marks.link;\n  var linkMark = node.marks.find(function (mark) {\n    return mark.type === link;\n  });\n\n  var _useState = useState(node.attrs.title),\n      title = _useState[0],\n      setTitle = _useState[1];\n\n  var _useState2 = useState(node.attrs.alt),\n      alt = _useState2[0],\n      setAlt = _useState2[1];\n\n  var _useState3 = useState(linkMark && linkMark.attrs.title),\n      linkTitle = _useState3[0],\n      setLinkTitle = _useState3[1];\n\n  var _useState4 = useState(linkMark && linkMark.attrs.href),\n      linkSrc = _useState4[0],\n      setLinkSrc = _useState4[1];\n\n  var _view$coordsAtPos = view.coordsAtPos(pos),\n      top = _view$coordsAtPos.top,\n      left = _view$coordsAtPos.left;\n\n  var _useState5 = useState(top),\n      modalTop = _useState5[0],\n      setModalTop = _useState5[1];\n\n  var _useState6 = useState(left),\n      modalLeft = _useState6[0],\n      setModalLeft = _useState6[1];\n\n  var wrapperRef = useRef();\n  var inputRef = useRef();\n  var imageRef = useRef();\n\n  var _useState7 = useState(!!linkMark),\n      linked = _useState7[0],\n      toggleLinked = _useState7[1];\n\n  function positionImage(scroll) {\n    var image = document.getElementsByClassName('tina-selected-image')[0];\n    var wysiwygWrapper = document.getElementsByClassName('wysiwyg-wrapper')[0];\n\n    if (image && (imageRef.current !== image || scroll) && wrapperRef.current) {\n      imageRef.current = image;\n      var wrapperDimensions = wrapperRef.current.getBoundingClientRect();\n      setModalLeft(image.clientWidth / 2 + findElementOffsetLeft(image, wysiwygWrapper) - wrapperDimensions.width / 2);\n      setModalTop(findElementOffsetTop(image, wysiwygWrapper));\n    }\n  }\n\n  useEffect(function () {\n    var debouncedPositionImage = debounce(function () {\n      return positionImage(true);\n    }, 10);\n    window.addEventListener('scroll', debouncedPositionImage);\n    return function () {\n      window.removeEventListener('scroll', debouncedPositionImage);\n    };\n  });\n  useEffect(function () {\n    setLinkTitle(linkMark ? linkMark.attrs.title : '');\n    setLinkSrc(linkMark ? linkMark.attrs.href : '');\n    toggleLinked(!!linkMark);\n  }, [linkMark]);\n  useEffect(function () {\n    setTitle(node.attrs.title);\n    setAlt(node.attrs.alt);\n  }, [selectedImage.node]);\n  useEffect(function () {\n    setTimeout(function () {\n      if (inputRef.current) inputRef.current.focus();\n    });\n  }, [inputRef]);\n  useEffect(positionImage);\n\n  var updateNodeAttrs = function updateNodeAttrs() {\n    var dispatch = view.dispatch,\n        state = view.state;\n    var image = state.schema.nodes.image;\n    var link = state.schema.marks.link;\n    var tr = state.tr;\n\n    if (linked && (linkSrc || linkTitle)) {\n      tr.addMark(pos, pos + 1, link.create({\n        href: linkSrc,\n        title: linkTitle\n      }));\n    } else {\n      tr.removeMark(pos, pos + 1, link);\n    }\n\n    tr.setNodeMarkup(pos, image, _extends({}, node.attrs, {\n      alt: alt,\n      title: title\n    })).setSelection(new NodeSelection(tr.doc.resolve(pos)));\n    dispatch(tr);\n    closeImageSettings();\n  };\n\n  var closeImageSettings = function closeImageSettings() {\n    var dispatch = view.dispatch,\n        state = view.state;\n    dispatch(state.tr.setMeta('image_clicked', false));\n    setTitle('');\n    setAlt('');\n    setLinkTitle('');\n    setLinkSrc('');\n  };\n\n  var handleKeyPress = function handleKeyPress(evt) {\n    if (evt.key === 'Escape') closeImageSettings();\n    if (evt.key === 'Enter') updateNodeAttrs();\n  };\n\n  return React__default.createElement(TinaReset, null, React__default.createElement(LinkPopup$1, {\n    top: modalTop,\n    left: modalLeft,\n    ref: wrapperRef,\n    onKeyDown: handleKeyPress\n  }, React__default.createElement(LinkLabel$1, null, \"Title\"), React__default.createElement(LinkInput$1, {\n    placeholder: \"Enter Title\",\n    type: 'text',\n    ref: inputRef,\n    value: title,\n    onChange: function onChange(evt) {\n      return setTitle(evt.target.value);\n    }\n  }), React__default.createElement(LinkLabel$1, null, \"Alt\"), React__default.createElement(LinkInput$1, {\n    placeholder: \"Enter Alt Text\",\n    type: 'text',\n    value: alt,\n    onChange: function onChange(evt) {\n      return setAlt(evt.target.value);\n    }\n  }), React__default.createElement(ToggleElement, null, React__default.createElement(ToggleInput, {\n    id: \"toggleImageLink\",\n    onChange: function onChange() {\n      toggleLinked(!linked);\n\n      if (!linked) {\n        setLinkTitle('');\n        setLinkSrc('');\n      }\n    },\n    type: \"checkbox\"\n  }), React__default.createElement(ToggleLabel, {\n    htmlFor: \"toggleImageLink\",\n    role: \"switch\"\n  }, \"Insert Link\", React__default.createElement(ToggleSwitch, {\n    checked: linked\n  }, React__default.createElement(\"span\", null)))), linked && React__default.createElement(React__default.Fragment, null, React__default.createElement(LinkLabel$1, null, \"Link Title\"), React__default.createElement(LinkInput$1, {\n    placeholder: \"Enter Link Title\",\n    type: 'text',\n    value: linkTitle,\n    onChange: function onChange(evt) {\n      return setLinkTitle(evt.target.value);\n    }\n  }), React__default.createElement(LinkLabel$1, null, \"Link URL\"), React__default.createElement(LinkInput$1, {\n    placeholder: \"Enter Link URL\",\n    type: 'text',\n    value: linkSrc,\n    onChange: function onChange(evt) {\n      return setLinkSrc(evt.target.value);\n    }\n  })), React__default.createElement(LinkActions$1, null, React__default.createElement(CancelLink, {\n    onClick: closeImageSettings\n  }, \"Cancel\"), React__default.createElement(SaveLink$1, {\n    onClick: updateNodeAttrs\n  }, \"Save\"))));\n};\n\nvar LinkPopup$1 = /*#__PURE__*/styled.span( /*#__PURE__*/_templateObject$a(), function (_ref) {\n  var left = _ref.left;\n  return left + \"px\";\n}, function (_ref2) {\n  var top = _ref2.top;\n  return top + \"px\";\n});\nvar LinkLabel$1 = /*#__PURE__*/styled.label( /*#__PURE__*/_templateObject2$6());\nvar LinkInput$1 = /*#__PURE__*/styled.input( /*#__PURE__*/_templateObject3$4());\nvar LinkActions$1 = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject4$4());\nvar SaveLink$1 = /*#__PURE__*/styled.button( /*#__PURE__*/_templateObject5$3());\nvar CancelLink = /*#__PURE__*/styled(SaveLink$1)( /*#__PURE__*/_templateObject6$3());\nvar ToggleElement = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject7$3());\nvar ToggleLabel = /*#__PURE__*/styled.label( /*#__PURE__*/_templateObject8$1(), function (props) {\n  return props.disabled ? '0.4' : '1';\n}, function (props) {\n  return props.disabled ? 'none' : 'inherit';\n});\nvar ToggleSwitch = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject9$1(), function (p) {\n  return p.checked ? 'var(--tina-color-primary)' : 'var(--tina-color-grey-3)';\n}, function (p) {\n  return p.checked ? '20px' : '0';\n});\nvar ToggleInput = /*#__PURE__*/styled.input( /*#__PURE__*/_templateObject10$1(), function (props) {\n  return props.disabled ? 'not-allowed' : 'pointer';\n});\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\nvar ImageMenu = function ImageMenu(_ref) {\n  var editorView = _ref.editorView,\n      imageUpload = _ref.imageUpload;\n  if (!imageUpload) return null;\n\n  var uploadImageFn = function uploadImageFn() {\n    var imagePromises = imageUpload();\n    imagePromises.forEach(function (promise) {\n      promise.then(function (url) {\n        var _editorView$view = editorView.view,\n            state = _editorView$view.state,\n            dispatch = _editorView$view.dispatch;\n        insertImage(state, dispatch, url);\n      });\n    });\n  };\n\n  return React__default.createElement(MenuButton, {\n    onClick: uploadImageFn\n  }, React__default.createElement(MediaIcon, null));\n};\n\nfunction _templateObject8$2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n      pointer-events: none;\\n      color: #d1d1d1;\\n      fill: #d1d1d1;\\n    \"]);\n\n  _templateObject8$2 = function _templateObject8() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject7$4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n      color: var(--tina-color-primary);\\n      fill: var(--tina-color-primary);\\n      background-color: rgba(53, 50, 50, 0.05);\\n    \"]);\n\n  _templateObject7$4 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6$4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  \", \"\\n  background-color: \", \";\\n  color: \", \";\\n  fill: \", \";\\n  border: 1px solid var(--tina-color-grey-2);\\n  margin: -1px;\\n  outline: none;\\n  padding: 6px 4px;\\n  transition: all 85ms ease-out;\\n  cursor: pointer;\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  &:hover {\\n    background-color: rgba(53, 50, 50, 0.09);\\n  }\\n  &:active {\\n    color: var(--tina-color-primary);\\n    fill: var(--tina-color-primary);\\n    background-color: rgba(53, 50, 50, 0.05);\\n  }\\n  svg {\\n    width: 20px;\\n    height: 20px;\\n  }\\n  \", \";\\n  \", \";\\n\"]);\n\n  _templateObject6$4 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5$4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  flex: 1 1 24px;\\n\"]);\n\n  _templateObject5$4 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4$5() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: flex-start;\\n  flex-wrap: wrap;\\n  justify-content: space-between;\\n  position: relative;\\n  top: 0;\\n  width: 100%;\\n  background-color: white;\\n  border-radius: var(--tina-radius-big);\\n  box-shadow: 0px 2px 3px rgba(0, 0, 0, 0.12);\\n  border: 1px solid var(--tina-color-grey-2);\\n  overflow: hidden;\\n  z-index: 100;\\n\"]);\n\n  _templateObject4$5 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3$5() {\n  var data = _taggedTemplateLiteralLoose([\"\\n      position: fixed;\\n      width: \", \"px;\\n      top: \", \";\\n    \"]);\n\n  _templateObject3$5 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2$7() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: relative;\\n  margin-bottom: 14px;\\n  z-index: 900;\\n\\n  \", \";\\n\"]);\n\n  _templateObject2$7 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$b() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  color: transparent;\\n  background: transparent;\\n  pointer-events: none;\\n  position: relative;\\n  display: block;\\n  height: \", \"px;\\n  width: \", \"px;\\n\"]);\n\n  _templateObject$b = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar BoldControl = /*#__PURE__*/markControl({\n  mark: 'strong',\n  Icon: BoldIcon,\n  tooltip: 'Bold'\n});\nvar ItalicControl = /*#__PURE__*/markControl({\n  mark: 'em',\n  Icon: ItalicIcon,\n  tooltip: 'Italic'\n});\nvar UnderlineControl = /*#__PURE__*/markControl({\n  mark: 'underline',\n  Icon: UnderlineIcon,\n  tooltip: 'Underline'\n});\nvar LinkControl = /*#__PURE__*/markControl({\n  mark: 'link',\n  Icon: LinkIcon,\n  tooltip: 'Link',\n  selectionOnly: true,\n  defaultAttrs: {\n    href: '',\n    title: ''\n  },\n  noMix: ['code'],\n  isDisabled: function isDisabled(view) {\n    return isMarkPresent(view.state, view.state.schema.marks.link) || !!imagePluginKey.getState(view.state).selectedImage;\n  },\n  onClick: function onClick(view) {\n    var state = view.state,\n        dispatch = view.dispatch;\n    return dispatch(state.tr.setMeta('show_link_toolbar', true));\n  }\n});\n\nvar Menu = function Menu(props) {\n  var editorView = props.editorView,\n      _props$bottom = props.bottom,\n      bottom = _props$bottom === void 0 ? false : _props$bottom,\n      _props$sticky = props.sticky,\n      sticky = _props$sticky === void 0 ? true : _props$sticky,\n      imageUpload = props.imageUpload;\n\n  var _useState = useState(false),\n      menuFixed = _useState[0],\n      setMenuFixed = _useState[1];\n\n  var isBrowser = typeof window !== \"undefined\";\n  var menuRef = useRef(null);\n\n  var _useState2 = useState(null),\n      menuBoundingBox = _useState2[0],\n      setMenuBoundingBox = _useState2[1];\n\n  var menuFixedTopOffset = typeof sticky === 'string' ? sticky : '0';\n  useEffect(function () {\n    if (menuRef.current && sticky) {\n      setMenuBoundingBox(menuRef.current.getBoundingClientRect());\n    }\n  }, [menuRef]);\n  useLayoutEffect(function () {\n    if (!isBrowser || !menuRef.current || !sticky) {\n      return;\n    }\n\n    var handleScroll = function handleScroll() {\n      var wysiwygWrapper = menuRef.current.parentElement;\n      var startPosition = wysiwygWrapper ? wysiwygWrapper.offsetTop : 0;\n      var endPosition = wysiwygWrapper ? startPosition + wysiwygWrapper.offsetHeight : 0;\n\n      if (window.scrollY > startPosition && window.scrollY < endPosition) {\n        setMenuFixed(true);\n      } else {\n        setMenuFixed(false);\n      }\n    };\n\n    var handleResize = function handleResize() {\n      if (menuRef.current) {\n        var wasMenuFixed = menuFixed;\n        setMenuFixed(false);\n        setMenuBoundingBox(menuRef.current.getBoundingClientRect());\n        setMenuFixed(wasMenuFixed);\n      }\n    };\n\n    window.addEventListener('scroll', handleScroll);\n    window.addEventListener('resize', handleResize);\n    return function () {\n      window.removeEventListener('scroll', handleScroll);\n      window.removeEventListener('resize', handleResize);\n    };\n  }, [menuRef, menuBoundingBox]);\n  var preventProsemirrorFocusLoss = React__default.useCallback(function (e) {\n    e.stopPropagation();\n    e.preventDefault();\n  }, []);\n  var view = editorView.view;\n  return React__default.createElement(React__default.Fragment, null, menuFixed && React__default.createElement(MenuPlaceholder, {\n    menuBoundingBox: menuBoundingBox\n  }), React__default.createElement(MenuWrapper, {\n    menuFixedTopOffset: menuFixedTopOffset,\n    menuFixed: menuFixed,\n    menuBoundingBox: menuBoundingBox,\n    ref: menuRef\n  }, React__default.createElement(MenuPortalProvider, null, React__default.createElement(MenuContainer, {\n    onMouseDown: preventProsemirrorFocusLoss\n  }, React__default.createElement(FormattingDropdown, {\n    view: view\n  }), React__default.createElement(BoldControl, {\n    view: view\n  }), React__default.createElement(ItalicControl, {\n    view: view\n  }), React__default.createElement(UnderlineControl, {\n    view: view\n  }), React__default.createElement(LinkControl, {\n    view: view\n  }), React__default.createElement(ImageMenu, {\n    editorView: editorView,\n    imageUpload: imageUpload\n  }), React__default.createElement(TableControl, {\n    view: view,\n    bottom: bottom\n  }), React__default.createElement(QuoteControl, {\n    view: view,\n    bottom: bottom\n  }), React__default.createElement(CodeControl, {\n    view: view,\n    bottom: bottom\n  }), React__default.createElement(BulletList, {\n    view: view,\n    bottom: bottom\n  }), React__default.createElement(OrderedList, {\n    view: view,\n    bottom: bottom\n  }), React__default.createElement(UndoControl, {\n    view: view\n  }), React__default.createElement(RedoControl, {\n    view: view\n  })))), React__default.createElement(FloatingTableMenu, {\n    editorView: editorView\n  }), React__default.createElement(FloatingImageMenu, {\n    editorView: editorView\n  }), React__default.createElement(FloatingLinkForm, {\n    editorView: editorView\n  }));\n};\n\nvar commandContrl = function commandContrl(command, Icon, // Fix type\n_title, tooltip, focusOnCreate) {\n  if (focusOnCreate === void 0) {\n    focusOnCreate = true;\n  }\n\n  return /*#__PURE__*/function (_React$Component) {\n    _inheritsLoose(CommandControl, _React$Component);\n\n    function CommandControl() {\n      var _this;\n\n      _this = _React$Component.apply(this, arguments) || this;\n\n      _this.onClick = function () {\n        if (_this.canDo()) {\n          var view = _this.props.view;\n          command(view.state, view.dispatch);\n\n          if (focusOnCreate) {\n            view.focus();\n          }\n        }\n      };\n\n      _this.canDo = function () {\n        return command(_this.props.view.state);\n      };\n\n      return _this;\n    }\n\n    var _proto = CommandControl.prototype;\n\n    _proto.render = function render() {\n      return React__default.createElement(MenuButton$1, {\n        \"data-tooltip\": tooltip,\n        onClick: this.onClick,\n        bottom: this.props.bottom,\n        disabled: !this.canDo()\n      }, React__default.createElement(Icon, null));\n    };\n\n    return CommandControl;\n  }(React__default.Component);\n};\n\nfunction wrapInBlockquote(state, dispatch) {\n  var blockquote = state.schema.nodes.blockquote;\n\n  var _ref = findParentNodeOfType(blockquote)(state.selection) || {},\n      start = _ref.start,\n      node = _ref.node;\n\n  if (start && node) {\n    var tr = state.tr;\n    var nodeRange = tr.doc.resolve(start + 1).blockRange(tr.doc.resolve(start + node.nodeSize - 2));\n\n    if (nodeRange) {\n      if (dispatch) return dispatch(tr.lift(nodeRange, 0));else return true;\n    }\n  }\n\n  return wrapIn(state.schema.nodes.blockquote)(state, dispatch);\n}\n\nfunction insertTableCmd(state, dispatch) {\n  var table = state.schema.nodes.table;\n  var selection = state.selection;\n  var tableParent = findParentNodeOfType(table)(selection);\n  if (tableParent) return false;\n  return insertTable(state, dispatch);\n}\n\nfunction makeCodeBlock(state, dispatch) {\n  return setBlockType(state.schema.nodes.code_block)(state, dispatch);\n}\n\nvar TableControl = /*#__PURE__*/commandContrl(insertTableCmd, TableIcon, 'Table', 'Table');\nvar QuoteControl = /*#__PURE__*/commandContrl(wrapInBlockquote, QuoteIcon, 'Blockquote', 'Blockquote');\nvar CodeControl = /*#__PURE__*/commandContrl(makeCodeBlock, CodeIcon, 'Codeblock', 'Codeblock', false); //codeblock focusing messes with scroll\n\nvar BulletList = /*#__PURE__*/commandContrl(toggleBulletList, UnorderedListIcon, 'Unordered List', 'Unordered List');\nvar OrderedList = /*#__PURE__*/commandContrl(toggleOrderedList, OrderedListIcon, 'Ordered List', 'Ordered List');\nvar MenuPlaceholder = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject$b(), function (props) {\n  return props.menuBoundingBox.height;\n}, function (props) {\n  return props.menuBoundingBox.width;\n});\nvar MenuWrapper = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject2$7(), function (props) {\n  return props.menuFixed && css(_templateObject3$5(), props.menuBoundingBox.width, props.menuFixedTopOffset);\n});\nvar MenuContainer = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject4$5());\nvar MenuItem$1 = /*#__PURE__*/css( /*#__PURE__*/_templateObject5$4());\nvar MenuButton$1 = /*#__PURE__*/styled.button( /*#__PURE__*/_templateObject6$4(), MenuItem$1, function (p) {\n  return p.active ? 'rgba(53, 50, 50, 0.05)' : 'transparent';\n}, function (p) {\n  return p.active ? 'var(--tina-color-primary)' : 'var(--tina-color-grey-8)';\n}, function (p) {\n  return p.active ? 'var(--tina-color-primary)' : 'var(--tina-color-grey-8)';\n}, function (props) {\n  return props.active && css(_templateObject7$4());\n}, function (props) {\n  return props.disabled && css(_templateObject8$2());\n});\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\nvar TranslatorContext = /*#__PURE__*/createContext(null);\n/**\r\n\nCopyright 2019 Forestry.io Inc\r\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\n*/\n\nvar Menu$1 = function Menu$1(_ref) {\n  var editorView = _ref.editorView,\n      translator = _ref.translator,\n      bottom = _ref.bottom,\n      sticky = _ref.sticky,\n      imageUpload = _ref.imageUpload;\n  return createElement(TranslatorContext.Provider, {\n    value: translator\n  }, createElement(Menu, {\n    editorView: editorView,\n    bottom: bottom,\n    format: \"markdown\",\n    sticky: sticky,\n    imageUpload: imageUpload\n  }));\n};\n\nfunction _templateObject2$8() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: relative;\\n\"]);\n\n  _templateObject2$8 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$c() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  \", \"\", \"\\n\"]);\n\n  _templateObject$c = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar Wysiwyg = /*#__PURE__*/styled(function (_ref) {\n  var input = _ref.input,\n      sticky = _ref.sticky,\n      format = _ref.format,\n      upload = _ref.upload,\n      previewUrl = _ref.previewUrl,\n      styleProps = _objectWithoutPropertiesLoose(_ref, [\"input\", \"plugins\", \"sticky\", \"format\", \"upload\", \"previewUrl\"]);\n\n  var _useProsemirror = useProsemirror(input, ALL_PLUGINS, format, previewUrl),\n      prosemirrorEl = _useProsemirror.elRef,\n      editorView = _useProsemirror.editorView,\n      translator = _useProsemirror.translator;\n\n  return createElement(WysiwygWrapper, {\n    className: \"wysiwyg-wrapper\"\n  }, createElement(\"link\", {\n    rel: \"stylesheet\",\n    href: \"https://codemirror.net/lib/codemirror.css\"\n  }), editorView && createElement(Menu$1, {\n    editorView: editorView,\n    bottom: false,\n    translator: translator,\n    sticky: sticky,\n    imageUpload: upload\n  }), createElement(\"div\", Object.assign({}, styleProps, {\n    ref: prosemirrorEl\n  })));\n})( /*#__PURE__*/_templateObject$c(), CodeMirrorCss, ProseMirrorCss);\nvar WysiwygWrapper = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject2$8());\nexport { Wysiwyg };"],"sourceRoot":""}